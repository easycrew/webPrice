<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/> 
<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js"></script>
<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery.json-2.2.000000000000000.js"></script>
<title>免费洗车</title>
<style type="text/css">
*{
	margin: 0;
	padding: 0;
}
body{
	background-color: #f4f7f8;
	font-family:'华文细黑','HelveticaNeue-Light';
	font-size:62.5%;
	color:#000000;
	-webkit-box-sizing:border-box;
	box-sizing:border-box; 
}
body,html{
	min-height:100%;
}
ul,ol{
	list-style: none;
}
img{
	border:none;
}
.clearfix {
   *zoom: 1;
}
.clearfix:before,
.clearfix:after {
   display: table;
   line-height: 0;
   content: "";
}
.clearfix:after {
  clear: both;
} 
.tab-wrap{
	margin: 15px 60px;
	border: 1px solid #fb451f;
	border-radius: 5px; 
	font-size: 1.5em;
	font-weight: normal;
	color: #fb451f;
}
.tab-wrap span{
	display: inline-block;
	width: 50%;
	height: 30px;
	line-height: 30px;
	text-align: center; 
}
.tab-wrap .checked{
	background-color: #fb451f;
	color: #fff;
}
.voucher-wrap li{
	margin: 10px;
	border: 1px solid #ffa600;
	border-radius: 5px;
	background-color: #ffa600;
	padding: 10px 0 8px;
	color: #fff;
	position: relative;
	overflow: hidden;
}
.voucher-wrap h1{
	font-size: 1.8em;
	font-weight: normal;
	margin:0 0 8px 16px;
}
.voucher-wrap h1 span{
	font-size:0.68em; 
	display: inline-block;
	margin-left: 16px;
}
.voucher-wrap p{
	font-size:1.2em;  
	padding-left: 60px;
	line-height: 150%;
}
.voucher-wrap label{
	font-size:2.7em;   
	width: 60px;
	height: 60px;
	background-color: #fff;
	border-radius: 50%;
	display: block;
	color: #ffa600;
	position: absolute;
	bottom: -12px;
	left: -14px;
	text-align: center;
	line-height: 60px;
}
.voucher-wrap .right{ 
	background-color:#fff; 
	position: absolute;
	height: 100%;
	width: 88px;
	right: 0;
	top: 0;
	text-align: center;
	vertical-align: middle;
}
.btn{
	font-size:1.5em;   
	width: 68px;
	height: 28px;
	background-color: #ffa600;
	border-radius: 5px;
	display: inline-block;
	color: #fff;  
	text-align: center;
	line-height: 28px;
	margin-top: 29px;
	cursor: pointer;
}
.border{
	/*width: 9px;*/
	height: 100%;
	float: left;  
}
.border span{
	display:block; 
	background-color: #fff;
	width: 10px;
	height:10px;
	border-radius:50%;   
} 
.border .org{ 
	background-color: #ffa600; 
	margin-left: -7px;
} 
.border .white{  
	margin-left: -4px;
}  
.dialog {
    background-color: rgba(0, 0, 0, 0.4);
    bottom: 0;
    height: 100%;
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 100;
}
.dialog > div {
    background-color: #fff;
    height: auto;
    margin: 100px 10px 0;
    overflow: auto;
}
.dialog h1 {
    border-bottom: 1px solid #fb451f;
    color: #fb451f;
    font-size: 1.7em;
    font-weight: normal;
    height: 33px;
    line-height: 33px;
    text-align: center;
}
.dialog p {
    font-size: 1.6em;
    font-weight: normal;
    line-height: 150%;
    padding: 20px;
}
.dialog .btn-wrap > div {
    float: left;
    width: 50%;
}
.dialog .dialog-btn {
    background-color: #fb451f;
    color: #fff;
    cursor: pointer;
    display: block;
    font-size: 1.6em;
    height: 34px;
    line-height: 34px;
    text-align: center;
}
.dialog .left {
    margin: 0 9px 17px 27px;
}
.dialog .right {
    background-color: #c2c2c6;
    margin: 0 27px 17px 9px;
}
#alertDialog .dialog-btn{
	 margin: 0 27px 17px;
}
</style>
<body>
	<section>
		<!-- <h1 class="tab-wrap"><span class="checked">代金券兑换</span><span class="other">其他兑换</span></h1> -->
		<ul class="voucher-wrap">
			<li voucherTopicId="300">
				<h1>¥50代金券<span>(满500可用)</span></h1>
				<p class="time">2014.6.8－2015.7.8</p>
				<p class="info"><span class="integral">1500</span>积分兑换</p>
				<label>¥</label>
				<div class="right">
				<div class="border">
				<span class="org" style="margin-top:-4px;"></span>
				<span class="white"></span>
				<span class="org"></span>
				<span class="white"></span>
				<span class="org"></span> 
				<span class="white"></span>
				<span class="org"></span>
				 <span class="white"></span>
				<span class="org"></span> 
				</div> 
				<span class="btn">兑换</span> 
				</div>
			</li> 
		</ul>
		<article class="null-wrap">
			<img src="http://app.yangchebao.com.cn/group1/M00/0A/3E/ChUBl1VMcO-AYl_NAAAKnVjD410972.png" width="80">
			<p class="null-info">还没有积分兑换活动</p>
		</article>
	</section>
	<div style="display:none;" class="dialog" id="confirmDialog">
      <div>
        <h1>提示</h1>
        <p class="msg">确定要兑换代金券吗？</p>
        <div class="btn-wrap">
            <div><div class="dialog-btn left">确定</div></div>
            <div><div class="dialog-btn right">取消</div></div>
        </div>
      </div>
    </div>
    <div  style="display:none;"  class="dialog" id="alertDialog">
      <div>
        <h1>提示</h1>
        <p class="msg"></p> 
        <div class="dialog-btn sure">确定</div> 
      </div>
    </div>
<script type="text/javascript">
	$(document).ready(function(){
		  var paramJson = {},integral="",voucherTopicId="";
		  var url =window.location.search;   
	      if(url!=undefined&&url!=""){
	        var paramsArr = (url.split("?")[1]).split("&"); 
	        $.each(paramsArr,function(i){
	         var item = paramsArr[i].split("=");
	         paramJson[item[0]] = item[1];
	        });    
	      }    
		$(".tab-wrap span").click(function(){
			if($(this).hasClass('checked')){
				return;
			}
			if($(this).hasClass('other')){
				$(".voucher-wrap").hide();
				$(".null-wrap").fadeIn();
			}else{ 
				$(".null-wrap").hide();
				$(".voucher-wrap").fadeIn();  
			}
			$(".tab-wrap .checked").removeClass("checked");
			$(this).addClass("checked");
		});
		$(".voucher-wrap .btn").click(function(){ 
			var _li = $(this).parents("li");
			voucherTopicId = _li.attr("voucherTopicId");
			integral = $(".integral",_li).html();
			$("#confirmDialog").fadeIn();
		});
		$("#confirmDialog .right").click(function(){
			$("#confirmDialog").fadeOut();
		});
		$("#confirmDialog .left").click(function(){
			$("#confirmDialog").fadeOut(); 
			exchange();
		});
		$("#alertDialog .sure").click(function(){
			$("#alertDialog").fadeOut();  
		});
		function exchange(id,value){
		    var postData = {};  
	 		postData.customerId = paramJson.customerId;   
	 		postData.voucherTopicId = voucherTopicId;   
	 		postData.integral = integral;   
			$.ajax({
				url: '/yangchebao-app-ws/ws/0.1/vouchers/exchange/integral',
				contentType : "application/json;charset=utf-8",
				dataType : "json",
				type : "POST",
				data : $.toJSON(postData),
				async : false,
				success: function(data) { 
					$("#alertDialog .msg").html(data.message);
					$("#alertDialog").show();
				},
				error:function(xhr){ 
					var errormsg = eval("(" + xhr.responseText + ")");  
					$("#alertDialog .msg").html(errormsg[0].message);
					$("#alertDialog").show();
				}
			}); 

		}
	}); 
</script>
</body>
</html>