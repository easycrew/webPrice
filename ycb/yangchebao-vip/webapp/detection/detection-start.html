<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
		<meta content="yes" name="apple-mobile-web-app-capable"/>
		<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
		<link type="text/css" href="../css/base.css" rel="stylesheet"/>
		<link rel="stylesheet" href="css/detection.css" />
		<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script> 
		<script type="text/javascript" src="../js/index.js"></script>
		<title>养车宝测试总店</title>
	</head>
	<body>
	<section class="header-wrap">
	<div class="header">
		<ul>
			<li class="header-fir">
				<div class="progressBar progressBar-l">
					<p class="circle active circle-l">1</p>
					<p class="liner active"></p>					
				</div>
				<label>填写车牌/车架</label>
			</li>
			<li class="header-sec">
				<div class="progressBar progressBa-m">
						<!--<p class="liner"></p>-->
						<p class="circle circle-m">2</p>
						<p class="liner"></p>					
				</div>
				<label>填写检测</label>
				</li>
			<li class="header-thir">
				<div class="progressBar progressBar-r">
					<p class="liner"></p>					
					<p class="circle circle-r">3</p>
				</div>
				<label>提交检测</label>		
			</li>
		</ul>
	</div>
	</section>
	<section class="trafficCar-wrap">
		<div>
			<ul class="formWrap">
				<li>
					<span class="number-first"><strong>京</strong><label class="down-arrow"></label></span>
     				<div class="input-wrap input-first"><input type="text" placeholder="请输入车牌号(必填)" id="plateNumber" maxlength="6"></div>
				</li>
				<li class="vinNumber-li"><div class="input-wrap"><input type="text" id="vinNumber" placeholder="请输入车架号(选填)" maxlength="17"></div>
			</ul>
		</div>
	</section>
	<div class="button-wrap"><div id="next" class="button">下一步</div></div>
	<section class="province-wrap" style="display:none;"> 
	    <div class="close"><label>X</label></div>
	    <span>京</span><span>沪</span><span>粤</span><span>苏</span><span>浙</span><span>鲁</span>
	    <span>晋</span><span>冀</span><span>豫</span><span>川</span><span>渝</span><span>辽</span>
	    <span>吉</span><span>黑</span><span>皖</span><span>鄂</span><span>湘</span><span>赣</span>
	    <span>闽</span><span>陕</span><span>甘</span><span>宁</span><span>蒙</span><span>津</span>
	    <span>贵</span><span>云</span><span>桂</span><span>琼</span><span>青</span><span>新</span>
	    <span>藏</span>
	</section>
	<script type="text/javascript">
		$(function(){
			var response = "0";
			/*获得用户职员信息*/
			function getEmployeeInfo(userInfo){
				var shopName;
		 		$.ajax({
		 			type:"get",
		 			url:"/vip-app-ws/ws/0.1/common/getEmployeeInfo",
		 			async:false,
		 			data:{userId:userInfo.userId},
		 			dataType:'json',
		 			contentType:'application/json;charset=utf-8',
		 			success:function(data){
		 				shopName=data.shopName;
		 			},
		 			error:function(xhr){
		 				var error=eval('('+xhr.responseText+')');
						alertTasat(error[0].message);
						return
		 			}
		 		});
		 		return shopName
		 	}
			index.init=function(userInfo,bridge){
				store.clear();
				var plateNumber,	/*车牌号*/
					vinNumber,		/*车架号*/
					brandId,		/*品牌ID*/
					brandName,		/*品牌名称*/
					modelId,		/*车系ID*/
					modelName,		/*车系名称*/
					styleId,		/*车型ID*/
					styleName,		/*车系名称*/
					color,			/*车颜色*/
					totalMileage;	/*里程数*/
				/*title 商家名称显示*/
				var shopName;
				shopName=getEmployeeInfo(userInfo);
				store.set('shopName',shopName);
				$("title").html(shopName);
				if(bIsAndroid()){
					window.mallTitle.getMallTitle('0',shopName);  
				}else{
					 bridge.callHandler('sendShopNameTitle',{'shopNameTitle':shopName});
				}
				var path=getPath();
				/*省份简称操作
				 * 滑出省份简称
				 * 淡入省份简称
				*/
		      	$(".number-first").click(function(){
	          		$(".province-wrap").fadeIn();
	      		});
	      		$(".province-wrap span").click(function(){
			        $(".province-wrap").fadeOut();
			        $(".number-first strong").html($(this).html());
			    });
			    $(".province-wrap .close").click(function(){
			    	$(".province-wrap").fadeOut();
			    });
				/*
				 * plateNumber  车牌号
				 * 自动转化为大写
				 */
				$("#plateNumber").keyup(function() {
					$(this).val($(this).val().toUpperCase());
				});
				$("#machineNumber").keyup(function() {
					$(this).val($(this).val().toUpperCase());
				});
				$("#vinNumber").keyup(function() {
					$(this).val($(this).val().toUpperCase());
				});

				$("#next").click(function() {
					store.remove('brandId');
					store.remove('brandName');
					store.remove('modelId');
					store.remove('modelName');
					store.remove('styleId');
					store.remove('styleName');
					store.remove('color');
					store.remove('totalMileage');
					plateNumber = $.trim($("#plateNumber").val());
					if (plateNumber == "") {
						alertTasat("请输入车牌号");
						return;
					}
					var reg = /^[A-Z0-9]{6,7}$/;
					if (!reg.test(plateNumber)) {
						alertTasat("请输入正确的车牌号");
						return;
					}
					plateNumber = $(".number-first strong").html() + plateNumber;
					store.set('plateNumber',plateNumber);
					
					var vinNumber = $.trim($("#vinNumber").val());
					var vreg = /^[A-Z0-9]{17}$/;
					if(vinNumber!=""){
						if(!vreg.test(vinNumber)){
							alertTasat("请输入正确的车架号");
							return;
						}else{
							vinNumber=vinNumber;
							store.set('vinNumber',vinNumber);
						}
					}
					if(vinNumber){
						window.location.href="http://w2nw?"+path+"/detection-middle.html?plateNumber="+plateNumber+"&vinNumber="+vinNumber;
					}else{
						window.location.href="http://w2nw?"+path+"/detection-middle.html?plateNumber="+plateNumber;
					}
				});
				return response;
			}
			
})</script>
	</body>
</html>
