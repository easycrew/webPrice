<style>
  table#sj_table th,table#sj_table tr td{
      text-align:center;
      height:30px;
  }
</style>
<div class="urlContentWraper" id="ycb-QR">
<div class="ui-form">
<div class="grid-row-fluid">
	<label class="span3 grid-layout-label">活动主题：</label>
	<div class="span5 grid-layout-content fluid-wrap">
		<div name="activeList"></div>
	</div>
	<label class="span2 grid-layout-label">活动时间：</label>
	<div class="span5 grid-layout-content fluid-wrap">
		<div class="input-append date" id="stat_date" >
			<div class="input-wrap">
			    <input type="text">
			</div>
			<span class="add-on"><i class="icon-calendar"></i></span>
		</div>
	</div>
	<button class="btn btn-mini btn-primary jrad-btn-search" style="position:relative;top:2px;left:23px;" id="jrad-btn-search">搜索</button>
</div>
</div>


  <table id="sj_table">
  	<tr>
  		<th scope="col" style="text-align: center;background-color:#eee;">商家</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">1月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">2月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">3月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">4月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">5月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">6月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">7月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">8月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">9月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">10月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">11月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">12月</th>
  		<th scope="col" style="text-align: center;background-color:#eee;">总计</th>
  	</tr> 
  </table>
</div>
<script type="text/javascript">
	$(document).ready(function(){   
		var wraper = $("#ycb-QR");
		var guestYear = moment().format('YYYY'); 
		$("div[name='activeList']",wraper).select({  
			urlData: {
		        url: '/vip-ws/ws/0.1/qrcodeActiveStatic/activeList?type=2&shopAccountId='+carsmart_config.shopId,
		        id: 'qrcodeActiveId',
				name: 'theme',
				type: 'get',
				dataType: 'json'
		    } 
		});
		$('#stat_date',wraper).datetimepickerBS({
		    format: 'yyyy',
		    autoclose: 1,
			startView: 4,
			minView: 4,
			//startDate:'2014',
			//endDate:'2017',
			pickerPosition:'bottom-left'
		}).on('changeDate',function(ev){		
			var date = ev.date;
	        var year = date.getFullYear() ;   
		 
		}); 
		$('#stat_date input').val(guestYear);
		var qr_activeId=$("div[name='activeList']",wraper).select('val');
    if(qr_activeId==""){
        return false;
    }
		var _date = $('#stat_date input',wraper).val();
		$.jRadGet({
                  url:'/vip-ws/ws/0.1/qrcodeActiveStatic/activeReport?type=2&shopAccountId='+carsmart_config.shopId+'&qrcodeActiveId='+qr_activeId+'&year='+_date,
                  success:function(data){
                  	var str = "";
                  	$.each(data,function(i){
                  		var item = data[i]; 
                  		str +="<tr>"
                  		    +"<th>"+item.busiRegName+"</th>" 
                  		    +"<td>"+item['01']+"</td>" 
                  		    +"<td>"+item['02']+"</td>" 
                  		    +"<td>"+item['03']+"</td>" 
                  		    +"<td>"+item['04']+"</td>" 
                  		    +"<td>"+item['05']+"</td>" 
                  		    +"<td>"+item['06']+"</td>" 
                  		    +"<td>"+item['07']+"</td>" 
                  		    +"<td>"+item['08']+"</td>" 
                  		    +"<td>"+item['09']+"</td>" 
                  		    +"<td>"+item['10']+"</td>" 
                  		    +"<td>"+item['11']+"</td>" 
                  		    +"<td>"+item['12']+"</td>"
                  		    +"<td>"+item.rowTotal+"</td>"
                  			+"</tr>"; 
                  	});
                  	$("table#sj_table",wraper).append(str);
                  }
                });
  $("#jrad-btn-search",wraper).click(function(){
    var tr_len=$("#sj_table",wraper).find("tr").length;
    for(cur=0;cur<tr_len;cur++){
      if(cur!==0){
        $("#sj_table",wraper).find("tr").eq(cur).hide();
      }
    }
    var qr_activeId2=$("div[name='activeList']",wraper).select('val');
    if(qr_activeId2==""){
        return false;
    }
    var _date2 = $('#stat_date input',wraper).val();


    $.jRadGet({
                  url:'/vip-ws/ws/0.1/qrcodeActiveStatic/activeReport?type=2&shopAccountId='+carsmart_config.shopId+'&qrcodeActiveId='+qr_activeId2+'&year='+_date2,
                  success:function(data){
                    var str = "";
                    $.each(data,function(i){
                      var item = data[i]; 
                      str +="<tr>"
                          +"<th>"+item.busiRegName+"</th>" 
                          +"<td>"+item['01']+"</td>" 
                          +"<td>"+item['02']+"</td>" 
                          +"<td>"+item['03']+"</td>" 
                          +"<td>"+item['04']+"</td>" 
                          +"<td>"+item['05']+"</td>" 
                          +"<td>"+item['06']+"</td>" 
                          +"<td>"+item['07']+"</td>" 
                          +"<td>"+item['08']+"</td>" 
                          +"<td>"+item['09']+"</td>" 
                          +"<td>"+item['10']+"</td>" 
                          +"<td>"+item['11']+"</td>" 
                          +"<td>"+item['12']+"</td>"
                          +"<td>"+item.rowTotal+"</td>"
                        +"</tr>"; 
                    });
                    $("#sj_table",wraper).append(str);
                  }
                });
  })

	});
    // var items=$.jRadGet({url:'/vip-ws/ws/0.1/qrcodeActiveStatic/activeReport?type=1&shopAccountId='+carsmart_config.shopId});
    // $.each(items,function(i){
    // 	var index=items.length();
    // 	$(".count_qrnum").find("td:eq[0]").html(items[index-1].01);
    // })
	 
</script>