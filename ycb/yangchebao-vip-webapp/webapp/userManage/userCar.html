<style>
    .hDiv table th, .bDiv table td, .hDiv table td .bDiv table th{
        text-align:center;
    }        
    .ul-letters { float: left;}
    .uperCase{ border: 1px solid #bfbfbf;color: #505050;cursor: pointer;height: 20px;line-height: 20px;margin: 1px 6px 3px 0px;text-align: center;width: 20px;float: left;}
    .ul-letters .active {border: 2px solid #3ea5f4;height: 16px;line-height: 16px;width: 16px;}
    .brand-letter {overflow: hidden;padding: 5px 0 5px;}
    .car-list{overflow:hidden;margin-left:14px;}
    .car-list li{float:left;padding:5px 15px;margin:8px 5px 5px 5px;margin-right:18px;display:inline;text-align:center;height:28px;line-height:28px;border:1px solid #ccc;cursor:pointer;}
    .last{display:none;float:left;border:1px solid #ccc;padding:5px;overflow:hidden;}
    .last span{float:left;margin-top:1px;}
    .last a{ border: none;color: #fff;cursor: pointer;background:#2f8ac8;float: left;height: 20px;line-height: 20px;margin: 1px 3px 3px 3px;text-align: center;width:20px;}
    .last a:hover{text-decoration:underline;}
    .isycb{position:absolute;z-index:100;background:#cccccc;filter:alpha(Opacity=60);-moz-opacity:0.6;opacity: 0.6;}
</style>
<div class="urlContentWraper" id="Wraper_userCar_manage">
    <div class="ui-info-layout">
    	<div class="vdiv">
            <table id="Table_userCar_list">
            </table>
        </div>
	</div>  

    <div id="Form_carCustomer_add" class="grid-layout ui-form" style="display:none;">
        <div class="grid-layout-main jrad-form">
            <div class="grid-row-fluid"> 
                <p class="note" style="padding-left:85px;color:#ff0000;">此客户暂无基本信息，请先输入基本信息。</p>
                <label class="span5 grid-layout-label"><span class="ui-form-required">*</span>姓名：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="userName" class="jrad-input-container" placeholder="例：李先生、刘备">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">
                <span class="ui-form-required">*</span>手机：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="mobile" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">生日：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="birthday" class="jrad-dateinput-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">家庭住址：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="familyAddress" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次服务时间：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="lastServiceTime" class="jrad-dateinput-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次回访时间：</label>
                <div class="span8 grid-layout-content fluid-wrap">
                    <div name="lastVisitTime" class="jrad-dateinput-container">
                    </div>
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container">
            <button class="jrad-btn-primary btn btn-small btn-primary">确定</button>
            <button class="jrad-btn-normal btn btn-small btn-default">取消</button>
        </div>
    </div> 

    <div id="Form_customer_add_userCar" class="grid-layout ui-form" style="display:none;">
        <div class="grid-layout-main jrad-form">
            <input type="hidden" class="userInfoId">
            <input type="hidden" class="userName">
            <div name="brands"></div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label"><span class="ui-form-required">*</span>客户手机：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="mobile" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label"><span class="ui-form-required">*</span>车系：</label>
                <div class="span15">
                    <div class="searchBox" id="searchBox">
                        <div class="brand" id="brand_show">
                            <div class="brand-letter">
                                <span class="condition-title">按字母查找</span>
                                <ul class="ul-letters">
                                </ul>
                                <div class="last" style="position:relative;"></div>
                            </div>
                            <ul class="car-list">
                            </ul>
                        </div>
                    </div>
                </div>
            </div> 
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">
                <span class="ui-form-required">*</span>车牌：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="plateNumber" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label"><span class="ui-form-required">*</span>车架号：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="vinNumber" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">发动机号：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="machineNumber" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">底盘号：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="chassisNumber" class="jrad-input-container">
                    </div>
                    <p class="note">养车宝会通过上面3个字段查询违章，以您店铺的名义通知客户。</p>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">购车日期：</label>
                <input name="startDate" id="startDate" class="date-picker" style="width:303px;height:20px;margin-left:6px;padding:4px;" /> 
                <!-- <div class="span14 grid-layout-content fluid-wrap">
                    <div name="buyDate" class="jrad-dateinput-container">
                    </div>
                </div> -->
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">里程(km)：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="totalMileage" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">是否二手车：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="isUsed" class="jrad-select-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">颜色：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="color" class="jrad-select-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">内饰风格：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="interiorStyle" class="jrad-select-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">几成新：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="percentNew" class="jrad-select-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">是否改装：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="isRefit" class="jrad-select-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次保养时间：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="lastMaintainDate" class="jrad-dateinput-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次保养里程：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="lastMaintainMileage" class="jrad-input-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次年审时间：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="lastLimitedDate" class="jrad-dateinput-container">
                    </div>
                </div>
            </div>
            <div class="grid-row-fluid">
                <label class="span5 grid-layout-label">上次保险时间：</label>
                <div class="span14 grid-layout-content fluid-wrap">
                    <div name="lastInsuredDate" class="jrad-dateinput-container">
                    </div>
                    <p class="note">养车宝会通过上面字段判断用户是否需要保养、保险，若需要，会通知客户到您的店铺服务。请尽量填写完整。</p>
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container">
            <button class="jrad-btn-primary btn btn-small btn-primary">确定</button>
            <button class="jrad-btn-normal btn btn-small btn-default">取消</button>
        </div>
    </div> 
</div>
<script type="text/javascript">
$(document).ready(function() {
	var wraper = $('#Wraper_userCar_manage');
	var parentId = carsmart_config.shopId;
    var page_column_model = new Array();
    var page_search_items = new Array();
    var page_list_buttons = new Array(); 

	var entityModel = {};
    var jRad = $.jRad({app:'radsample-ws',entityModel:entityModel});
    jRad.validators['mobile'] = [{msg:"手机号不能为空",type:'min',value:'1'}];

    jRad.params['isUsed']={data:[{id:'',name:'全部'},{id:'2',name:'不确定'},{id:'0',name:'否'},{id:'1',name:'是'}]};
    jRad.params['interiorStyle']={data:[{id:'',name:'全部'},{id:'0',name:'普通'},{id:'1',name:'简约'},{id:'2',name:'豪华'},{id:'3',name:'其他'}]};
    jRad.params['isRefit']={data:[{id:'',name:'全部'},{id:'2',name:'不确定'},{id:'0',name:'否'},{id:'1',name:'是'}]};
    jRad.params['percentNew']={data:[{id:'',name:'全部'},{id:'0',name:'不确定'},{id:'1',name:'1'},{id:'2',name:'2'},{id:'3',name:'3'},{id:'4',name:'4'},{id:'5',name:'5'},{id:'6',name:'6'},{id:'7',name:'7'},{id:'8',name:'8'},{id:'9',name:'9'},{id:'10',name:'10'}]};

    var field_params={};  
    field_params['isUsed']={data:[{id:'2',name:'不确定'},{id:'0',name:'否'},{id:'1',name:'是'}]};
    field_params['color']={data:[{id:'黑',name:'黑'},{id:'白',name:'白'},{id:'红',name:'红'},{id:'粉',name:'粉'},{id:'绿',name:'绿'},{id:'黄',name:'黄'},{id:'灰',name:'灰'},{id:'银',name:'银'},{id:'蓝',name:'蓝'},{id:'棕',name:'棕'},{id:'其他',name:'其他'}]};
    field_params['interiorStyle']={data:[{id:'0',name:'普通'},{id:'1',name:'简约'},{id:'2',name:'豪华'},{id:'3',name:'其他'}]};
    field_params['percentNew']={data:[{id:' ',name:'不确定'},{id:'1',name:'1'},{id:'2',name:'2'},{id:'3',name:'3'},{id:'4',name:'4'},{id:'5',name:'5'},{id:'6',name:'6'},{id:'7',name:'7'},{id:'8',name:'8'},{id:'9',name:'9'},{id:'10',name:'10'}]};
    field_params['isRefit']={data:[{id:'2',name:'不确定'},{id:'0',name:'否'},{id:'1',name:'是'}]};

    $('.date-picker').datepicker( {
        changeMonth: true, 
        changeYear: true, 
        showButtonPanel: true, 
        dateFormat: 'yy-mm', 
        onClose: function(dateText, inst) { 
            var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val(); 
            var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val(); 
            $(this).datepicker('setDate', new Date(year, month, 1)); 
            $("ui-datepicker-calendar").hide();
        },
    }); 
    var now = new Date();
    var currentdate = now.getFullYear()+"-"+((now.getMonth()+1)<10?"0":"")+(now.getMonth()+1)+"-"+(now.getDate()<10?"0":"")+now.getDate();
   
    page_column_model.push({display: '是否养车宝用户', name : 'sourceFlag',hidden:true});
    page_column_model.push({display: '客户姓名', name : 'userName',diy:function(item,$div){
        if(item.userName == '' || item.userName == undefined){
            $div.html("--")
        }else{
            $div.html(item.userName)
        }
    }});
    page_column_model.push({display: '手机号', name : 'mobile'});
    page_column_model.push({display: '车系', name : 'seriesId'});
    page_column_model.push({display: '车牌', name : 'plateNumber',diy:function(item,$div){
        if(item.plateNumber == '' || item.plateNumber == undefined){
            $div.html("--")
        }else{
            $div.html(item.plateNumber)
        }
    }});
    page_column_model.push({display: '购车日期', name : 'buyDate',diy:function(item,$div){
        if(item.buyDate == '' || item.buyDate == undefined){
            $div.html("--")
        }else{
            $div.html(item.buyDate)
        }
    }});
    page_column_model.push({display: '里程(km)', name : 'totalMileage'}); 
    page_column_model.push({display: '是否二手车', name : 'isUsed'});
    page_column_model.push({display: '颜色', name : 'color'});
    page_column_model.push({display: '内饰风格', name : 'interiorStyle'});
    page_column_model.push({display: '几成新', name : 'percentNew'});
    page_column_model.push({display: '是否改装', name : 'isRefit'});
    
    page_search_items.push({row:'1',type:'jrad-input',display:'客户姓名',name:'userName'});
    page_search_items.push({row:'1',type:'jrad-input',display:'手机号',name:'mobile'});
    page_search_items.push({row:'1',type:'jrad-input',display:'车系',name:'seriesId'});
    page_search_items.push({row:'2',type:'jrad-input',display:'车牌',name:'plateNumber'});
    page_search_items.push({row:'2',type:'jrad-select',display:'是否二手车',name:'isUsed',params:jRad.params['isUsed']});
    page_search_items.push({row:'2',type:'jrad-select',display:'内饰风格',name:'interiorStyle',params:jRad.params['interiorStyle']});
    page_search_items.push({row:'3',type:'jrad-select',display:'是否改装',name:'isRefit',params:jRad.params['isRefit']});
    page_search_items.push({row:'3',type:'jrad-select',display:'几成新',name:'percentNew',params:jRad.params['percentNew']});

    page_list_buttons.push({title: '新增',displayname:'新增',bclass: 'icon-plus',
        onpress: function(){
            //var checked = $('#Table_customer_list').getCheckedTrs();
            $('#Form_customer_add_userCar').form({
                title: '创建车辆',
                grid:18,
                item:{},
                fields:field_params,
                validators: jRad.validators, 
                url:'/vip-ws/ws/0.1/userManager/addCarInfo',
                preSubmit:function(json){
                    json.businessInfoId = carsmart_config.businessInfoId;
                    json.userInfoId = $(".userInfoId").val();
                    json.ownerName = $(".userName").val();
                    json.seriesId = $('.last span').attr("id");
                    json.buyDate = $('#startDate').val()
                    return json;
                },
                success: function() {
                    $('#Table_userCar_list').flexMessage('创建成功', 'success');
                    $('#Table_userCar_list').flexReload();
                }
            }).form('open');
            $('#startDate').val("");

            $("#Form_customer_add_userCar input[name='plateNumber']").attr("maxlength","10")
            $("#Form_customer_add_userCar input[name='machineNumber']").attr("maxlength","30")
            $("#Form_customer_add_userCar input[name='vinNumber']").attr("maxlength","30")
            $("#Form_customer_add_userCar input[name='chassisNumber']").attr("maxlength","30")
            $("#Form_customer_add_userCar div[name='mobile']").input('readonly',false)
            $('#Form_customer_add_userCar input[name="mobile"]').blur(function(){
                var str = $('#Form_customer_add_userCar div[name="mobile"]').input('val');
                $.jRadGet({
                    url:'/vip-ws/ws/0.1/userManager/checkMobile?mobile='+str,
                    async:false,
                    success:function(){
                    },
                    error:function(xhr){
                        var errormsg = eval("(" + xhr.responseText + ")");
                        if(errormsg[0].message == '手机号码格式不正确'){
                            $.jRadMessage({level:'error',message:errormsg[0].message,selector:$('#Form_customer_add_userCar .pop-up-content')});
                        }
                        else if(errormsg[0].message == '手机号码不允许为空'){
                            $.jRadMessage({level:'error',message:errormsg[0].message,selector:$('#Form_customer_add_userCar .pop-up-content')});
                        }
                        else{
                            $('#Form_customer_add_userCar').form({}).form('close')
                            $('#Form_carCustomer_add').form({
                                title: '创建客户',
                                submit:function(){
                                    var flag = $('#Form_carCustomer_add',wraper).form('validateAll');
                                    if(flag){
                                        var json = $('#Form_carCustomer_add',wraper).form('getValue'); 
                                        json.businessInfoId = carsmart_config.businessInfoId; 
                                        $.jRadPost({
                                            url:'/vip-ws/ws/0.1/userManager/addUser',
                                            data:json,
                                            success:function(data){ 
                                                $('#Form_carCustomer_add').form('close')
                                                $('#Form_customer_add_userCar').form({
                                                    item:{mobile:str}
                                                }).form('open')
                                                $(".userName").val(data.ownerName);
                                                $(".userInfoId").val(data.userInfoId);
                                            },
                                            error:function(data){
                                                var mes = eval('('+data.responseText+')');
                                                $.jRadMessage({level:'error', message:mes[0].message,selector:$('#Form_carCustomer_add .pop-up-middle')});
                                            }
                                        });
                                    }    
                                },
                                cancel:function(){
                                    $('#Form_customer_add_userCar').form({}).form('close')
                                    $('#Form_carCustomer_add').form({}).form('close')
                                    $(".scroll-up-btn").click();
                                }
                            }).form('open')
                        }
                        
                    }
                })
            })
            brandFn();
            $(".ul-letters").show();
            $(".last").html("").hide();
            $('.car-list').show().html('');
        }
    });
    page_list_buttons.push({title: '修改',displayname:'修改',bclass: 'edit',
        prefunc:function(){
            var checked = $('#Table_userCar_list').getCheckedTrs();
            if (checked.length != 1 || checked[0].sourceFlag == "ycb") {return false;}else{return true;}
        },
        onpress: function() { 
            var checked = $('#Table_userCar_list').getCheckedTrs();
            var carDetail = $.jRadGet({url:'/vip-ws/ws/0.1/userManager/getCarInfoDetail?carInfoId='+checked[0].carInfoId});
            $('#Form_customer_add_userCar').form({
                title: '修改车辆', 
                item: carDetail,  
                fields:field_params,
                url: '/vip-ws/ws/0.1/userManager/updateCarInfo',
                preSubmit:function(json){ 
                    var checked = $('#Table_userCar_list').getCheckedTrs();
                    json.businessInfoId = carsmart_config.businessInfoId;
                    json.carInfoId = checked[0].carInfoId;        
                    json.seriesId = $('.last span').attr("id");
                    json.buyDate = $('#startDate').val();
                    return json;
                },
                success:function(){ 
                    $('#Table_userCar_list').flexMessage('修改成功', 'success');
                    $('#Table_userCar_list').flexReload();
                }
            }).form('open');
            $('#startDate').val(carDetail.buyDate);

            $("#Form_customer_add_userCar input[name='plateNumber']").attr("maxlength","10")
            $("#Form_customer_add_userCar input[name='machineNumber']").attr("maxlength","30")
            $("#Form_customer_add_userCar input[name='vinNumber']").attr("maxlength","30")
            $("#Form_customer_add_userCar input[name='chassisNumber']").attr("maxlength","30")
            var mobile = checked[0].mobile;
            $("#Form_customer_add_userCar div[name='mobile']").input('val',mobile)
            $("#Form_customer_add_userCar div[name='mobile']").input('readonly',true)
            $('.last').show().html('');
            var _span = $('<span>').html(carDetail.carModel).attr("id",carDetail.seriesId)
            var _a = $('<a>').html('X')
            $('.last').append(_span).append(_a)
            $('.condition-title').hide();
            $('.ul-letters').hide();
            $('.last a').on('click',function(){
                $('.last').hide();
                $('.ul-letters').show();
                brandFn()
                $('.condition-title').show();
                $('.uperCase').removeClass("active");
                $('.car-list').show().html('');
            })
            if(checked[0].sourceFlag == 'ycb'){
                $(".last").addClass("isycb");
                $(".last a").remove();
            }
        }
    });
    page_list_buttons.push({title: '删除',displayname:'删除',bclass: 'delete',
        prefunc:function(){
            var checked = $('#Table_userCar_list').getCheckedTrs();
            if (checked.length == 0 || checked[0].sourceFlag == "ycb") {return false;}else{return true;}
        },
        onpress: function(){ 
            //用户自行添加信息，不允许删除
            var checked = $('#Table_userCar_list').getCheckedTrs();
            if(checked[0].sourceFlag == "ycb"){    
                $.jRadAlert('用户自行添加信息，不允许删除','error')
            }else{
                $.jRadConfirm('确认删除吗？',1,function(){
                    var checked = $('#Table_userCar_list').getCheckedTrs();
                    var postData = []; 
                    $.each(checked,function(i){ 
                        var postJson={};
                        postJson.businessInfoId=carsmart_config.businessInfoId;
                        postJson.plateNumber=this.plateNumber;
                        postJson.carInfoId=this.carInfoId;
                        postData.push(postJson)
                    });
                    $.jRadPost({  
                        url:'/vip-ws/ws/0.1/userManager/delCarInfo',
                        data:postData, 
                        success: function(data){ 
                            $('#Table_userCar_list').flexMessage('删除成功!', 'success');
                            $('#Table_userCar_list').flexReload();
                        },
                        error:function(xhr){ 
                            var errormsg = eval("(" + xhr.responseText + ")"); 
                            if (errormsg != undefined) {
                                $('#Table_userCar_list').flexMessage(errormsg[0].message, 'error');
                            }
                        }
                    });
                });
            }
        }
    }); 
    $('#Table_userCar_list').flexigrid({
        reload: true,
        pagination: {diaplay_pages: 10,align:'bottom',showText: '从第_start_到_end_项 共_total_项'},
        colModel: page_column_model,
        searchitems: page_search_items,
        buttons : page_list_buttons,
        pagedStyle: 'oc',
		method:'get',
		showSearch:true,
        overflow:true,
        onError:showError,
        url:'/vip-ws/ws/0.1/userManager/getCarInfoList?businessInfoId='+carsmart_config.businessInfoId
    });
    $('.vdiv .tDiv',wraper).before('<span style="margin:0 20px 0 14px;font-size:15px;float:left;line-height:60px;">客户车辆列表</span>');

    function showError(xhr){
        var errormsg = eval("(" + xhr.responseText + ")");
        var vdiv = $("#Wraper_userCar_manage .vdiv");
        $.jRadMessage({level:'error',message:errormsg[0].message,selector:vdiv});
    }
    $('.hDiv tr th').eq(1).attr("style","display:none;")
    $('.hDiv',wraper).css('overflow','hidden');
    $('.bDiv',wraper).css('overflow-x','scroll');

    function brandFn(){
        var brandList = $.ajax({url:"/shopmanage-ws/ws/0.1/support/brand/list",async:false});
        var msg = eval("(" + brandList.responseText + ")");
        var A_Z="";
        for(var i=65;i<91;i++){
            if(i == 69 || i== 73 || i == 85 || i == 86){
                A_Z+="";
            }else{  
                A_Z+="<li  class='uperCase uperCasess' data-num="+i+">"+String.fromCharCode(i)+"</li>";
            }
        };
        $("#searchBox .ul-letters").html(A_Z);

        $('.ul-letters li').on('click',function(){
            var str = $(this).html();
            var data = eval('msg.'+str)
            var _li = '';
            $('.car-list').html("");
            $.each(data,function(i){
                var item = data[i]
                _li += '<li data-id='+item.id+'>'+item.name+'</li>'
            })
            $('.car-list').append(_li);

            $('.car-list li').on('click',function(){
                var str = $(this).attr("data-id")
                //http://10.23.31.151/shopmanage-ws/ws/0.1/modelCms/factory/list?brandId=84&_=1449651904401
                var modelList = $.ajax({url:'/shopmanage-ws/ws/0.1/support/model/list?brandId='+str,async:false})
                var data2 = eval("(" + modelList.responseText + ")");
                $('.car-list').html("");
                var _li2 = '';
                $.each(data2,function(i){
                    var item2 = data2[i]
                    _li2 += '<li data-id='+item2.id+'>'+item2.name+'</li>'
                })
                $('.car-list').append(_li2);

                $('.car-list li').on('click',function(){
                    $('.car-list').html("");
                    var str = $(this).attr("data-id")
                    var modelList2 = $.ajax({url:'/shopmanage-ws/ws/0.1/modelCms/model/list?factoryId='+str,async:false})
                    var data3 = eval("(" + modelList2.responseText + ")");
                    $('.car-list').html("");
                    var _li3 = '';
                    $.each(data3,function(i){
                        var item3 = data3[i]
                        _li3 += '<li data-id='+item3.modelId+'>'+item3.modelName+'</li>'
                    })
                    $('.car-list').append(_li3);
                    
                    $('.car-list li').on('click',function(){
                        var str = $(this).attr("data-id")
                        $('.ul-letters').hide();
                        $('.car-list').hide();
                        $('.condition-title').hide();
                        $('.last').show().html('<span id='+str+'>'+$(this).html()+'</span><a href="javascript:void(0)">X</a>');

                        $('.last a').on('click',function(){
                            $('.last').hide();
                            $('.ul-letters').show();
                            $('.condition-title').show();
                            $('.uperCase').removeClass("active");
                            $('.car-list').show().html('');
                        })
                    })

                })

                
            })
        });

        $("body").on("click","#searchBox .uperCasess", function(){
            $(this).siblings(".uperCase").removeClass("active").end().addClass("active");
        })
    }
});
</script>