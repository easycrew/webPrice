<div class="urlContentWraper" id="Wraper_oilPriceWarning">
    <div class="ui-info-layout">
        <h2 class="ui-tit"><strong>预警信息</strong><bottom class="all-work-info numb125">页面说明</bottom></h2>
        <!-- 列表显示 -->
        <table id="Table_oilPriceWarning"></table>
    </div>
    <div id="Form_oilPriceWarning" style="display:none;"> 
		<div class="grid-layout-main jrad-form">
            <input name="id" type="hidden">   
			<div class="row">
                 <label class="span3 grid-layout-label">预警内容：</label>
                 <div class="span5 grid-layout-content">
                       <div name="content" class="jrad-textarea-container"></div>
                                    </div>
            </div>  
        </div> 
        <div class="jrad-buttons-container ui-buttons-container">
            <span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span> 
        </div>
    </div>
    <div id="Form_explain_eg125" style="display:none;">
        <div class="grid-layout-main jrad-form"> 
            <div class="row">
                <label class="span3 grid-layout-label">业务说明：</label>
                <div class="span12 grid-layout-content">
                    <div><strong>功能简介：</strong>此功能已停用。</div>
                    <div><strong>重要功能说明：</strong>无。</div>
                    <div><strong>注意事项：</strong>无。</div>
                </div> 
            </div> 
            <div class="row">
                <label class="span3 grid-layout-label">备注：</label>
                <div class="span12 grid-layout-content">
                    <div class="jrad-textarea-container" name="remark">
                    </div>
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span> 
            <span class="jrad-btn-normal">取消</span>
        </div>
    </div>
</div>
<script type="text/javascript">
$(document).ready(function(){ 
    var wraper = $('#Wraper_oilPriceWarning');
    var page_column_model = new Array();
    var page_search_items = new Array();
    var page_list_buttons = new Array();
	 	
	var entityModel = {};
    var jRad = $.jRad({app:'radsample-ws',entityModel:entityModel}); 
    jRad.validators['content'] = [{msg:"请输入预警内容",type:'min',value:'1'}]; 
	 
	var fields_params = {};	 
	fields_params['content'] = {
			grid:10
	};
    page_column_model.push({display: '预警内容', name : 'content'});
    page_column_model.push({display: '创建人', name : 'createPerson'});
	page_column_model.push({display: '创建时间', name : 'createDate'});
 
	page_list_buttons.push({title: '创建',name:'Add', bclass: 'add',onpress : function(){
            $('#Form_oilPriceWarning').form({
                title: '创建',
                validators: jRad.validators,
                fields_params: fields_params,
                item:{}, 
				url:'/shopmanage-ws/ws/0.1/oilPricesWarning/addOilPricesWarning',
				before_submit:function(json){
				  json.createPerson = carsmart_config.operatorName;
				  return json;
				},
                success_callback: function(){
					$('#Table_oilPriceWarning').flexMessage('创建成功!', 'success');
					$('#Table_oilPriceWarning').flexReload();
				} 
            }).form('open'); 
        }
    });
	var readonlyFields = {};
	readonlyFields['users'] = true; 
	page_list_buttons.push({title: '修改',name:'Edit', bclass: 'edit',prefunc:function(){
            var checked = $('#Table_oilPriceWarning').getCheckedTrs();
            if (checked.length != 1) {return false;}else{return true;}
        },onpress : function(){
            var checked = $('#Table_oilPriceWarning').getCheckedTrs(); 
            if(checked[0]) { 
				$('#Form_oilPriceWarning').form({
					title: '修改',
					validators: jRad.validators,
					fields_params: fields_params,
					item:checked[0], 
					url:'/shopmanage-ws/ws/0.1/oilPricesWarning/editOilPricesWarning',
					before_submit:function(json){
					  json.createPerson = carsmart_config.operatorName;
					  return json;
					},
					success_callback: function(){
						$('#Table_oilPriceWarning').flexMessage('修改成功!', 'success');
						$('#Table_oilPriceWarning').flexReload();
					} 
				}).form('open'); 
            }
        }
    }); 
  
	page_list_buttons.push({name:'delete',bclass: 'delete',prefunc:function(){
            var checked = $('#Table_oilPriceWarning').getCheckedTrs();
            if (checked.length != 1) {return false;}else{return true;}
        },onpress : function(){
	    	var checked = $('#Table_oilPriceWarning').getCheckedTrs();
			$.jRadConfirm('确认删除吗？',1,function(){
				var id =  checked[0].id; 
				$.jRadAjax({
				    type:'post',
					url:'/shopmanage-ws/ws/0.1/oilPricesWarning/deleteOilPricesWarning?id='+id, 
					success: function(){
						$('#Table_oilPriceWarning').flexMessage('删除成功!', 'success');
           	    		$('#Table_oilPriceWarning').flexReload();
					},
					error:function(xhr){
					    var errormsg = eval("(" + xhr.responseText + ")"); 
						if (errormsg != undefined) {
							$('#Table_oilPriceWarning').flexMessage(errormsg[0].message, 'error');
						}
					}
				});
			});
		}
	}); 
    page_list_buttons.push({separator: true});
    
    $('#Table_oilPriceWarning').flexigrid({
            reload:true,
			method:'get',
            colModel : page_column_model,
            buttons : page_list_buttons,
            searchitems :page_search_items,
            pagination: {
				diaplay_pages: 5,
				align: 'bottom' 
			},
			showSearch:true,
            url:'/shopmanage-ws/ws/0.1/oilPricesWarning/queryOilPricesWarning',
			onError:showOilPricesWarningError,
			overflow:false
    });  
    $(".numb125").click(function(){
        $('.overcurtainDiv').hide();
        var menuId = $(".tabs-selected").attr("menuId")
        var data = $.jRadGet({url:'/shopmanage-ws/ws/0.1/remark/getMenuRemark?menuId='+menuId})
        $("#Form_explain_eg125").form({}).form('close');
        $("#Form_explain_eg125").form({
            title:'页面说明',
            item:data,
            autobinding: true, 
            submit:function(){
                var postData = {};
                postData.operator = carsmart_config.operatorName;
                postData.menuName = $(".tabs-selected").attr("menuName");
                postData.menuId = $(".tabs-selected").attr("menuId");
                postData.remark = $("#Form_explain_eg125 div[name='remark']").textarea("val")
                $.jRadPost({
                    url:'/shopmanage-ws/ws/0.1/remark/updateMenuRemark',
                    data:postData,
                    success:function(){
                        $("#Form_explain_eg125").form('close')
                        $('.overcurtainDiv').hide();
                    }
                });
            }, 
            cancel:function(){
                $("#Form_explain_eg125").form('close')
                $('.overcurtainDiv').hide();
            }
        }).form('open')
        $("#Form_explain_eg125 .textarea-content").removeClass("span4").addClass("span12")
        $('.overcurtainDiv').hide();
        $('.overcurtainDiv').eq(0).show().attr("style","z-index:303;display:block");
    })
}); 

function showOilPricesWarningError(xhr){
			 var errormsg = eval("(" + xhr.responseText + ")");
			  var cDiv = $("#Wraper_oilPriceWarning .cDiv");
			  $.jRadMessage({level:'error',message:errormsg[0].message,selector:cDiv});
			} 
 
</script>
