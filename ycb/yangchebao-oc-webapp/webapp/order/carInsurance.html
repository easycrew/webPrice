<style>
    #Table_insurance_type tr{
        height:24px;
    }
    .tb{
        height:20px;
        font-size: 14px;
    }
</style>
<div class="urlContentWraper" id="Wraper_insurance_order"> 
    <div class="row-fluid ui-data-show"> 
            <div class="hDiv">
                 <h2 class="ui-tit"><strong>去哪保订单</strong><bottom class="all-work-info numb55">页面说明</bottom></h2>
                 <table id="Table_insurance_order"></table>
            </div> 
    </div> 
    
    <div id="Form_insurance_order" style="display:none;">
        <div class="grid-layout-main jrad-form">  
            <div class="row"> 
                <label class="span4 grid-layout-label voucherType"> 
                    微信活动是否开启：
                </label>
                <div class="span5 grid-layout-content fluid-wrap voucherType">
                    <div name="wxActiveReasult" class="jrad-select-container"></div> 
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span>
            <span class="jrad-btn-normal">取消</span>
        </div>
    </div>

    <div id="Form_insurance_order_set" style="display:none;">
        <div class="grid-layout-main jrad-form">    
            <div class="row"> 
                <label class="span2 grid-layout-label"> 
                    <strong>交强险</strong>
                </label>
            </div>
            <div class="row-fluid r-jqx">
                 <label class="span3 grid-layout-label"></label>
                 <div class="span18 grid-layout-content">
                       <div name="sumType" class="jrad-radio-container"></div>
                 </div>
            </div>
            <div class="row jqx">
                <label class="span3 grid-layout-label"></label>
                <div class="span5 grid-layout-content fluid-wrap">
                    <div name="count" class="jrad-input-container">
                    </div>
                </div>
                <p class="span1 grid-layout-label bfb" style="display:none;margin-left:0;width:10px">%</p>
            </div>


            <div class="row"> 
                <label class="span2 grid-layout-label"> 
                    <strong>商业险</strong>
                </label>
            </div>
            <div class="row-fluid r-syx">
                 <label class="span3 grid-layout-label"></label>
                 <div class="span18 grid-layout-content">
                       <div name="sumType" class="jrad-radio-container"></div>
                 </div>
            </div>
            <div class="row syx">
                <label class="span3 grid-layout-label"></label>
                <div class="span5 grid-layout-content fluid-wrap">
                    <div  name="count" class="jrad-input-container">
                    </div>
                </div>
                <p class="span1 grid-layout-label bfb" style="display:none;margin-left:0;width:10px">%</p>
            </div>


            <div class="row"> 
                <label class="span2 grid-layout-label"> 
                    <strong>车船税</strong>
                </label>
            </div>
            <div class="row-fluid r-ccs">
                 <label class="span3 grid-layout-label"></label>
                 <div class="span18 grid-layout-content">
                       <div name="sumType" class="jrad-radio-container"></div>
                 </div>
            </div>
            <div class="row ccs">
                <label class="span3 grid-layout-label"></label>
                <div class="span5 grid-layout-content fluid-wrap">
                    <div name="count" class="jrad-input-container">
                    </div>
                </div>
                <p class="span1 grid-layout-label bfb" style="display:none;margin-left:0;width:10px">%</p>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span>
            <span class="jrad-btn-normal">取消</span>
        </div>
    </div>
    <div id="Form_insurance_detail" style="display:none;">
      <div class="grid-layout-main jrad-form">
        <table id="Table_insurance_detail">
            <tr>
                <th style="width:150px;">状态变更</th>
                <th>变更时间</th>
            </tr>
        </table>
      </div>
    </div> 

    <div id="Form_insurance_baodan" style="display:none;">
      <div class="grid-layout-main jrad-form">
        <table id="Table_insurance_baodan">
            <tr class="tb"><td><strong>车辆信息</strong></td></tr>
            <tr><td class="plateNum"></td></tr>
            <tr><td class="brandModel"></td></tr>
            <tr><td class="vin"></td></tr>
            <tr><td class="displacement"></td></tr>
            <tr><td class="firstRegDate"></td></tr>
            <tr class="tb"><td><strong>车主信息</strong></td></tr>
            <tr><td class="ownerName"></td></tr>
            <tr><td class="ownerCertNum"></td></tr>
            <tr class="tb"><td><strong>投保人信息</strong></td></tr>
            <tr><td class="proName"></td></tr>
            <tr><td class="proCertNum"></td></tr>
            <tr class="tb"><td><strong>被保人信息</strong></td></tr>
            <tr><td class="insuredName"></td></tr>
            <tr><td class="insuredCertNum"></td></tr>
            <tr class="tb"><td><strong>支付信息</strong></td></tr>
            <tr><td class="payWay"></td></tr>
            <tr><td class="payTime"></td></tr>
            <tr><td class="statusName"></td></tr>
            <tr><td class="price"></td></tr>
            <tr><td class="mqid"></td></tr>
            <tr><td class="busNo"></td></tr>
            <tr><td class="orderId"></td></tr>
            <tr><td class="realCharge"></td></tr>
        </table>
      </div>
    </div>

    <div id="Form_insurance_type" style="display:none;">
      <div class="grid-layout-main jrad-form">
        <table id="Table_insurance_type">
            <tr>
                <th style="width:150px;">险种名称</th>
                <th>保费(元)</th>
                <th>保额(元)</th>
            </tr>
            <tbody class="tr1">
                <tr><td><strong>基本险</strong></td></tr>
            </tbody>
            <tbody class="tr2">
                <tr><td><strong>附加险</strong></td></tr>
            </tbody>
            <tbody class="tr3">
                <tr><td><strong>不计免赔</strong></td></tr>
            </tbody>
            
        </table>
      </div>
    </div>
    <div id="Form_explain_eg55" style="display:none;">
        <div class="grid-layout-main jrad-form"> 
            <div class="row">
                <label class="span3 grid-layout-label">业务说明：</label>
                <div class="span12 grid-layout-content">
                    <div><strong>功能简介：</strong>APP上外接的去哪保的订单列表，现在已经停止合作了。</div>
                    <div><strong>重要功能说明：</strong>无。</div>
                    <div><strong>注意事项：</strong>无。</div>
                </div> 
            </div> 
            <div class="row">
                <label class="span3 grid-layout-label">备注：</label>
                <div class="span12 grid-layout-content">
                    <div class="jrad-textarea-container" name="remark">
                    </div>
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span> 
            <span class="jrad-btn-normal">取消</span>
        </div>
    </div>
</div>
<script type="text/javascript">
$(document).ready(function(){ 
    var wraper = $('#Wraper_insurance_order');
    var page_column_model = new Array();
    var page_search_items = new Array();
    var page_list_buttons = new Array(); 

    var entityModel = {};
    var jRad = $.jRad({app:'radsample-ws',entityModel:entityModel});  

    jRad.params['orderStatus'] = {
        data:[
              {id:'',name:'全部'},
              {id:'16',name:'核保中'},
              {id:'17',name:'核保成功'},
              {id:'18',name:'核保失败'},
              {id:'19',name:'待支付'},
              {id:'20',name:'支付号申请中'},
              {id:'21',name:'支付号申请成功'},
              {id:'22',name:'支付号申请失败'},
              {id:'23',name:'支付成功'},
              {id:'24',name:'支付失败'},
              {id:'25',name:'承保中'},
              {id:'26',name:'承保成功'},
              {id:'27',name:'承保失败'},
              {id:'28',name:'退单'},
              {id:'29',name:'订单取消'}
            ]
    }
    var fields_params = {};
    fields_params['wxActiveReasult'] = {data:[
        {id:'1',name:'是'},
        {id:'0',name:'否'}
    ]}
    fields_params['sumType'] = {data:[
        {id:'1',name:'固定金额'},
        {id:'2',name:'金额百分比'}
    ]}  
    fields_params['sumType']={
        data:[{id:'1',name:'固定金额'},{id:'2',name:'订单百分比'}],
        onclick:function(){  
            if($(".r-jqx div[data-name='sumType']",wraper).radio('val')=='1'){ 
               $(".jqx label",wraper).html('提成金额(元)：');
               $(".jqx .bfb",wraper).hide();
            }
            else{
               $(".jqx label",wraper).html('订单百分比：');
               $(".jqx .bfb",wraper).show();
            }
            if($(".r-syx div[data-name='sumType']",wraper).radio('val')=='1'){ 
               $(".syx label",wraper).html('提成金额(元)：');
               $(".syx .bfb",wraper).hide();
            }
            else{
               $(".syx label",wraper).html('订单百分比：');
               $(".syx .bfb",wraper).show();
            }
            if($(".r-ccs div[data-name='sumType']",wraper).radio('val')=='1'){ 
               $(".ccs label",wraper).html('提成金额(元)：');
               $(".ccs .bfb",wraper).hide();
            }
            else{
               $(".ccs label",wraper).html('订单百分比：');
               $(".ccs .bfb",wraper).show();
            }
        }
    };  
    $('#Form_insurance_order').form({ 
        grid: 16, 
        fluid: true,
        validators: jRad.validators,
        fields_params: fields_params, 
        type:'post'
    });     

    var appCode = "ycbqnb";
    page_column_model.push({display: '投保单号', name : 'prtNo'}); 
    page_column_model.push({display: '商业险承保单号', name : 'bizContNo'}); 
    page_column_model.push({display: '交强险承保单号', name : 'efcContNo'});
    page_column_model.push({display: '养车宝手机号', name : 'mobile'}); 
    page_column_model.push({display: '投保公司',name : 'insureCompany'});
    page_column_model.push({display: '交强险(元)', name : 'efcCharge',width:140});
    page_column_model.push({display: '商业险(元)', name : 'bizCharge',width:140}); 
    page_column_model.push({display: '车船税(元)', name : 'taxCharge',width:140}); 
    page_column_model.push({display: '返利金额(元)', name : 'rebCharge',width:150});  

    page_column_model.push({display: '保单基本信息',width:800,diy:function(item,$div){
        $div.html("<a href='javascript:' class='insurance_baodan'>点击查看</a>").css('text-align','left');
        $('.insurance_baodan',$div).unbind('click').bind('click',function(){
            $.jRadGet({
                url:'/shopmanage-ws/ws/0.1/insuredOrder/getOrderDetail?insureOrderId='+item.insuerOrderId+'&insureUserInfoId='+item.insueUserInfoId,
                success:function(data){
                    $("#Form_insurance_baodan").form({
                        title:"保单基本信息",
                        grid: 10,
                        success_callback:function(){
                            $('#Table_insurance_order').flexReload();
                        }
                    }).form('open');
                    if(data.plateNum){
                        $('#Table_insurance_baodan .plateNum').html('车牌号码：'+data.plateNum)
                    }else{
                        $('#Table_insurance_baodan .plateNum').html('车牌号码：')
                    }
                    if(data.brandModel){
                        $('#Table_insurance_baodan .brandModel').html('品牌型号：'+data.brandModel)
                    }else{
                        $('#Table_insurance_baodan .brandModel').html('品牌型号：')
                    }
                    if(data.vin){
                        $('#Table_insurance_baodan .vin').html('车辆识别代码：'+data.vin)
                    }else{
                        $('#Table_insurance_baodan .vin').html('车辆识别代码：')
                    }
                    if(data.displacement){
                        $('#Table_insurance_baodan .displacement').html('排气量：'+data.displacement)
                    }else{
                        $('#Table_insurance_baodan .displacement').html('排气量：')
                    }
                    if(data.firstRegDate){
                        $('#Table_insurance_baodan .firstRegDate').html('初登日期：'+data.firstRegDate)
                    }else{
                        $('#Table_insurance_baodan .firstRegDate').html('初登日期：')
                    }
                    if(data.ownerName){
                        $('#Table_insurance_baodan .ownerName').html('车主姓名：'+data.ownerName)
                    }else{
                        $('#Table_insurance_baodan .ownerName').html('车主姓名：')
                    }
                    if(data.ownerCertNum){
                        $('#Table_insurance_baodan .ownerCertNum').html('车主身份证号：'+data.ownerCertNum)
                    }else{
                        $('#Table_insurance_baodan .ownerCertNum').html('车主身份证号：')
                    }
                    if(data.proName){
                        $('#Table_insurance_baodan .proName').html('投保人姓名：'+data.proName)
                    }else{
                        $('#Table_insurance_baodan .proName').html('投保人姓名：')
                    }
                    if(data.proCertNum){
                        $('#Table_insurance_baodan .proCertNum').html('投保人身份证号：'+data.proCertNum)
                    }else{
                        $('#Table_insurance_baodan .proCertNum').html('投保人身份证号：')
                    }
                    if(data.insuredName){
                        $('#Table_insurance_baodan .insuredName').html('被保人姓名：'+data.insuredName)
                    }else{
                        $('#Table_insurance_baodan .insuredName').html('被保人姓名：')
                    }
                    if(data.insuredCertNum){
                        $('#Table_insurance_baodan .insuredCertNum').html('被保人身份证号：'+data.insuredCertNum)
                    }else{
                        $('#Table_insurance_baodan .insuredCertNum').html('被保人身份证号：')
                    }
                    if(data.payWay){
                        $('#Table_insurance_baodan .payWay').html('支付方式：'+data.payWay)
                    }else{
                        $('#Table_insurance_baodan .payWay').html('支付方式：')
                    }
                    if(data.payTime){
                        $('#Table_insurance_baodan .payTime').html('交易时间：'+data.payTime)
                    }else{
                        $('#Table_insurance_baodan .payTime').html('交易时间：')
                    }
                    if(data.statusName){
                        $('#Table_insurance_baodan .statusName').html('支付结果：'+data.statusName)
                    }else{
                        $('#Table_insurance_baodan .statusName').html('支付结果：')
                    }
                    if(data.price){
                        $('#Table_insurance_baodan .price').html('支付的金额：'+data.price)
                    }else{
                        $('#Table_insurance_baodan .price').html('支付的金额：')
                    }
                    if(data.mqid){
                        $('#Table_insurance_baodan .mqid').html('交易跟踪号：'+data.mqid)
                    }else{
                        $('#Table_insurance_baodan .mqid').html('交易跟踪号：')
                    }
                    if(data.busNo){
                        $('#Table_insurance_baodan .busNo').html('收款商户号码：'+data.busNo)
                    }else{
                        $('#Table_insurance_baodan .busNo').html('收款商户号码：')
                    }
                    if(data.orderId){
                        $('#Table_insurance_baodan .orderId').html('支付跟踪号：'+data.orderId)
                    }else{
                        $('#Table_insurance_baodan .orderId').html('支付跟踪号：')
                    }
                    if(data.realCharge){
                        $('#Table_insurance_baodan .realCharge').html('实际总支付金额：'+data.realCharge)
                    }else{
                        $('#Table_insurance_baodan .realCharge').html('实际总支付金额：')
                    }
                    
                },
                error:function(xhr){
                    var errormsg = eval("(" + xhr.responseText + ")"); 
                    if (errormsg != undefined) {
                        $('#Table_insurance_order').flexMessage(errormsg[0].message, 'error');
                    } 
                }
            })
        })
    }});  
    page_column_model.push({display: '险种基本信息',width:800,diy:function(item,$div){
        $div.html("<a href='javascript:' class='insurance_type'>点击查看</a>").css('text-align','left');
        $('.insurance_type',$div).unbind('click').bind('click',function(){

                var data1 = $.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getInsureDetail?prtNo='+item.prtNo+'&insureType='+1})
                var data2 = $.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getInsureDetail?prtNo='+item.prtNo+'&insureType='+2})    
                var data3 = $.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getInsureDetail?prtNo='+item.prtNo+'&insureType='+3})

                $("#Form_insurance_type").form({
                    title:"险种基本信息",
                    grid: 12
                }).form('open');

                var tr_len1=$("#Table_insurance_type .tr1",wraper).find("tr").length;
                    for(cur=0;cur<tr_len1;cur++){
                      if(cur!==0){
                        $("#Table_insurance_type .tr1",wraper).find("tr").eq(cur).hide();
                      }
                };
                var tr_len2=$("#Table_insurance_type .tr2",wraper).find("tr").length;
                    for(cur=0;cur<tr_len2;cur++){
                      if(cur!==0){
                        $("#Table_insurance_type .tr2",wraper).find("tr").eq(cur).hide();
                      }
                };
                var tr_len3=$("#Table_insurance_type .tr3",wraper).find("tr").length;
                    for(cur=0;cur<tr_len3;cur++){
                      if(cur!==0){
                        $("#Table_insurance_type .tr3",wraper).find("tr").eq(cur).hide();
                      }
                };
                var str1="";
                if(data1){
                    $.each(data1,function(i){
                        var _item=data1[i];
                        str1+="<tr>"
                            +"<td>"+_item.name+"</td>"
                            +"<td>"+_item.charge+"</td>"
                            +"<td>"+_item.amount+"</td>"
                            +"</tr>";
                    });
                }
                var str2="";
                if(data2){
                    $.each(data2,function(i){
                        var _item=data2[i];
                        str2+="<tr>"
                            +"<td>"+_item.name+"</td>"
                            +"<td>"+_item.charge+"</td>"
                            +"<td>"+_item.amount+"</td>"
                            +"</tr>";
                    });
                }
                var str3="";
                if(data3){
                    $.each(data3,function(i){
                        var _item=data3[i];
                        str3+="<tr>"
                            +"<td>"+_item.name+"</td>"
                            +"<td>"+_item.charge+"</td>"
                            +"<td>"+_item.amount+"</td>"
                            +"</tr>";
                    });
                }
                $("#Table_insurance_type .tr1",wraper).append(str1)
                $("#Table_insurance_type .tr2",wraper).append(str2)
                $("#Table_insurance_type .tr3",wraper).append(str3)

        })
    }}); 
    page_column_model.push({display: '订单状态', name : 'status'}); 
    page_column_model.push({display: '渠道', name : 'channel',width:100}); 
    page_column_model.push({display: '补贴开始时间', name : 'subsidyStartDate',width:140}); 
    page_column_model.push({display: '补贴结束时间', name : 'subsidyEndDate'});  
    page_column_model.push({display: '订单日志',diy:function(item,$div){
        $div.html("<a href='javascript:' class='insurance_detail'>点击查看</a>").css('text-align','left');
        $('.insurance_detail',$div).unbind('click').bind('click',function(){
            $.jRadGet({
                url:'/shopmanage-ws/ws/0.1/insuredOrder/getOrderLog?insureOrderId='+item.insuerOrderId+'&appCode='+appCode,
                success:function(data){
                    $("#Form_insurance_detail").form({
                        title:"订单日志",
                        grid: 8,
                        success_callback:function(){
                            $('#Table_insurance_order').flexReload();
                        }
                    }).form('open');
                    var tr_len=$("#Table_insurance_detail",wraper).find("tr").length;
                    for(cur=0;cur<tr_len;cur++){
                      if(cur!==0){
                        $("#Table_insurance_detail",wraper).find("tr").eq(cur).hide();
                      }
                    };
                    var str="";
                    $.each(data,function(i){
                        var _item=data[i];
                        str+="<tr>"
                            +"<td>"+_item.changeStatus+"</td>"
                            +"<td>"+_item.changeDate+"</td>"
                            +"</tr>";
                    });
                    $("#Table_insurance_detail",wraper).append(str);
                },
                      error:function(xhr){
                            var errormsg = eval("(" + xhr.responseText + ")"); 
                            if (errormsg != undefined) {
                                $('#Table_insurance_order').flexMessage(errormsg[0].message, 'error');
                            } 
                      }
            })
        })
    }});   
    page_search_items.push({row:'1',type:'jrad-input',display:'投保单号',name:'prtNo'});  
    page_search_items.push({row:'1',type:'jrad-input',display:'商业险承保单号',name:'bizContNo'}); 
    page_search_items.push({row:'1',type:'jrad-input',display:'交强险承保单号',name:'efcContNo'});
    page_search_items.push({row:'2',type:'jrad-input',display:'养车宝手机',name:'mobile'}); 
    page_search_items.push({row:'2',type:'jrad-input',display:'投保公司',name:'company'}); 
    page_search_items.push({row:'2',type:'jrad-select',display:'订单状态',name:'orderStatus',params:jRad.params['orderStatus']});   
    page_search_items.push({row:'3',type:'jrad-input',display:'渠道',name:'channel'}); 

    page_list_buttons.push({displayname: '微信活动设置',name:'wxcreat', bclass: 'wxcreat',onpress : function(){ 
            var _item = $.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/wxActiveGet'})
            $('#Form_insurance_order').form({
                title: '微信活动设置',
                item:_item,
                fields_params: fields_params,
                url:'/shopmanage-ws/ws/0.1/insuredOrder/wxActiveChange',
                before_submit:function(json){ 
                    return json;
                },
                success_callback:function(){ 
                    $('#Table_insurance_order').flexMessage('设置成功', 'success');
                    $('#Table_insurance_order').flexReload();
                }
            }).form('open');
        }
    });
    page_list_buttons.push({displayname: '提成金额设置',name:'moneyset', bclass: 'moneyset',onpress : function(){  
            var checked=$('#Table_insurance_order').getCheckedTrs();
            var _items=$.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getCommisionRule?appCode='+appCode});
            $('#Form_insurance_order_set').form({
                title: '提成金额设置',
                grid: 10, 
                //item:_items, 
                fields_params:fields_params,
                url:'/shopmanage-ws/ws/0.1/insuredOrder/setCommisionRule',
                before_submit:function(json){  
                    var postData = []; 
                    var json1 = {};
                    var json2 = {};
                    var json3 = {};
                    json1.risk="efc";
                    json1.sumType = $(".r-jqx div[data-name='sumType']",wraper).radio('val');
                    json1.count = $(".jqx div[data-name='count']",wraper).input('val');
                    if(json1.sumType == 1){
                        json1.count = $(".jqx div[data-name='count']",wraper).input('val');
                    }else{
                        //if($.isNumeric($(".jqx div[data-name='count']",wraper).input('val'))){
                        //var aaa = $(".jqx div[data-name='count']",wraper).input('val')/100
                        var aaa = $(".jqx div[data-name='count']",wraper).input('val')
                        json1.count = aaa.replace(/^\+?(\d*\.\d{2})$/);
                        // }else{
                        //       alert("请输入数字");
                        //       return false;
                        // }
                    }
                    json2.risk="biz";
                    json2.sumType = $(".r-syx div[data-name='sumType']",wraper).radio('val');
                    if(json2.sumType == 1){
                        json2.count = $(".syx div[data-name='count']",wraper).input('val');
                    }else{
                        //if($.isNumeric($(".syx div[data-name='count']",wraper).input('val'))){
                        //var bbb=$(".syx div[data-name='count']",wraper).input('val')/100
                        var bbb=$(".syx div[data-name='count']",wraper).input('val')
                            json2.count = bbb.replace(/^\+?(\d*\.\d{2})$/);
                        // }else{
                        //       alert("请输入数字");
                        //       return false;
                        // }
                    }
                    json3.risk="tax";
                    json3.sumType = $(".r-ccs div[data-name='sumType']",wraper).radio('val');
                    if(json3.sumType == 1){
                        json3.count = $(".ccs div[data-name='count']",wraper).input('val');
                    }else{
                        //if($.isNumeric($(".ccs div[data-name='count']",wraper).input('val'))){
                        //var ccc= $(".ccs div[data-name='count']",wraper).input('val')/100
                        var ccc= $(".ccs div[data-name='count']",wraper).input('val')
                            json3.count = ccc.replace(/^\+?(\d*\.\d{2})$/);
                        // }else{
                        //       alert("请输入数字");
                        //       return false;
                        // }
                    }
                    postData[0] =json1
                    postData[1] =json2
                    postData[2] =json3
                    return postData
                },              
                success_callback:function(){ 
                    $('#Table_insurance_order').flexMessage('编辑成功', 'success');
                    $('#Table_insurance_order').flexReloadCurrentPage()
                } 
            }).form('open'); 
            
            var posrad = []
            var posinp = []
            var rad = $('#Form_insurance_order_set div[name="sumType"]').radio('val')
            $.each(_items,function(i,val){
                var data = _items[i];
                var aaa = val["sumType"];
                var bbb = val["count"];
                posrad.push(aaa);
                posinp.push(bbb)
                $(".r-jqx div[data-name='sumType']",wraper).radio('val',posrad[0])
                $(".r-syx div[data-name='sumType']",wraper).radio('val',posrad[1])
                $(".r-ccs div[data-name='sumType']",wraper).radio('val',posrad[2])
                if($(".r-jqx div[data-name='sumType']",wraper).radio('val')==1){
                    $(".jqx div[data-name='count']",wraper).input('val',posinp[0])
                    $(".jqx label",wraper).html('提成金额(元)：');
                    $(".jqx .bfb",wraper).hide();
                }else{
                    //$(".jqx div[data-name='count']",wraper).input('val',posinp[0]*100)
                    $(".jqx div[data-name='count']",wraper).input('val',posinp[0])
                    $(".jqx label",wraper).html('订单百分比：');
                    $(".jqx .bfb",wraper).show();
                }
                if($(".r-syx div[data-name='sumType']",wraper).radio('val')==1){
                    $(".syx div[data-name='count']",wraper).input('val',posinp[1])
                    $(".syx label",wraper).html('提成金额(元)：');
                    $(".syx .bfb",wraper).hide();
                }else{
                    //$(".syx div[data-name='count']",wraper).input('val',posinp[1]*100)
                    $(".syx div[data-name='count']",wraper).input('val',posinp[1])
                    $(".syx label",wraper).html('订单百分比：');
                    $(".syx .bfb",wraper).show();
                }
                if($(".r-ccs div[data-name='sumType']",wraper).radio('val')==1){
                    $(".ccs div[data-name='count']",wraper).input('val',posinp[2])
                    $(".ccs label",wraper).html('提成金额(元)：');
                    $(".ccs .bfb",wraper).hide();
                }else{
                    //$(".ccs div[data-name='count']",wraper).input('val',posinp[2]*100)
                    $(".ccs div[data-name='count']",wraper).input('val',posinp[2])
                    $(".ccs label",wraper).html('订单百分比：');
                    $(".ccs .bfb",wraper).show();
                }
            })
        }
    }); 

    page_list_buttons.push({separator: true});
    $('#Table_insurance_order').flexigrid({
            reload:true,
            method:'get',
            colModel : page_column_model,
            buttons : page_list_buttons,
            searchitems :page_search_items,
            pagination: {
                diaplay_pages: 5,
                align: 'bottom' 
            },
            showSearch:true, 
            overflow:true,
            url:'/shopmanage-ws/ws/0.1/insuredOrder/getInsuredOrderList?appCode='+appCode, 
            onError:showError
            
    }); 
    var total=$.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getTotalCharge?appCode='+appCode});
    if(total.sumEfc){
        $('.hDivBox:eq(0) th:eq(6)',wraper).html('&nbsp;&nbsp;交强险(元)<br>（合计'+total.sumEfc+'元）');
        $('.hDivBox:eq(0) th:eq(7)',wraper).html('&nbsp;&nbsp;商业险(元)<br>（合计'+total.sumBiz+'元）');
        $('.hDivBox:eq(0) th:eq(8)',wraper).html('&nbsp;&nbsp;车船税(元)<br>（合计'+total.sumTax+'元）');
        $('.hDivBox:eq(0) th:eq(9)',wraper).html('&nbsp;&nbsp;返利金额(元)<br>（合计'+total.sumReb+'元）');
    }else{
        $('.hDivBox:eq(0) th:eq(6)',wraper).html('&nbsp;&nbsp;交强险(元)');
        $('.hDivBox:eq(0) th:eq(7)',wraper).html('&nbsp;&nbsp;商业险(元)');
        $('.hDivBox:eq(0) th:eq(8)',wraper).html('&nbsp;&nbsp;车船税(元)');
        $('.hDivBox:eq(0) th:eq(9)',wraper).html('&nbsp;&nbsp;返利金额(元)');
    }

    function excelplus(){
        var param = {};
             var prtNo = $.trim($(".searchContent div[name='prtNo']",wraper).input('val'));
             if(prtNo!=""){
                param['prtNo'] = prtNo;
             };
             var bizContNo = $.trim($(".searchContent div[name='bizContNo']",wraper).input('val'));
             if(bizContNo!=""){
                param['bizContNo'] = bizContNo;
             };
             var efcContNo = $.trim($(".searchContent div[name='efcContNo']",wraper).input('val'));
             if(efcContNo!=""){
                param['efcContNo'] = efcContNo;
             };
             var mobile = $.trim($(".searchContent div[name='mobile']",wraper).input('val'));
             if(mobile!=""){
                param['mobile'] = mobile;
             };
             var company = $.trim($(".searchContent div[name='company']",wraper).input('val'));
             if(company!=""){
                param['company'] = company;
             };
             var orderStatus = $.trim($(".searchContent div[name='orderStatus']",wraper).select('val'));
             if(orderStatus!=""){
                param['orderStatus'] = orderStatus;
             };
             var channel = $.trim($(".searchContent div[name='channel']",wraper).input('val'));
             if(channel!=""){
                param['channel'] = channel;
             };
             var paramUrl = "";
             if(param!={}){
                 paramUrl+="?"
                 $.each(param,function(k,v){paramUrl+="&"+k+"="+v;});
             }
             param['paramUrl'] = paramUrl;
             return param;
    }

    $('.ui-btn-icon:first',wraper).click(function(){
            var param = excelplus();
            var total2=$.jRadGet({url:'/shopmanage-ws/ws/0.1/insuredOrder/getTotalCharge'+param.paramUrl+'&appCode='+appCode});
            if(total2.sumEfc){
                $('.hDivBox:eq(0) th:eq(6)',wraper).html('&nbsp;&nbsp;交强险(元)<br>（合计'+total2.sumEfc+'元）');
                $('.hDivBox:eq(0) th:eq(7)',wraper).html('&nbsp;&nbsp;商业险(元)<br>（合计'+total2.sumBiz+'元）');
                $('.hDivBox:eq(0) th:eq(8)',wraper).html('&nbsp;&nbsp;车船税(元)<br>（合计'+total2.sumTax+'元）');
                $('.hDivBox:eq(0) th:eq(9)',wraper).html('&nbsp;&nbsp;返利金额(元)<br>（合计'+total2.sumReb+'元）');
            }else{
                $('.hDivBox:eq(0) th:eq(6)',wraper).html('&nbsp;&nbsp;交强险(元)');
                $('.hDivBox:eq(0) th:eq(7)',wraper).html('&nbsp;&nbsp;商业险(元)');
                $('.hDivBox:eq(0) th:eq(8)',wraper).html('&nbsp;&nbsp;车船税(元)');
                $('.hDivBox:eq(0) th:eq(9)',wraper).html('&nbsp;&nbsp;返利金额(元)');
            }
    });
    function showError(xhr){
         var errormsg = eval("(" + xhr.responseText + ")"); 
          $.jRadMessage({level:'error',message:errormsg[0].message});
    } 
    $(".numb55").click(function(){
        $('.overcurtainDiv').hide();
        var menuId = $(".tabs-selected").attr("menuId")
        var data = $.jRadGet({url:'/shopmanage-ws/ws/0.1/remark/getMenuRemark?menuId='+menuId})
        $("#Form_explain_eg55").form({}).form('close');
        $("#Form_explain_eg55").form({
            title:'页面说明',
            item:data,
            autobinding: true, 
            submit:function(){
                var postData = {};
                postData.operator = carsmart_config.operatorName;
                postData.menuName = $(".tabs-selected").attr("menuName");
                postData.menuId = $(".tabs-selected").attr("menuId");
                postData.remark = $("#Form_explain_eg55 div[name='remark']").textarea("val")
                $.jRadPost({
                    url:'/shopmanage-ws/ws/0.1/remark/updateMenuRemark',
                    data:postData,
                    success:function(){
                        $("#Form_explain_eg55").form('close')
                        $('.overcurtainDiv').hide();
                    }
                });
            }, 
            cancel:function(){
                $("#Form_explain_eg55").form('close')
                $('.overcurtainDiv').hide();
            }
        }).form('open')
        $("#Form_explain_eg55 .textarea-content").removeClass("span4").addClass("span12")
        $('.overcurtainDiv').hide();
        $('.overcurtainDiv').eq(0).show().attr("style","z-index:303;display:block");
    })
});
</script>

