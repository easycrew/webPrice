<style>
	.sheng{position:absolute;left:-140px;border: 1px solid #999;height: 30px;left: 0;line-height: 30px;padding: 0 5px;cursor: pointer;}
	.sheng .delspan{float:none;}
	/*.jspScrollable{height: 305px !important;}*/
</style>
<div class="urlContentWraper" id="Wraper_ads_manage">
	<div class="ui-info-layout">
		<div class="ui-info-layout-subbox ">
			<div class="jrad-table">
		        <h2 class="ui-tit"><strong>广告列表</strong><bottom class="all-work-info numb93">页面说明</bottom></h2>
		        <!-- 列表显示 -->
		        <table id="Table_ads_manage"></table>
		    </div>
			<div class="details-box" style="display:none;">
					<ul class="details-tab">
						<li class="tab-cur tab-cur-first f-left"><span name="title">广告信息</span></li>
						<li><span class="return"></span></li>
					</ul>
					<div class="details-content">
						<div class="details-scroll">
							<div class="details-content-inner">
								<div class="grid-layout ui-form" id="Form_ads_manage">
									<div class="jrad-form">
										<div class="grid-layout-main">
										<input name="id" type="hidden">
										<input type="hidden" name="adPicId">
										<input type="hidden" name="adPicAddress">
										<input type="hidden" name="adPicMiddleAddress">
										<input type="hidden" name="adPicSmallAddress">
										<input type="hidden" name="serviceId"/>
										<div name="brands"></div>
										<div name="regions"></div>
										<div class="row-fluid">
										 <label class="span3 grid-layout-label">标题：</label>
										 <div class="span5 grid-layout-content">
											   <div name="title" class="jrad-input-container"></div>
															</div>
										</div>
										 <div class="row-fluid">
											 <label class="span3 grid-layout-label">平台：</label>
											 <div class="span18 grid-layout-content">
												   <div name="osInfo" class="jrad-checkbox-container"></div>
																</div>
										</div>
										 <div class="row-fluid">
											 <label class="span3 grid-layout-label">广告位：</label>
											 <div class="span3 grid-layout-content">
												   <div name="location" class="jrad-select-container"></div>
											 </div>
											 <label class="span2 grid-layout-label">SDK渠道编码：</label>
											 <div class="span10 grid-layout-content">
												   <div name="sdkChannelId" class="jrad-input-container"></div>
											  </div>
										</div>
										<div class="row-fluid">
											<label class="span3 grid-layout-label"> 品牌： </label>
											<div class="span14 grid-layout-content fluid-wrap">
												<div class="jrad-buttons-container" name="brand_check_btn">
													<span id="jrad-button-brand" class="jrad-primary">
														点击选择 </span>
												</div>
												<p id="brand_check_string" style="margin: 10px 0;"></p>
											</div>
										</div>
										<div class="row-fluid">
											<label class="span3 grid-layout-label"> 地区： </label>
											<div class="span14 grid-layout-content fluid-wrap">
												<div class="jrad-buttons-container" name="area_check_btn">
													<span id="jrad-button-area" class="jrad-primary">
														点击选择 </span>
												</div>
												<div id="area_check_string" class="brand_ads" style="margin: 10px 0;"></div>
											</div>
										</div>
										<div class="row-fluid">
											<label class="span3 grid-layout-label"> 一级服务： </label>
											<div class="span18 grid-layout-content">
												 <div name="zeroService" class="jrad-select-container service"></div>
												 <p id="serviceNames"></p>
											</div>
										</div>
										<div class="row-fluid">
											<label class="span3 grid-layout-label"> 广告图： </label>
											<div class="span15 grid-layout-content fluid-wrap">
												<div name="adPicFile" class="jrad-uploadimg-container">
												</div>
											</div>
										</div>
										<div class="row-fluid">
											 <label class="span3 grid-layout-label">广告跳转：</label>
											 <div class="span3 grid-layout-content">
												   <div name="adTurnType" class="jrad-select-container"></div>
										    </div>
											 <label class="span2 grid-layout-label">对应ID：</label>
											 <div class="span10 grid-layout-content">
												   <div name="entityId" class="jrad-input-container"></div>
												   <p class="nameTips"></p>
											  </div>
											  <label class="span2 grid-layout-label" style="display:none;" id="jampLabel">url地址：</label>
											 <div class="span10 grid-layout-content" style="display:none;" id="jampurl">
												   <div name="turnToUrl" class="jrad-input-container"></div>
											  </div>
										</div>
										<div class="row-fluid">
											 <label class="span3 grid-layout-label">详情：</label>
											 <div class="span5 grid-layout-content">
												   <div name="adRemarks" class="jrad-mediaarea-container" style="margin-left:0"></div>
											 </div>
										</div>
										<div class="row-fluid">
											 <label class="span3 grid-layout-label">显示开始时间：</label>
											 <div class="span3 grid-layout-content">
												   <div name="startDate" class="jrad-dateinput-container"></div>
																</div>
											 <label class="span4 grid-layout-label">显示结束时间：</label>
											 <div class="span5 grid-layout-content">
												   <div name="endDate" class="jrad-dateinput-container"></div>
																</div>
										</div>
										<div class="row-fluid">
											 <label class="span3 grid-layout-label">状态：</label>
											 <div class="span3 grid-layout-content">
												   <div name="status" class="jrad-select-container"></div>
											 </div>
											 <label class="span4 grid-layout-label">是否置顶：</label>
											 <div class="span5 grid-layout-content">
												   <div name="top" class="jrad-select-container"></div>
											 </div>
										</div>
										</div>
									</div>
									<div class="jrad-buttons-container ui-buttons-container">
										<span class="jrad-btn-primary">确定</span>
										<span class="jrad-btn-normal">取消</span>
									</div>
								</div>
							</div>

						</div>
					</div>
		     </div>
		</div>
	</div>

	<!--服务品牌-->
	<div id="Form_service_brand" style="display:none;">
		<div class="grid-layout-main jrad-form">
			 <div class="jrad-tree" id="brandsTree">
			 </div>
			 <div class="jrad-checkbox-container" name="vendor" style="position:absolute;bottom:25px;font-weight:bold;"></div>
		</div>
		<div class="jrad-buttons-container ui-buttons-container">
			<span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span>
		</div>
	</div>

	<!-- 地区选择-->
	<div id="Form_area" style="display:none;">
		<div class="grid-layout-main jrad-form">
			  <div class="row-fluid">
				<label class="span3 grid-layout-label"> 省：</label>
				<div class="span5 grid-layout-content">
					<div class="jrad-select-container" name="provinceId">
					</div>
				</div>
				<label class="span3 grid-layout-label">	市：</label>
				<div class="span5 grid-layout-content">
					<div class="jrad-select-container" name="areaCodeId">
					</div>
				</div>
			</div>
		</div>
		<div class="jrad-buttons-container ui-buttons-container">
			<span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span>
		</div>
	</div>

	<div id="Form_explain_eg93" style="display:none;">
	    <div class="grid-layout-main jrad-form">
	        <div class="row">
	            <label class="span3 grid-layout-label">业务说明：</label>
	            <div class="span12 grid-layout-content">
	                <div><strong>功能简介：</strong>APP一些页面，广告位的管理功能。</div>
	                <div><strong>重要功能说明：</strong>①创建：标题：广告名字，标示下就可以，APP不会显示出来；
	                  平台：勾选对应的系统后，才会在该系统展示；
	                  广告位：广告展示的位置；
	                  品牌：就是可以看到的车系；
	                  地区：可以看到此广告的城市；
	                  一级服务：暂未使用此字段；
	                  广告图：对应广告位置展示的图片（注意尺寸一定要对）；
	                  广告跳转：设置点击广告跳转的页面，广告详情为跳转到下面设置的页面，商家详情为跳转到对应的商家详情页面，资讯详情为跳转到设置对应的资讯页面，指定url为跳转到设置的网址页面，积分商城商品为跳转到对应的积分商城商品页面；
	                  详情：广告详情就会跳转到这里设置的富文本编辑框；
	                  显示开始/结束时间：即广告在APP显示的时间；
	                  状态：有效的广告才会显示。</div>
	                <div><strong>注意事项：</strong>无。</div>
	            </div>
	        </div>
	        <div class="row">
	            <label class="span3 grid-layout-label">备注：</label>
	            <div class="span12 grid-layout-content">
	                <div class="jrad-textarea-container" name="remark">
	                </div>
	            </div>
	        </div>
	    </div>
	    <div class="jrad-buttons-container ui-buttons-container">
	        <span class="jrad-btn-primary">确定</span>
	        <span class="jrad-btn-normal">取消</span>
	    </div>
	</div>

</div>
<script type="text/javascript">
$(document).ready(function(){
    var wraper = $('#Wraper_ads_manage');
    var page_column_model = new Array();
    var page_search_items = new Array();
    var page_list_buttons = new Array();

	var entityModel = {};
    var jRad = $.jRad({app:'radsample-ws',entityModel:entityModel});
    jRad.validators['title'] = [{"msg":"标题不能为空","type":"min","value":"1"}];
	jRad.validators['osInfo'] = [{"msg":"平台不能为空","type":"min","value":"1"}];
	jRad.validators['location'] = [{"msg":"广告位不能为空","type":"min","value":"1"}];
	jRad.validators['startDate'] = [{"msg":"广告显示开始时间不能为空","type":"min","value":"1"}];
	jRad.validators['endDate'] = [{"msg":"广告显示结束时间不能为空","type":"min","value":"1"}];
	jRad.params['provinceCodeSearch'] = {
		urlData:{
			url:'/shopmanage-ws/ws/0.1/userInfoCms/provinceAll'
		},
		unshiftData: {id:'',name:'请选择'},
		onchange: function(){
			var provinceCode = $('.searchContent div[name=provinceId]',wraper).select('val');
			if(provinceCode==''){
				$('.searchContent div[name=areaCodeId]',wraper).select({
																urlData:{url:''},
																data:[{id:'',name:'请选择'}],
																val:''});
			}else{
			$('.searchContent div[name=areaCodeId]',wraper).select({
				urlData:{
					url: '/shopmanage-ws/ws/0.1/userInfoCms/municipalities?provinceId=' + provinceCode
				},
				unshiftData: {id:'',name:'请选择'}
			}).select('val','');
			}
		}
	};
	jRad.params['areaCodeSearchId'] = {
		data: [{id:'',name:'请选择'}]
	};
	jRad.params['status'] = {
		data: [{id:'',name:'全部'},{id:'1',name:'有效'},{id:'0',name:'无效'}]
	};
	jRad.params['top'] = {
		data: [{id:'',name:'全部'},{id:'1',name:'是'},{id:'0',name:'否'}]
	};

	jRad.params['brandIdSearch'] = {
		urlData:{
			url:'/shopmanage-ws/ws/0.1/modelCms/brand/list',
			id: 'brandId',
			name: 'brandName'
		},
		unshiftData: {id:'',name:'请选择'},
		onchange: function(){
			var brandId = $('.searchContent div[name=brandId]',wraper).select('val');
			if(brandId==''){
				$('.searchContent div[name=factoryId]',wraper).select({
																urlData:{url:''},
																data:[{id:'',name:'请选择'}],
																val:''});
			}else{
			$('.searchContent div[name=factoryId]',wraper).select({
				urlData:{
					url: '/shopmanage-ws/ws/0.1/modelCms/factory/list?brandId=' + brandId,
					id: 'factoryId',
					name: 'factoryName'
				},
				unshiftData: {id:'',name:'请选择'}
			}).select('val','');
			$('.searchContent div[name=modelId]').select({
					urlData:{url:''},
					data:[{id:'',name:'请选择'}],
					val: ''});
			}
		}
	};
	jRad.params['factoryIdSearch'] = {
		data: [{id:'',name:'请选择'}],
		onchange: function(){
			var factoryId = $('.searchContent div[name=factoryId]').select('val');
			if(factoryId==''){
				$('.searchContent div[name=modelId]').select({data:[{id:'',name:'请选择'}]});
			}else{
				$('.searchContent div[name=modelId]').select({
					urlData:{
						url: '/shopmanage-ws/ws/0.1/modelCms/model/list?factoryId=' + factoryId,
						id: 'modelId',
					    name: 'modelName'
					},
					unshiftData: {id:'',name:'请选择'},
					val:""
				});
			}
		}
	};
	jRad.params['modelIdSearch'] = {
		data: [{id:'',name:'请选择'}]
	};

	var fields_params = {};

	fields_params['title'] = {grid: 9};
	fields_params['osInfo'] ={data:[
		{"id":"1",name:"IOS"},
		{"id":"2",name:"IOS越狱版"},
		{"id":"3",name:"Android"},
		{"id":"4",name:"Windows phone"}
	]};
	var str = 'market_ad_type';
	var convert = [];
	var convertPlus = [];
	var _result = $.jRadGet({url: '/shopmanage-ws/ws/0.1/datadictionary/dictionarylist?type='+str});
	$.each(_result,function(index, vo){
	    var __id = vo['id'];
	    var __name = vo['name'];
	    var __tm = {'id':__id,'name': __name};
	    convert.push(__tm);
	    convertPlus.push(__tm)
	});
	convertPlus.unshift({id:'',name:'全部'})

	fields_params['location'] = {
		data:convert,
		onchange:function(){
			var val = $("#Form_ads_manage div[name='location']",wraper).select('val');
			if(val=='19'){
				$("#Form_ads_manage div[name='location']",wraper).parent().next().show();
				$("#Form_ads_manage div[name='location']",wraper).parent().next().next().show();
			}else{
				$("#Form_ads_manage div[name='location']",wraper).parent().next().hide();
				$("#Form_ads_manage div[name='location']",wraper).parent().next().next().hide();
			}
		}
	}

	fields_params['status'] ={ data:[
		{"id":"1",name:"有效"},
		{"id":"0",name:"无效"}
	]};
	fields_params['top'] ={ data:[
		{"id":"0",name:"否"},
		{"id":"1",name:"是"}
	]};

	fields_params['adTurnType'] ={
		data:[
		{"id":"0",name:"广告详情"},
		{"id":"1",name:"商家详情"},
		{"id":"2",name:"资讯详情"},
		{"id":"3",name:"指定url"},
		{"id":"4",name:"积分商城商品"}
		],
		onchange: function(){
			var val = $("#Form_ads_manage div[name='adTurnType']",wraper).select('val');
			if(val=='0'){
				$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().hide();
				$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next().hide();
				$("#Form_ads_manage",wraper).find('#jampLabel').hide();
				$("#Form_ads_manage",wraper).find('#jampurl').hide();
			}else{
				if(val=='1'||val=='2'||val=='4'){
					$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().show();
					$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next().show();
					var _input = $("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next()
					.find("input[name='entityId']");
					var _nameTips = $("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next()
					.children(".nameTips");
					_input.val("");
					_nameTips.html("");
					$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next()
					.children(".ui-field-error").hide();
					$("#Form_ads_manage",wraper).find('#jampLabel').hide();
					$("#Form_ads_manage",wraper).find('#jampurl').hide();
				}
				if(val=='3'){
					$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().hide();
					$("#Form_ads_manage div[name='adTurnType']",wraper).parent().next().next().hide();
					$("#Form_ads_manage",wraper).find('#jampLabel').show();
					$("#Form_ads_manage",wraper).find('#jampurl').show();
					$("#Form_ads_manage #jampurl",wraper).find('.ui-input-content').removeClass('span4').addClass('span8');
				}
			}
		}
	};

	fields_params['zeroService'] ={
		data:[
			{"id":"",name:"请选择"},{id:'1',name:'洗车'},{id:'2',name:'美容'},{id:'3',name:'保养'},{id:'4',name:'维修'}
		],
		onchange:function(val){
			$("#serviceNames",wraper).html("");
			getServiceSonNode(2,val,wraper);
		}
	};

	var _form = $("#Form_ads_manage",wraper);
	fields_params['adPicFile'] = {
		url:'/shopmanage-ws/ws/0.1/file/uploadThree',
		delFunc: function(item){
		   item.list.remove();
		   $("input[name='adPicAddress']",_form).val("");
		   $("input[name='adPicMiddleAddress']",_form).val("");
		   $("input[name='adPicSmallAddress']",_form).val("");
		},
		fileName:"file",
		note: '仅支持 JPG图片文件。',
		show: false,
		params: {type:""},
		success: function(data){
		   if(data[0]&&data[0].code=="400"){
		     $.jRadMessage({level:'error',message:data[0].message});
		   }else{
		   $("input[name='adPicAddress']",_form).val(data.fileUrl);
		   $("input[name='adPicMiddleAddress']",_form).val(data.middleUrl);
		   $("input[name='adPicSmallAddress']",_form).val(data.smallUrl);
		   }
		},
	   beforeSubmit: function(obj){
		  var re = /^.*\.(jpg|JPG)$/;
		  if(re.test(obj.val())){
			return true;
		  }else{
			$.jRadAlert("只能上传jpg文件", "error");
			$("div[name='adPicFile']",_form).find("input[type='file']").val('');
			return false;
		  }
		},
		single: true,
		showInfo:false,
		prev:'smallUrl'
	};
	fields_params['adRemarks'] = {
		theme:"Full",
		resizing: false,
		grid: 18,
		height: 200 ,
		uploadImg: { //上传图片参数
		url: '/shopmanage-ws/ws/0.1/file/uploadThree',
		filename: 'file',
		delFunc: function(item) {
			item.list.remove();
		},
		validator : [{
			msg : "只能上传jpg文件",
			type : "regex",
			value : /^.*\.(jpg|JPG)$/
		}],
		success: function(data){
			   if(data[0]&&data[0].code=="400"){
				 $.jRadMessage({level:'error',message:data[0].message});
			   }
			},
		note: '仅支持 JPG图片文件。',
		show:true,
		showLarge:true,
		prev:'fileUrl',
		params: {type:""},
			single: true
		},
		CKOpt:{
			fullPage:true,//是否使用完整的html编辑模式
			basicEntities:false, //Whether to escape basic HTML entities in the document, including:  nbsp gt lt amp
			startupMode:'source' //载入时，以何种方式编辑 源码和所见即所得 "source"和"wysiwyg"
		}
	};
	fields_params['startDate'] = {
		grid:4,
    	dateFmt:'yyyy-MM-dd HH:mm:ss',
	};
	fields_params['endDate'] = {
		grid:4,
    	dateFmt:'yyyy-MM-dd HH:mm:ss',
	};
	page_column_model.push({display: 'ID', name : 'id',width:50});
    page_column_model.push({display: '标题', name : 'title'});
    page_column_model.push({display: '广告位', name : 'locationName'});
	page_column_model.push({display: '广告图', name : 'adPicSmallAddress',width:80,diy:function($row,$div){
		var imgUrl = $row.adPicSmallAddress;
		if(imgUrl!=undefined&&imgUrl!=""){
			var $img = $('<img width="50" height="50" src="'+imgUrl+'" />');
			$div.height(50);
			$div.append($img);
		}
	}});
    page_column_model.push({display: '创建时间', name : 'createDate',sortable : true});
    page_column_model.push({display: '显示开始时间', name : 'startDate',sortable : true});
    page_column_model.push({display: '显示结束时间', name : 'endDate',sortable : true});
    page_column_model.push({display: '地区', name : 'regionName',width:200});
	page_column_model.push({display: '状态', name : 'statusName'});
	page_column_model.push({display: '置顶', name : 'topName'});
    page_column_model.push({display: '车系', name : 'mName'});
    page_column_model.push({display: '绑定车系', name : 'modelName'});
    page_column_model.push({display: 'url', name : 'entityUrl'});
    page_column_model.push({display: '最后操作时间', name : 'updateDate'});
    page_column_model.push({display: '最后操作人', name : 'operator'});

	page_search_items.push({row:'1',type:'jrad-input',display:'广告ID',name:'id'});
	page_search_items.push({row:'1',type:'jrad-input',display:'标题',name:'title'});
	page_search_items.push({row:'1',type:'jrad-checkbox',display:'平台',name:'osInfo',params:{
	  data:[
	    {"id":"1",name:"IOS"},
	    {"id":"2",name:"IOS越狱版"},
		{"id":"3",name:"Android"},
		{"id":"4",name:"Windows phone"}
	  ]
	}});
	page_search_items.push({row:'2',type:'jrad-select',display:'广告位',name:'location',params:{
	  	data:convertPlus
	}});
	page_search_items.push({row:'2',type:'jrad-select',display:'省',name:'provinceId',params:jRad.params['provinceCodeSearch']});
	page_search_items.push({row:'2',type:'jrad-select',display:'市',name:'areaCodeId',params:jRad.params['areaCodeSearchId']});
	page_search_items.push({row:'3',type:'jrad-select',display:'品牌',name:'brandId',params:jRad.params['brandIdSearch']});
	page_search_items.push({row:'3',type:'jrad-select',display:'车厂',name:'factoryId',params:jRad.params['factoryIdSearch']});
	page_search_items.push({row:'3',type:'jrad-select',display:'车系',name:'modelId',params:jRad.params['modelIdSearch']});
	page_search_items.push({row:'4',type:'jrad-select',display:'补位广告',name:'isCovering',params:{
	  	data:[
	    	{"id":"",name:"全部"},
	    	{"id":"1",name:"是"},
			{"id":"0",name:"否"}
	  	]
	}});
	page_search_items.push({row:'4',type:'jrad-dateinput',display:'广告日期',name:'showDate',params:{
		grid:4,
    	dateFmt:'yyyy-MM-dd HH:mm:ss',
	}});
	page_search_items.push({row:'4',type:'jrad-select',display:'状态',name:'status',params:jRad.params['status']});
	page_search_items.push({row:'5',type:'jrad-select',display:'是否置顶',name:'top',params:jRad.params['top']});

    $('#Form_ads_manage .jrad-btn-normal',wraper).button({
		click: function(){
			$('.details-box',wraper).slideUp();
			$('.jrad-table',wraper).slideDown();
			$(".scroll-up-btn").click();
		}
	});
	$('#Form_ads_manage .jrad-btn-primary',wraper).button({
		click: function(){
			var flag = $('#Form_ads_manage',wraper).form('validateAll');
			var json = $('#Form_ads_manage',wraper).form('getValue');
			var adRemarks = json.adRemarks;
			var adTurnType = json.adTurnType;
			var entityId = json.entityId;
			var remarkFlag = true;
			if(adTurnType=="0"){
			   	if($.trim(adRemarks).length==0){
					$.jRadMessage({level:'error',message:"请填写广告详情。"});
					remarkFlag = false;
			   	}
			}else{
			 	if(entityId.length==0&&(adTurnType=="1"||adTurnType=="2")){
					$.jRadMessage({level:'error',message:"请填写广告跳转对应ID。"});
					remarkFlag = false;
			   	}
			}
			if(!flag) {
			   	return;
			}
			if(!remarkFlag){
			   	return;
			}
			json.osInfo = json.osInfo.join(",");
			json.location = json.location;

			json.regions = [];

			var regions = $("div[name='regions']",wraper).data("areaList");
			if(regions.length==0){
			 	$.jRadMessage({level:'error',message:"请选择要绑定的地域。"});
			 	return;
			}else{
				$.each(regions,function(){
				  	var region = {};
				  	region.provinceId = this.provinceId+"";
				  	var areaCodeId = [];
				  	var areaList = this.areaList;
				  	for(var i=0;i<areaList.length;i++){
				  		areaCodeId.push(areaList[i].areaCodeId);
				  	}
				  	region.areaCodeId = areaCodeId.join(",");
				  	json.regions.push(region);
				});
			}

			if($(".over .areaSpan").length > 0){
				$(".over .areaSpan").each(function(i){
					var region = {}
					region.provinceId = $(this).parent().attr("provinceid");
					region.areaCodeId = $(this).attr("id")
					json.regions.push(region);
				})
				json.regions.shift()
			}

			json.brandIds = [];
			var brandIds = $("div[name='brands']",wraper).data("brandIds");
			if(brandIds!=undefined){
				json.brandIds = brandIds;
			}
			if(json.brandIds.length==0){
				$.jRadMessage({level:'error',message:"请选择要绑定的车系。"});
			    return;
			}
			if($("#serviceNames",wraper).html()==""){
				json.serviceId = $('#Form_ads_manage div.service:last').select('val');
			}
			json.operator = carsmart_config.operatorName;
			delete json.adPicFile;
			delete json.zeroService;
			delete json.secondService;

			if($(".details-box .details-tab",wraper).find("span[name='title']").html()=="广告添加"){
				$.jRadPost({
			    	url:'/shopmanage-ws/ws/0.1/marketAdInfoCms/addMarketAdInfo',
			    	data:json,
			    	success:function(){
			    		$('.details-box',wraper).slideUp();
						$('.jrad-table',wraper).slideDown();
						$(".scroll-up-btn").click();
						$('#Table_ads_manage').flexMessage('创建成功', 'success');
						$('#Table_ads_manage').flexReload();
			    	},error:function(data){
			    		var mes = eval('('+data.responseText+')');
			    		 if(mes[0].message.indexOf('<html>')>0){
			    			$.jRadMessage({
			    			 level:'error',
		    				 message:'<html>广告详情源码须以<xmp style="display:inline-block;"><html>或<!DOCTYPE html>开头，以</html></xmp>结尾</html>'
			    		 })
			    		}else{
			    			$.jRadMessage({
				    			 level:'error',
			    				 message:mes[0].message
				    		 })
			    		}
			    	}
			    });
		 	}else{
				$.jRadPost({
			    	url:'/shopmanage-ws/ws/0.1/marketAdInfoCms/editMarketAdInfo',
			    	data:json,
			    	success:function(){
			    		$('.details-box',wraper).slideUp();
						$('.jrad-table',wraper).slideDown();
						$(".scroll-up-btn").click();
						$('#Table_ads_manage').flexMessage('修改成功', 'success');
						$('#Table_ads_manage').flexReload();
			    	},error:function(data){
			    		var mes = eval('('+data.responseText+')');
			    		if(mes[0].message.indexOf('<html>')>0){
			    			$.jRadMessage({
			    			 level:'error',
		    				 message:'<html>广告详情源码须以<xmp style="display:inline-block;"><html>或<!DOCTYPE html>开头，以</html></xmp>结尾</html>'
			    		 })
			    		}else{
			    			$.jRadMessage({
				    			 level:'error',
			    				 message:mes[0].message
				    		 })
			    		}
			    	}
			    });
		 	}
		}
	});

	$('#Form_ads_manage',wraper).form({
		validators: jRad.validators,
		fields_params:fields_params,
		layout: 'grid',
		autobinding: false
	 });

	var readonlyFields2 = {};
	readonlyFields2['users'] = false;
	page_list_buttons.push({title: '创建',name:'Add', bclass: 'add',
		onpress : function(){
			 initAdsInfo(wraper);
			 $('#Form_ads_manage',wraper).form({item:{'adTurnType':'0'}});
			 $(".details-box .details-tab",wraper).find("span[name='title']").html("广告添加");
			 $('.jrad-table',wraper).slideUp();
			 $('.details-box',wraper).slideDown();
			 $(".scroll-up-btn").click();
        }
    });

	var readonlyFields = {};
	readonlyFields['users'] = true;
	page_list_buttons.push({title: '修改',name:'Edit', bclass: 'edit',
		prefunc:function(){
            var checked = $('#Table_ads_manage').getCheckedTrs();
            if (checked.length != 1) {return false;}else{return true;}
        },onpress : function(){
            var checked = $('#Table_ads_manage').getCheckedTrs();
            if(checked[0]) {
			     var id = checked[0].id;
                 updateAdsView(id,wraper);
            }
        }
    });

	page_list_buttons.push({name:'delete',bclass: 'delete',
		prefunc:function(){
            var checked = $('#Table_ads_manage').getCheckedTrs();
            if (checked.length != 1) {return false;}else{return true;}
        },onpress : function(){
	    	var checked = $('#Table_ads_manage').getCheckedTrs();
			$.jRadConfirm('确认删除吗？',1,function(){
				var id =  checked[0].id;
				$.jRadAjax({
				    type:'post',
					url:'/shopmanage-ws/ws/0.1/marketAdInfoCms/deleteMarketAdInfo?id='+id,
					success: function(){
						$('#Table_ads_manage').flexMessage('删除成功!', 'success');
           	    		$('#Table_ads_manage').flexReload();
					},
					error:function(xhr){
					    var errormsg = eval("(" + xhr.responseText + ")");
						if (errormsg != undefined) {
							$('#Table_ads_manage').flexMessage(errormsg[0].message, 'error');
						}
					}
				});
			});
		}
	});

	page_list_buttons.push({displayname: '设为无效',name:'unUse',bclass: 'unUse',
		prefunc:function(){
            var checked = $('#Table_ads_manage').getCheckedTrs();
            if (checked.length == 0) {return false;}else{return true;}
        },onpress : function(){
	    	var checked = $('#Table_ads_manage').getCheckedTrs();
			$.jRadConfirm('确认设置为无效吗？',1,function(){
				var idArr = [];
				$.each(checked,function(){
					idArr.push(this.id);
				});
				idArr.join(",");
				$.jRadAjax({
				    type:'post',
					url:'/shopmanage-ws/ws/0.1/marketAdInfoCms/setMarketAdInfosStatus?idString='+idArr+"&status=0" ,
					success: function(){
						$('#Table_ads_manage').flexMessage('操作成功!', 'success');
           	    		$('#Table_ads_manage').flexReload();
					},
					error:function(xhr){
					    var errormsg = eval("(" + xhr.responseText + ")");
						if (errormsg != undefined) {
							$('#Table_ads_manage').flexMessage(errormsg[0].message, 'error');
						}
					}
				});
			});
		}
	});

    page_list_buttons.push({separator: true});

	$('#Table_ads_manage').flexigrid({
			reload:true,
			method:'get',
			colModel : page_column_model,
			buttons : page_list_buttons,
			searchitems :page_search_items,
			pagination: {
				diaplay_pages: 5,
				align: 'bottom'
			},
			showSearch:true,
			url:'/shopmanage-ws/ws/0.1/marketAdInfoCms/queryMarketAdInfo',
			onError:showAdsError,
			overflow:true
	});
	var $espan = $("<span>").addClass("ui-btn-icon");
	var $cspan = $("<span>").addClass("ui-btn-icon-content");
	var $span = $("<span>").html("显示大于等于3的车系广告(需选城市)").css({
	  	"display":"inline-block",
	  	"height":"16px",
	  	"vertical-align":"middle"
	});
	$(".searchButtons",wraper).append($espan.append($cspan.append($span)));
	var _span7=$('div.searchButtons',wraper).parent().removeClass('span14').addClass('span21');
    var _div=$('<div>').addClass('row-fluid').append(_span7);
    $('div.searchContent',wraper).append(_div);
	$espan.click(function(){
		if($('.searchContent div[name=areaCodeId]',wraper).select('val')==''){
		    $('#Table_ads_manage').flexMessage('必须选择城市才可以查。','warning');
		}
		else{
			$('#Table_ads_manage').flexOptions({url: '/shopmanage-ws/ws/0.1/marketAdInfoCms/queryMarketAdInfoByCity'});
			$('#Table_ads_manage').flexReloadSearch();
		}
	});
	$(".searchButtons .ui-btn-icon:first",wraper).unbind('click');
	$(".searchButtons .ui-btn-icon:first",wraper).click(function(){
		 $('#Table_ads_manage',wraper).flexOptions({url: '/shopmanage-ws/ws/0.1/marketAdInfoCms/queryMarketAdInfo'});
		 $('#Table_ads_manage',wraper).flexReloadSearch();
	});
	$(".searchButtons .ui-btn-icon:nth-child(2)",wraper).unbind('click');
	$(".searchButtons .ui-btn-icon:nth-child(2)",wraper).click(function(){
		var sDiv = $(".searchContent",wraper);
		$('.jrad-select',sDiv).select('val', '');
		$('.jrad-autocomplete',sDiv).autocomplete('val', '');
		$('.jrad-input',sDiv).input('val', '');
		$('.jrad-dateinput',sDiv).dateinput('val', '');
		$('.jrad-autocombo',sDiv).autocombo('val', '');
		$('.jrad-checkbox',sDiv).checkbox('val', '');
		$('#Table_ads_manage').flexOptions({
			url: '/shopmanage-ws/ws/0.1/marketAdInfoCms/queryMarketAdInfo',
			queryParam:{},
			page:0});
		$('#Table_ads_manage').flexReloadSearch();
	});

	$(".details-tab .return",wraper).click(function(){
		$('.details-box',wraper).slideUp();
		$('.jrad-table',wraper).slideDown();
		$(".scroll-up-btn").click();
	});

	//服务品牌
	$('#Form_service_brand',wraper).form({
		title: '绑定车系选择',
		item: {},
		fields_params:{'vendor':{data: [{id:'全部',name:'全部'}]}},
		height: 500,
		submit:function(){
			var vendor = $('#Form_service_brand div[name="vendor"]',wraper).checkbox('val');
			if(vendor.length==0||vendor[0]==""){
		 		var treeObj = getZtreeObj(wraper);
		 		var filter = function(node){
					return (node.level == 1 && node.checked==true);
		 		}
		 		var nodes = treeObj.getNodesByFilter(filter);
		 		var arr = [];
		 		var modelNameList = [];
			 	$.each(nodes,function(){
			   		var json = {};
					json.brandId = this.id;
			   		json.modelId = [];
			   		var modelFilter = function(node){
						return (node.brandId ==json.brandId && node.level == 3 && node.checked==true);
			   		}
					var modelNodes = treeObj.getNodesByFilter(modelFilter);
					$.each(modelNodes,function(i){
					  	json.modelId.push(modelNodes[i].id);
					  	modelNameList.push(modelNodes[i].name);
					});
					json.modelId = json.modelId.join(",");
					arr.push(json);
			 	});
			  	$("#Form_ads_manage",wraper).find("div[name='brand_check_btn']").next("#brand_check_string").html("已选择："+modelNameList.join(" , "));
			  	$("div[name='brands']",wraper).data("brandIds",arr);
			}else{
			 	$("#Form_ads_manage",wraper).find("div[name='brand_check_btn']").next("#brand_check_string").html("已选择：全部");
			  	$("div[name='brands']",wraper).data("brandIds",[{"brandId":"0", "modelId":""}]);
			}
			$("#Form_service_brand",wraper).form('close');
		}
	});

	$("#jrad-button-brand",wraper).button({
		click : function() {
			var brandIds = $("div[name='brands']",wraper).data("brandIds");
			var data = {}
			if(brandIds.length==1&&brandIds[0].brandId=="0"){
			 	data = {"vendor":"全部"};
			}else{
				var treeObj = getZtreeObj(wraper);
				$.each(brandIds,function(i,json){
					var modelIds = json.modelId.split(",");
					$.each(modelIds,function(i){
						var modelId = modelIds[i];
						var modelFilter = function(node){
							return (node.brandId ==json.brandId && node.level == 3 && node.id == modelId);
						}
						var modelNode = treeObj.getNodesByFilter(modelFilter,true);
						treeObj.checkNode(modelNode, true, true);
					});
				});
			}
			$('#Form_service_brand',wraper).form({
				item:data
			}).form('open');
		}
	});

	//地区选择
    var area_fields_params = {};
	area_fields_params['provinceId'] = {
		urlData:{
			url:'/shopmanage-ws/ws/0.1/userInfoCms/provinceAll'
		},
		unshiftData: {id:'0',name:'全部'},
		onchange: function(){
			var provinceCode = $('#Form_area div[name=provinceId]',wraper).select('val');
			if(provinceCode=='0'){
				$('#Form_area div[name=areaCodeId]',wraper).select({data:[{id:'0',name:'全部'}]});
			}else{
				$('#Form_area div[name=areaCodeId]',wraper).select("val","0");
				$('#Form_area div[name=areaCodeId]',wraper).select({
					urlData:{
						url: '/shopmanage-ws/ws/0.1/userInfoCms/municipalities?provinceId=' + provinceCode
					},
					unshiftData: {id:'0',name:'全部'}
				});
			}
		}
	}
	area_fields_params['areaCodeId'] = {
		data: [{id:'0',name:'全部'}]
	};

	$('#Form_area',wraper).form({
        title:"地区",
		fields_params:area_fields_params,
		item:{"provinceId":"0","areaCodeId":"0"},
		submit:function(){
			var json = {};
			json.provinceId = $("#Form_area div[name='provinceId']",wraper).select('val');
			json.provinceName = $("#Form_area div[name='provinceId']",wraper).select('text');
			json.areaList = [];
			json.areaList[0] = {};
			json.areaList[0].areaCodeId = $("#Form_area div[name='areaCodeId']",wraper).select('val');
			json.areaList[0].areaCodeName = $("#Form_area div[name='areaCodeId']",wraper).select('text');
			var array = $("div[name='regions']",wraper).data("areaList");
			var pId = json.provinceId;
			var aId = json.areaList[0].areaCodeId;
			if(pId=="0"){
				array = [];
				array.push(json);
			}else{
			    if(array.length==1&&array[0].provinceId=="0"){
					array = [];
					array.push(json);
				}else{
					var flag = true;
					$.each(array,function(){
						if(this.provinceId == pId){
						  	flag = false;
						  	var areaList = this.areaList;
						  	if(aId=="0"){
								this.areaList = json.areaList;
						  	}else{
								var areaflag = true;
								for(var i=0;i<areaList.length;i++){
									if(areaList[i].areaCodeId==0){
										areaflag = false;
										this.areaList = json.areaList;
										break;
									}
									if(areaList[i].areaCodeId==aId){
										areaflag = false;
										$.jRadMessage({level:'error',message:"该地区已经选择",selector:$("#Form_area",wraper)});
										return;
									}
								}
								if(areaflag){
									this.areaList.push(json.areaList[0]);
								}
							}
						}
					});
					if(flag){
					  array.push(json);
					}
				}
			}
			addAreaList(array,wraper);

			var _allSpan_ads = $('<span class="ycbOpen_ads" style="margin:6px 10px;display:inline-block;cursor:pointer;">展开全部城市(用于地区返选)</span>')

			if($(".areaSpan").html().substring(0,2) == "全部"){
				$(".brand_ads").append(_allSpan_ads)
			}

			$(".ycbOpen_ads").click(function(){
				$(".brand_ads div").eq(0).hide();
				$(".ycbOpen_ads").hide();
				var arrproid = [];
				var arrarea = [];
				var postdata = $.jRadGet({url:'/shopmanage-ws/ws/0.1/userInfoCms/provinceAll'})
				$.each(postdata,function(i){
					var item = postdata[i];
					arrproid.push(item.id);
					arrarea.push(item.name);
				})
				$.each(arrproid,function(i){
					var areaArr = $.jRadGet({url:'/shopmanage-ws/ws/0.1/userInfoCms/municipalities?provinceId='+arrproid[i]})
					var areaid = [];
					var _da1 = $("<div style='overflow:hidden;position:relative;padding-left:140px;' class='over' areaName='"+arrarea[i]+"' provinceId='"+arrproid[i]+"'><div class='sheng'>"+arrarea[i]+"<span class='delspan delArea3' style='float:none;'>X</span></div></div>");
					//var proArea = $('<div class="sheng"></div>')
					$.each(areaArr,function(k){
						var item = areaArr[k];
						var _ycbdiv = $('<div id="'+item.id+'" name="'+item.name+'" class="areaSpan">'+item.name+'<span class="delspan delArea2" title="移除">X</span></div>')
						$(".brand_ads").append(_da1.append(_ycbdiv))
					})
				})
				$(".delArea2").click(function(){
					$(this).parent('.areaSpan').remove();
				})
				$(".delArea3").click(function(){
					console.log("123")
					$(this).parent().parent().remove();
				})
			})
			$("div[name='regions']",wraper).data("areaList",array);
			// $("#Form_area div[name='areaCodeId']",wraper).select('destroy');
			$("#Form_area",wraper).form("close");
		}
	});

	$("#jrad-button-area",wraper).button({
		click : function() {
			$('#Form_area',wraper).form({
				fields_params:area_fields_params,
				item:{"provinceId":"0","areaCodeId":"0"},
			}).form('open');
		}
	});

	//$("#area_check_string .delArea2",wraper).live('click',function(){
		//alert("213")
		// var info = $(this).data('info');
		// var arr = $("div[name='regions']",wraper).data("areaList");
		// $.each(arr,function(i){
		// 	var json = this;
		// 	if(json.provinceId==info.provinceId){
		// 		if(info.areaId=="0"){
		// 			arr.splice(i,1);
		// 		}else if(json.areaList.length==1){
		// 			arr.splice(i,1);
		// 		}else{
		// 			$.each(json.areaList,function(j){
		// 				var area = this;
		// 				if(area.areaCodeId==info.areaId){
		// 					json.areaList.splice(j,1);
		// 				}
		// 			});
		// 		}
		// 	}
		// });
		//$(this).parent('.areaSpan').remove();
	//});

	//删除地区
	$("#area_check_string .delArea",wraper).live('click',function(){
		var info = $(this).data('info');
		var arr = $("div[name='regions']",wraper).data("areaList");
		$.each(arr,function(i){
			var json = this;
			if(json.provinceId==info.provinceId){
				if(info.areaId=="0"){
					arr.splice(i,1);
				}else if(json.areaList.length==1){
					arr.splice(i,1);
				}else{
					$.each(json.areaList,function(j){
						var area = this;
						if(area.areaCodeId==info.areaId){
							json.areaList.splice(j,1);
						}
					});
				}
			}
		});
		$(this).parent('.areaSpan').remove();
	});

	function getServiceSonNode(node,val,wraper){
		var label = "";
		var serviceClass = "";
		if(node==2){
			label = "二级服务";
			serviceClass = "secondService";
			$("#Form_ads_manage .addService").parents(".row-fluid").remove();
		}
		if(val!=""){
			var item = $.jRadGetDataSources("/shopmanage-ws/ws/0.1/service/getSonServices?parentId="+val,"id","serviceName");
			if(item.length>0){
				item.unshift({id:'',name:'请选择'});
				var row = '<div class="row-fluid">'
							+'<label class="span3 grid-layout-label">'+label+'：</label>'
							+'<div class="span18 grid-layout-content">'
							+'<div name="'+serviceClass+'" class="jrad-select-container service addService"></div>'
							+'</div>'
							+'</div>'
				$("#Form_ads_manage div[name='zeroService']",wraper).parents(".row-fluid").after(row);
				$('#Form_ads_manage div[name='+serviceClass+']').select({
					data:item,
					unshiftData: {id:'',name:'请选择'}
				});
			}
		}
	}

    $(".numb93").click(function(){
        $('.overcurtainDiv').hide();
        var menuId = $(".tabs-selected").attr("menuId")
        var data = $.jRadGet({url:'/shopmanage-ws/ws/0.1/remark/getMenuRemark?menuId='+menuId})
        $("#Form_explain_eg93").form({}).form('close');
        $("#Form_explain_eg93").form({
            title:'页面说明',
            item:data,
            autobinding: true,
            submit:function(){
                var postData = {};
                postData.operator = carsmart_config.operatorName;
                postData.menuName = $(".tabs-selected").attr("menuName");
                postData.menuId = $(".tabs-selected").attr("menuId");
                postData.remark = $("#Form_explain_eg93 div[name='remark']").textarea("val")
                $.jRadPost({
                    url:'/shopmanage-ws/ws/0.1/remark/updateMenuRemark',
                    data:postData,
                    success:function(){
                        $("#Form_explain_eg93").form('close')
                        $('.overcurtainDiv').hide();
                    }
                });
            },
            cancel:function(){
                $("#Form_explain_eg93").form('close')
                $('.overcurtainDiv').hide();
            }
        }).form('open')
        $("#Form_explain_eg93 .textarea-content").removeClass("span4").addClass("span12")
        $('.overcurtainDiv').hide();
        $('.overcurtainDiv').eq(0).show().attr("style","z-index:303;display:block");
    })
    // $(".droplist").click(function(){
    // 	$(this).find("jspScrollable").att("style","height:305px;")
    // })
	//(".droplist .jspScrollable").attr("style","height:305px;")
});

function showMessageError(xhr){
 	var errormsg = eval("(" + xhr.responseText + ")");
  	var cDiv = $("#Wraper_ads_manage .cDiv");
  	$.jRadMessage({level:'error',message:errormsg[0].message,selector:cDiv});
}

function initAdsInfo(wraper){
	   //广告图
	   var _ul = $("div[name='adPicFile']",wraper).children(".pic-show");
	   _ul.html("");
	   //服务品牌
	   $("#Form_ads_manage",wraper).find("div[name='brand_check_btn']").next("#brand_check_string").html("");
	   $("div[name='brands']",wraper).data("brandIds",[]);
		try{
		$("#Form_service_brand .jrad-tree",wraper).tree('destroy');
		}catch(e) {
		}
	   var treeOption = setBrandTree(wraper);
	   $("#Form_service_brand .jrad-tree",wraper).tree(treeOption);
	  //地区
	   $("#Form_ads_manage div[name='regions']",wraper).data("areaList",[]);
	   $("#Form_ads_manage #area_check_string",wraper).html("");
	   //广告跳转ID
	   $("#Form_ads_manage .nameTips",wraper).html("");
	   getNameTips();
}
//修改时赋值
function Form_ads_manageVal(wraper,item){
   	$("#serviceNames",wraper).html(item.serviceName);
   	var _ul = $("div[name='adPicFile']",wraper).children(".pic-show");
   	var src = item.adPicSmallAddress;
   	if(src!=undefined&&src!=""){
	  	var _li = '<li name="" class="adPicBoxli"><div class="large-pic"><div class="pic-box"><div class="pic-content"><div class="pic-vc">'
				+'<img src="'+src+'">'
				+'</div></div><span name="small" class="del-btn"></span></div></div></li>'
	  	_ul.html(_li);
	  	$(".adPicBoxli .del-btn",wraper).click(function(){
			var small = $(this).prev(".pic-content").find("img").attr("src");
			$(this).parents(".adPicBoxli").remove();
		    $("input[name='adPicAddress']",wraper).val("");
		    $("input[name='adPicMiddleAddress']",wraper).val("");
		    $("input[name='adPicSmallAddress']",wraper).val("");
	  	});
	}

    //车系ids
	if(item.brandIds.length==1&&item.brandIds[0].brandId =="0"){
	}else{
	$.each(item.brandIds,function(i,json){
		var node = $("#brandsTree",wraper).tree('getNodeByParam','id',json.brandId);
		var pNode = node.getParentNode();
		$("#brandsTree",wraper).tree('open',pNode,true);
		$("#brandsTree",wraper).tree('open',node,true);
	});
    }
	$("div[name='brands']",wraper).data("brandIds",item.brandIds);
    //车系名字显示
    var brandCheckString = [];
    if(item.brandNames!=undefined&&item.brandNames.length > 0){
	  	$.each(item.brandNames,function(i){
			if(item.brandNames[i].modelName!=undefined&&item.brandNames[i].modelName!=""){
				$.merge(brandCheckString,item.brandNames[i].modelName.split(","));
			}else{
				brandCheckString.push(item.brandNames[i].brandName);
			}
	    });
    }
   	$.unique(brandCheckString);
   	$("#brand_check_string",wraper).html("已选择： "+brandCheckString.join(","));

   	//地区
   	var areaList = item.regions;
   	$.each(areaList,function(i){
       	if(areaList[i].areaList.length==0){
	    	areaList[i].areaList=[{"areaCodeId":"0"}];
	   	}
   	});

   	$("#Form_ads_manage div[name='regions']",wraper).data('areaList',areaList);
   	addAreaList(areaList,wraper);

   	//广告跳转绑定ID
   	$("input[name='entityId']",wraper).val(item.entityId);
   	$("input[name='entityId']",wraper).focus().blur();
}

function updateAdsView(id,wraper){
	var item = $.jRadGet({url : '/shopmanage-ws/ws/0.1/marketAdInfoCms/detailMarketAdInfo?id='+id});
	$(".details-box .details-tab",wraper).find("span[name='title']").html("广告修改");
	initAdsInfo(wraper);
	$('.jrad-table',wraper).slideUp();
	$('.details-box',wraper).slideDown();
	$(".scroll-up-btn").click();
	$('#Form_ads_manage',wraper).form({item: item});
	item.id = id;
	item.osInfo = item.osInfo.split(",");
	item.location = item.location;
	$('#Form_ads_manage',wraper).form({item: item});
	Form_ads_manageVal(wraper,item);

	if($(".areaSpan").eq(0).html() == '<span title="移除" class="delspan delArea">X</span>'){
   		$(".areaSpan").eq(0).remove();
   	}
}

function getNameTips(){
	var wraper = $("#Wraper_ads_manage");
	$("#Form_ads_manage .nameTips",wraper).html("");
	$("#Form_ads_manage div[name='entityId']",wraper).focusout(function(){
		var flag = $("#Form_ads_manage div[name='entityId']",wraper).input('validate',[{msg:"id只能是数字",type:'regex',value:/^\d+$/}]);
		if($("#Form_ads_manage div[name='entityId']",wraper).input('val')==""){
		flag=false;
		}
		if(flag){
			var id = $(this).input("val");
			var _tip = $(this).parent().children(".nameTips");
			var adTurnType = $("#Form_ads_manage div[name='adTurnType']",wraper).select('val');
			if(adTurnType=="1"){
				$.jRadGet({
				url:'/shopmanage-ws/ws/0.1/shopmanage/shop/name?id='+id,
				success: function(data){
					_tip.html(data.businessName).css("color","#1F2228");
				},
				error:function(){
					_tip.html("查询商家不存在！").css("color","#BB4B47");
				}
				});
			}else if(adTurnType=="2"){
				$.jRadGet({
				url:'/shopmanage-ws/ws/0.1/informationCms/detailInformation?id='+id,
				success: function(data){
					_tip.html(data.title).css("color","#1F2228");
				},
				error:function(){
					_tip.html("查询资讯不存在！").css("color","#BB4B47");
				}
				});
			}
		}else{
			$(this).parent().children(".nameTips").html("");
		}
	});
}

function showAdsError(xhr){
	var errormsg = eval("(" + xhr.responseText + ")");
	var cDiv = $("#Wraper_ads_manage .cDiv");
	$.jRadMessage({level:'error',message:errormsg[0].message,selector:cDiv});
}
</script>

