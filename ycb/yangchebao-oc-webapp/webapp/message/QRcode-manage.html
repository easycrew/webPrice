<div class="urlContentWraper" id="Wraper_message_QRcode-manage">
    <div class="ui-info-layout">
      <div class="qdiv">
           <h2 class="ui-tit"><strong>二维码活动管理</strong><bottom class="all-work-info numb95">页面说明</bottom></h2>
           <!-- 列表显示 -->
           <table id="Table_message_QRcode-manage"></table>
      </div>
      <div class="bdiv" style="margin-top:10px;">
           <h2 class="ui-tit"><strong>商家列表</strong></h2>
           <!-- 列表显示 -->
           <table id="Table_message_QRcode-manage_shoplist"></table>
      </div>
    </div>
    <div id="Form_message_QRcode-manage" style="display:none;">
        <div class="grid-layout-main jrad-form"> 
            <div class="row">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 活动主题：</label>
                 <div class="span6 grid-layout-content fluid-wrap">
                       <div class="jrad-input-container" name="theme"></div>
                 </div>
            </div>
            <div class="row">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 活动类型：</label>
                 <div class="span6 grid-layout-content fluid-wrap">
						<div class="jrad-select-container" name="activeType"></div>
				 </div>
            </div>
			<div class="row active_row" id="template-view" style="display:none;">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 活动领取：</label>
                 <div class="span5 grid-layout-content fluid-wrap">
						<!-- <div class="jrad-select-container" name="awardType"></div> -->
						<select name="awardType" style="width:200px;height:24px;">
							 <option value="1">代金券</option>
							 <option value="2">积分</option>
						</select>
				 </div>
				 <label class="span4 grid-layout-label"><span class="ui-form-required">*</span>
				 代金券主题ID/积分数量：</label>
				 <div class="span3 grid-layout-content fluid-wrap edit-awardValue">
						<input name="awardValue" type="text" style="height:24px;">
				 </div>
				 
            </div>
           <div style="display:inline-block;cursor:pointer;font-size:18px;float:right;position:relative;top:-29px;left:-3px;" id="add">+</div>
			<div class="row">
				
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 有效期开始时间：</label>
                 <div class="span6 grid-layout-content fluid-wrap">
                       <div class="jrad-dateinput-container" name="effectiveStartTime"></div>
                 </div>
            </div>
            <div class="row">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 有效期结束时间：</label>
                 <div class="span6 grid-layout-content fluid-wrap">
                       <div class="jrad-dateinput-container" name="effectiveEndTime"></div>
                 </div>
            </div>
            <div class="row">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 状态：</label>
                 <div class="span6 grid-layout-content fluid-wrap">
                       <div name="status" class="jrad-select-container"></div>
                 </div>
            </div> 
            <div class="row">
                 <label class="span3 grid-layout-label"><span class="ui-form-required">*</span>
				 APP显示内容：</label>
                 <div class="span12 grid-layout-content fluid-wrap">
                       <div name="appShowContent" class="jrad-mediaarea-container"></div>
                 </div>
            </div> 
            <input type="hidden" name="qrcodeActiveId"/> 
            <input type="hidden" name="lastModifier"/> 
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span>
        </div>
    </div>
    <div id="Form_message_QRcode-manage_shoplist" style="display:none;">
        <div class="grid-layout-main jrad-form">  
		    <input name="qrcodeActiveId" type="hidden"/>   
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					<span class="ui-form-required">*</span>商家ID：
				</label>
				<div class="span5 grid-layout-content fluid-wrap">
					<div name="busiIds" class="jrad-input-container">
					</div> 
					<p class="tip">多个商家id用英文逗号隔开</p>
				</div>
			</div> 
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span>
        </div>
    </div> 
    <div id="Form_message_QRcode-manage_addaccount" style="display:none;">
        <div class="grid-layout-main jrad-form">  
		    <input name="qrcodeActiveId" type="hidden"/>  
		    <input name="busiId" type="hidden"/> 
		    <input name="shroffAccountId" type="hidden"/> 
			<div class="row"> 
				<div class="span15 grid-layout-content">
                  <div name="shroffAccountId" class="jrad-radio-container vertical"> 
                  </div>
                </div>
			</div> 
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span>
			<span class="jrad-btn-normal">取消</span>
        </div>
    </div>
    <div id="Form_message_QRcode-manage_checkaccount" style="display:none;">
        <div class="grid-layout-main jrad-form">  
		    <input name="qrcodeActiveId" type="hidden"/>  
		    <input name="busiId" type="hidden"/> 
		    <input name="shroffAccountId" type="hidden"/> 
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					户主姓名：
				</label>
				<label name="accountName" style="margin-top:15px;position:relative;top:3px;"></label>
			</div> 
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					账号：
				</label>
				<label style="margin-top:15px;position:relative;top:5px;" name="accountNo"></label>
			</div> 
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					开户地：
				</label>
				<label style="margin-top:15px;position:relative;top:3px;" name="provinceName"></label>
			</div> 
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					开户分行：
				</label>
				<label style="margin-top:15px;position:relative;top:3px;" name="bankBranch"></label>
			</div> 
			<div class="row"> 
				<label class="span3 grid-layout-label"> 
					下载领取次数：
				</label>
				<label style="margin-top:15px;position:relative;top:5px;" name="scanCnt"></label>
			</div> 
        </div> 
    </div>  
    <div id="Form_explain_eg95" style="display:none;">
        <div class="grid-layout-main jrad-form"> 
            <div class="row">
                <label class="span3 grid-layout-label">业务说明：</label>
                <div class="span12 grid-layout-content">
                    <div><strong>功能简介：</strong>此活动已停用，不用看啦。</div>
                    <div><strong>重要功能说明：</strong>无。</div>
                    <div><strong>注意事项：</strong>无。</div>
                </div> 
            </div> 
            <div class="row">
                <label class="span3 grid-layout-label">备注：</label>
                <div class="span12 grid-layout-content">
                    <div class="jrad-textarea-container" name="remark">
                    </div>
                </div>
            </div>
        </div>
        <div class="jrad-buttons-container ui-buttons-container"> 
            <span class="jrad-btn-primary">确定</span> 
            <span class="jrad-btn-normal">取消</span>
        </div>
    </div>	
</div>
<script type="text/javascript">
$(document).ready(function(){
    var wraper = $('#Wraper_message_QRcode-manage');
    var page_column_model = new Array();
    var page_column_model_c = new Array();
    var page_search_items = new Array();
    var page_list_buttons = new Array();
    var page_list_buttons_c = new Array();
	//var jRad = $.jRad('/radsample-ws','ent','Menu');	
	var entityModel = {};
    var jRad = $.jRad({app:'radsample-ws',entityModel:entityModel}); 
	jRad.params['activeType'] = {
		data: [{id:'',name:'全部'},{id:'1',name:'本店活动'},{id:'2',name:'换量活动'}] 
	}; 
	jRad.params['status'] = {
		data: [{id:'',name:'全部'},{id:'0',name:'无效'},{id:'1',name:'有效'},{id:'2',name:'已删除'}] 
	}; 
	var fields_params = {}; 
	fields_params["activeType"]={data:[{"id":"1","name":"本店活动"},{"id":"2","name":"换量活动"}]};	
	fields_params["status"]={data:[{"id":"0","name":"无效"},{"id":"1","name":"有效"},{"id":"2","name":"已删除"}]};
	fields_params["awardType"]={data:[{"id":"1","name":"代金券"},{"id":"2","name":"积分"}]};
   $('#Form_message_QRcode-manage').form({
		fluid: true,
		validators: jRad.validators,  
		fields_params: fields_params,
		autobinding:true
	});
    page_column_model.push({display: '活动ID', name : 'qrcodeActiveId'}); 
	page_column_model.push({display: '活动主题', name : 'theme'}); 
    page_column_model.push({display: '活动类型', name : 'activeType'});
    page_column_model.push({display: '有效期开始时间', name : 'effectiveStartTime'});
	page_column_model.push({display: '有效期结束时间', name : 'effectiveEndTime'});
	page_column_model.push({display: '创建时间', name : 'createTime'});
	page_column_model.push({display: '状态', name : 'status'});
    page_column_model.push({display: '最后操作人', name : 'lastModifier'});
	
    
   page_search_items.push({row:'1',type:'jrad-input',display:'活动主题',name:'theme'}); 
   page_search_items.push({row:'1',type:'jrad-select',display:'活动类型',name:'activeType',params:jRad.params['activeType']}); 
   page_search_items.push({row:'1',type:'jrad-select',display:'状态',name:'status',params:jRad.params['status']}); 
   page_search_items.push({row:'2',type:'jrad-dateinput',display:'有效期开始时间',name:'effectiveStartTime'}); 
   page_search_items.push({row:'2',type:'jrad-dateinput',display:'有效期结束时间',name:'effectiveEndTime'}); 
   page_search_items.push({row:'2',type:'jrad-input',display:'最后操作人',name:'lastModifier'}); 
   page_search_items.push({row:'3',type:'jrad-dateinput',display:'创建开始时间',name:'createStartTime',params:{dateFmt: 'yyyy-MM-dd HH:mm:ss'}}); 
   page_search_items.push({row:'3',type:'jrad-dateinput',display:'创建结束时间',name:'createEndTime',params:{dateFmt: 'yyyy-MM-dd HH:mm:ss'}});

   page_list_buttons.push({title: '创建',name:'Add', bclass: 'add',onpress : function(){
				var form = $('#Form_message_QRcode-manage',wraper);

				//$("#template-view").hide();
				//$("#Form_message_QRcode-manage .template-create").remove();
				items([]);
				newItem();

				form.form({
					title:'创建', 
	                item:{},
	                url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/addActive',
	                before_submit:function(json){
	                	delete json.awardType;
	                	delete json.awardValue;
	                	json.lastModifier = carsmart_config.operatorName;
	                	
						var awards = items();
						json.awards = awards;

						console.log("add json:");
						console.log(json);

	                	return json;
	                },
	                success_callback:function(data){ 
						$('#Table_message_QRcode-manage').flexMessage('创建成功', 'success');
						$('#Table_message_QRcode-manage').flexReload();
					}  
            	}).form('open'); 
				
		}
	});
	 page_list_buttons.push({title: '修改',name:'Edit', bclass: 'edit',prefunc:function(){
            var checked = $('#Table_message_QRcode-manage').getCheckedTrs();
            if (checked.length != 1) {return false;}else{return true;}
        },onpress : function(){
	    	var checked = $('#Table_message_QRcode-manage').getCheckedTrs(); 
			var qrcodeActiveId = checked[0].qrcodeActiveId;
			var item = $ .jRadGet({url : '/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/activeDetail?qrcodeActiveId='+qrcodeActiveId}); 
			item.qrcodeActiveId = qrcodeActiveId;
			var awardsValue = item.awards;

			// init awards
			if (!awardsValue || awardsValue.length <= 0) {
				items([]);
				newItem();
			}
			else {
				items(awardsValue);	
				console.log("init detail");
			}
			 
			if(checked[0]) {
				var _form = $('#Form_message_QRcode-manage',wraper);
				_form.form({
					title:'编辑', 
	                item:item,
	                url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/editActive',
	                before_submit:function(json){
	                	
	                	delete json.awardType;
	                	delete json.awardValue;

	                	json.lastModifier = carsmart_config.operatorName;

	                	console.log("before_submit");
	                	var awards = items();
	                	json.awards=awards;
	                	
	                	return json;
	                },
	                success_callback:function(){
	                	$('#Table_message_QRcode-manage').flexMessage('修改成功','success');
	                	$('#Table_message_QRcode-manage').flexReload();
	                }
            	}).form('open');
			}
		}
	}); 
    page_list_buttons.push({separator: true});
    
    $('#Table_message_QRcode-manage').flexigrid({
            reload:true,
			method:'get',
            colModel : page_column_model,
            buttons : page_list_buttons,
            searchitems :page_search_items,
            pagination: {
				diaplay_pages: 5,
				align: 'bottom' 
			},
			showSearch:true,  
            url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/getActiveList', //此时userId为当前登录用户的ID 
			onError:showError, 
			checkBoxType:'single',
			trEvent:function(){		//监听行事件 
				var checked = $('#Table_message_QRcode-manage').getCheckedTrs();  
				$('#Table_message_QRcode-manage_shoplist').flexOptions({ 
					extParam:{
						qrcodeActiveId: checked[0].qrcodeActiveId
					}
				}).flexReload();
			}
    });

    $('#Form_message_QRcode-manage_shoplist').form({
		title: '添加', 
		fluid: true,
		autobinding:true
	}); 

	$('#Form_message_QRcode-manage_checkaccount').form({
		title: '账号详情', 
		fluid: true,
		autobinding:true
	});
	$('#Form_message_QRcode-manage_addaccount').form({
		title: '业务员账号添加', 
		fluid: true,
		autobinding:true  
	});	
    page_column_model_c.push({display: '商家ID', name : 'busiId'});	
	page_column_model_c.push({display: '商家简称', name : 'busiRegName'});
	page_column_model_c.push({display: '商家地址', name : 'address'});
	page_column_model_c.push({display: '合作等级', name : 'cooperationLevel'});    
	page_column_model_c.push({display: '业务员账号', name : 'shroffAccountId',diy:function(item,$div){
		// $div.html("<a href='javascript:' id='add_account'>添加</a>&nbsp;&nbsp;<a href='javascript:' id='check_account'>查看详情</a>&nbsp;&nbsp;<a href='javascript:' id='del_account'>删除</a>");
		var addaccount=$("<a>").addClass("add_account").attr({href:"javascript:"}).css("margin-right","10px").html("添加"); 
		var checkaccount=$("<a>").addClass("check_account").attr({href:"javascript:"}).css("margin-right","10px").html("查看详情");var delaccount=$("<a>").addClass("del_account").attr({href:"javascript:"}).html("删除");
        $div.html(addaccount.after(checkaccount.after(delaccount))); 
		$("a.add_account",$div).bind('click',function(){
		var shroffAccountId = item.shroffAccountId; 
	    var checked = $('#Table_message_QRcode-manage').getCheckedTrs(); 
	    var addaccounts = [];
		var items = $.jRadGet({url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/goAddShroffAccountRel?qrcodeActiveId='+checked[0].qrcodeActiveId+'&busiId='+item.busiId}); 
		$.each(items,function(index){
			var item = items[index]; 
			var json = {};
			json.id = item.shroffAccountId;
			json.name = item.provinceName +"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "+(item.bankBranch==undefined?"":item.bankBranch)+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "+(item.bankAccount==undefined?"":item.bankAccount)+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "+item.accountHolder; 
				addaccounts.push(json); 
			}); 
		var addaccount_fields_params = {}; 
	    addaccount_fields_params['shroffAccountId']={
	        	data:addaccounts
	       }; 


        if(items.length==0){ 
        	$('#Table_message_QRcode-manage_shoplist').flexMessage("该商家暂无业务员账号", 'error');   //errormsg[0].message需要自定义
        	return false;
        }
    	$("#Form_message_QRcode-manage_addaccount").form({ 
				title: '业务员账号添加',
				url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/saveShroffAccountRel',
				fields_params:addaccount_fields_params,
				before_submit:function(json){ 
				        json.qrcodeActiveId = checked[0].qrcodeActiveId;
				        json.busiId = item.busiId; 
				        return json;
				},
				
				success_callback:function(data){  
                              $('#Table_message_QRcode-manage_shoplist').flexMessage('添加成功', 'success');
                              $('#Table_message_QRcode-manage_shoplist').flexReload();
                        }
  
			}).form('open');
    	    $("#Form_message_QRcode-manage_addaccount div[name='shroffAccountId']").radio("val",items[0].shroffAccountId); 
    	   // alert("1");
        });
	    $("a.check_account", $div).bind('click',function(){ 
	    	var checked = $('#Table_message_QRcode-manage').getCheckedTrs();
			$.jRadGet({
					  url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/getShroffAccountRelDetail?qrcodeActiveId='+checked[0].qrcodeActiveId+'&busiId='+item.busiId,
					  success:function(data){
					  		$("#Form_message_QRcode-manage_checkaccount").form({
					    		title:"账号详情",
					    		//url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/getShroffAccountRelDetail',
					    		success_callback:function(){
				                            $('#Table_message_QRcode-manage_shoplist').flexReload();
				                        }
					    	}).form('open');
					    	$("label[name='accountName']").html(data.accountName);
							$("label[name='accountNo']").html(data.accountNo);
							$("label[name='provinceName']").html(data.provinceName);
							$("label[name='bankBranch']").html(data.bankBranch);
							$("label[name='scanCnt']").html(data.scanCnt); 
					  },
					  error:function(xhr){
					  		var errormsg = eval("(" + xhr.responseText + ")"); 
							if (errormsg != undefined) {
								$('#Table_message_QRcode-manage_shoplist').flexMessage(errormsg[0].message, 'error');
							} 
					  }
					}); 
	    });
	    $("a.del_account",$div).bind('click',function(){
	        var checked = $('#Table_message_QRcode-manage').getCheckedTrs();
	        var postData = {};
	        postData.qrcodeActiveId = checked[0].qrcodeActiveId;
	        postData.busiId = item.busiId; 
	         
	        $.jRadPost({
	        	url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/delShroffAccountRel',
	        	data:postData, 
	        	success:function(){
	        		$.jRadConfirm('确认删除吗？',1,function(){
					$('#Table_message_QRcode-manage_shoplist').flexMessage('删除成功!', 'success');
	           	    $('#Table_message_QRcode-manage_shoplist').flexReloadSearch(); 
					 
				})
				// 
			  },error:function(xhr){
				    var errormsg = eval("(" + xhr.responseText + ")"); 
					if (errormsg != undefined) {
						$('#Table_message_QRcode-manage_shoplist').flexMessage(errormsg[0].message, 'error');
					}
				}
		    });
	    }); 
        }});
       
		

	page_list_buttons_c.push({name:'Add',bclass: 'add',onpress : function(){
 			$('#Form_message_QRcode-manage_shoplist').form({
                title: '创建',
                // validators: jRad.validators,
                item:{},  
                style:{height:'100px'}, 
               	url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/addActiveBusiIdsRel',
				before_submit:function(json){ 
					var checked = $('#Table_message_QRcode-manage').getCheckedTrs();
					json.qrcodeActiveId = checked[0]. qrcodeActiveId;
					return json;
				},				
				success_callback:function(){ 
                            $('#Table_message_QRcode-manage_shoplist').flexMessage('添加成功', 'success');
                            $('#Table_message_QRcode-manage_shoplist').flexReload();
                        } 
            }).form('open');  
		}
	}); 
	page_list_buttons_c.push({name:'delete',bclass: 'delete',prefunc:function(){ 
            var checked = $('#Table_message_QRcode-manage_shoplist').getCheckedTrs();
            if (checked.length < 1) {return false;} 
        },onpress : function(){
	    	var checked = $('#Table_message_QRcode-manage_shoplist').getCheckedTrs();   
			$ .jRadConfirm('确认删除吗？',1,function(){
				var ids = [];
				$.each(checked,function(i){
					ids.push(checked[i].busiId);
				});
				var postData = {};
				postData.busiIds = ids.join(","); 
				var qchecked = $('#Table_message_QRcode-manage').getCheckedTrs();
				postData.qrcodeActiveId = qchecked[0]. qrcodeActiveId; 
				$.jRadPost({
					url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/delActiveBusiIdsRel',
					data:postData,
					success:function(){ 
						$('#Table_message_QRcode-manage_shoplist').flexMessage('已删除', 'success');
	                    $('#Table_message_QRcode-manage_shoplist').flexReload();
					} 
				});   
			});  
		}
	}); 

 	 page_list_buttons.push({separator: true});
    
    $('#Table_message_QRcode-manage_shoplist').flexigrid({
            reload:true,
            autoload: false,
			method:'get',
            colModel : page_column_model_c,
            buttons : page_list_buttons_c,
            dataType: 'json',
            searchitems: [],
			showSearch:true,  
            url:'/shopmanage-ws/ws/0.1/qrCodeActiveManageCms/getActiveBusiList', //此时userId为当前登录用户的ID 
            pagedStyle: 'oc'
    });
     
    
    $("#add").click(function(){
    	//var num=0;
    	// var str='<div class="row" id="active_value"'+num+'>';
    	// str+='<label class="span3 grid-layout-label">'
    	//     +'<span class="ui-form-required">*</span>'
    	//     +'活动领取：</label><div class="span5 grid-layout-content fluid-wrap">'
    	//     +'<div class="jrad-select-container" name="awardType"></div>'
    	//     +'</div><label class="span4 grid-layout-label">'
    	//     +'<span class="ui-form-required">*</span>'
    	//     +'代金券ID/积分数量：</label><div class="span3 grid-layout-content fluid-wrap">'
    	//     +'<div class="jrad-input-container" name="awardValue"></div>'
    	//     +'</div>'
    	//     +'</div>';
    	
    	// var _row = $("<div>").addClass("row active_row template-create");
    	// var _label = $("<label>").addClass('span3 grid-layout-label').html('<span class="ui-form-required">*</span>活动领取：');
    	// var _div = $("<div>").addClass("span5 grid-layout-content fluid-wrap");
    	// var _select = $("<div>").addClass("jrad-select-container").attr('name','awardType');
    	// var _label2 = $("<label>").addClass('span4 grid-layout-label').html('<span class="ui-form-required">*</span>代金券ID/积分数量：');
    	// var _div2 = $("<div>").addClass("span3 grid-layout-content fluid-wrap");
    	// var _input = $("<div>").addClass("jrad-input-container").attr('name','awardValue');
    	// _row.append(_label).append(_div.append(_select)).append(_label2).append(_div2.append(_input));
    	// _select.select({data:[{"id":"1","name":"代金券"},{"id":"2","name":"积分"}]});
    	// _input.input();
    	// $(this).before(_row); 
    	
    	// alert($("#active_value"+num).find(".jrad-select-container").html());
    	// $("#active_value"+num).find(".jrad-select-container").select();
    	// $("#active_value"+num).find(".jrad-input-container").input();
    	//num++;
    	
    	newItem();
    	
    });

	function newItem (value) {

		if (!value) {
			value = {
				awardType: 1,
				awardValue: ""
			};
		}
		
		var form = $("#Form_message_QRcode-manage");

		// get already create count
		var count = form.find("[index]").length;

		var clone = $("#template-view").clone(false);
		clone.attr("id", "");
		clone.attr("index", count);
		var awardTypeView = clone.find("select[name=awardType]").attr("name", "awardType_" + count);
		var awardValueView = clone.find("input[name=awardValue]").attr("name", "awardValue_" + count);

		awardTypeView.attr("value", value.awardType || 1);
		awardValueView.val(value.awardValue || "");

		clone.show();

		$("#add").before(clone);

		console.log("item[" + count + "] created | awardType: " + value.awardType + ", awardValue: " + value.awardValue);

		return clone;
	};


	function items (values) {
		
		var form = $("#Form_message_QRcode-manage");
		var views = form.find("[index]");

		// get
		if (typeof values == "undefined") {
			
			var items = [];

			$.each(views, function () {
				
				var awardType = $(this).find("select[name^='awardType_']").val();
				var awardValue =$(this).find("input[name^='awardValue_']").val();

				items.push({
					awardType: awardType,
					awardValue: awardValue
				});
			});

			return items;
		}

		// set
		else {

			views.remove();

			console.log("set awards: ");
			console.log(values);

			if (!values || values.length <= 0) {
				return;
			}

			for (var i in values) {
				var value = values[i];

				if (!value || typeof value != "object") {
					continue;
				}
				newItem(value);
			}
		}
	}
	
	function showError(xhr){
		 var errormsg = eval("(" + xhr.responseText + ")"); 
		  $.jRadMessage({level:'error',message:errormsg[0].message});
		}
		
    $(".numb95").click(function(){
        $('.overcurtainDiv').hide();
        var menuId = $(".tabs-selected").attr("menuId")
        var data = $.jRadGet({url:'/shopmanage-ws/ws/0.1/remark/getMenuRemark?menuId='+menuId})
        $("#Form_explain_eg95").form({}).form('close');
        $("#Form_explain_eg95").form({
            title:'页面说明',
            item:data,
            autobinding: true, 
            submit:function(){
                var postData = {};
                postData.operator = carsmart_config.operatorName;
                postData.menuName = $(".tabs-selected").attr("menuName");
                postData.menuId = $(".tabs-selected").attr("menuId");
                postData.remark = $("#Form_explain_eg95 div[name='remark']").textarea("val")
                $.jRadPost({
                    url:'/shopmanage-ws/ws/0.1/remark/updateMenuRemark',
                    data:postData,
                    success:function(){
                        $("#Form_explain_eg95").form('close')
                        $('.overcurtainDiv').hide();
                    }
                });
            }, 
            cancel:function(){
                $("#Form_explain_eg95").form('close')
                $('.overcurtainDiv').hide();
            }
        }).form('open')
        $("#Form_explain_eg95 .textarea-content").removeClass("span4").addClass("span12")
        $('.overcurtainDiv').hide();
        $('.overcurtainDiv').eq(0).show().attr("style","z-index:303;display:block");
    })
	
});


 
 
</script>

