<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes" />
	<meta content="yes" name="apple-mobile-web-app-capable"/>
	<meta content="black" name="apple-mobile-web-app-status-bar-style"/> 
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
	<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js"></script> 
    <script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery.json-2.2.000000000000000.js"></script>
    <script src="http://www.yibaoxian.com/m/js/insureCityData.js"></script>
	<title>信息录入</title>
	<style>
		*{
			margin: 0;
			padding: 0;
			list-style: none;
		}
		body{
			background-color: #f4f7f8;
			font-size: 62.5%;
			font-family: 'Hiragino Sans GB',Helvetica,Arial,sans-serif;
			color: #1e1e1e;
		}
		img{
			border: none;
			vertical-align: middle;
		}
		a{
			text-decoration: none;
			outline:none;
			blr:expression(this.onFocus=this.blur());
		}
		span.cd{
			position: relative;
			float: right;
			right: 1.6rem;
			top: 1rem;
		}
		span.cd::before,span.cd::after{  
			position: absolute;
		    width: 0;   
		    height: 0;   
		    content: '';
		    border-left: 12px solid transparent;  
		    border-right: 12px solid transparent;  
		    border-top: 12px solid #d9d9e2;  
		    font-size: 0;  
		    line-height: 0; 
		    top: -11px; 
		}
		span.cd::after {  
			top: -13px; 
		    border-top: 12px solid #fff;  
		}

		div.container{
			background-color: #fff;
			position: relative;
			min-width: 320px;
			max-width: 640px;
			margin: 0 auto;
		}
		
		section{
			padding-top: 1.6rem;
		}
		section article div.title span{
			color: #1e1e1e;
			font-size: 1rem;
		}
		section article div.title{
			margin-bottom: 0.3rem;
		}
		section article{
			width: 90%;
			margin: 0 auto 1.1rem;
		}
		div.driveCity-detail p{
			border: 1px solid #d9d9e2;
			-webkit-border-radius:5px;
			-moz-border-radius:5px;
			border-radius:5px;
			padding: 0 0.5rem;
			cursor: pointer;
			line-height: 2.2rem;
		}
		div.driveCity-detail p span.spanCity{
			font-size: 1rem;
		}
		div.driveCity-detail p span.spanImg{
			margin-right: 0.6rem;
		}
		div.driveCity-detail p span.spanImg img{
			width: 0.9rem;
			margin-top: -0.4rem;
		}
		span.driveCity-title-left{
			float: left;
		}
		p.carNumber-title-right{
			float: right;
			text-align: right;
		}
		p.carNumber-title-right img{
			width: 4rem;
			margin-left: 0.7rem;
			margin-top: -0.4rem;
			cursor: pointer;
		}
		div.carNumber-detail{
			overflow: hidden;
		}
		p.carNumberCity{
			width: 25%;
			float: left;
			border: 1px solid #d9d9e2;
			-webkit-border-radius:5px;
			-moz-border-radius:5px;
			border-radius:5px;
			padding: 0.5rem;
			cursor: pointer;
		}
		p.carNumberCity span.carNumberCity-text{
			font-size: 1rem;
		}
		input.carNumber{
			width: 60%;
			float: right;
			border: 1px solid #d9d9e2;
			-webkit-border-radius:5px;
			-moz-border-radius:5px;
			border-radius:5px;
			padding: 0.6rem 0.5rem;
			font-size: 1rem;
			font-family: 'Hiragino Sans GB',Helvetica,Arial,sans-serif;
			background-color: transparent;
		}
		p.carNumberCity img{
			width: 1.5rem;
			float: right;
			position: relative;
			top: 0.2rem;
		}
		input.carHolder-name{
			width: 95%;
			border: 1px solid #d9d9e2;
			-webkit-border-radius:5px;
			-moz-border-radius:5px;
			border-radius:5px;
			padding: 0.6rem 0.5rem;
			font-size: 1rem;
			font-family: 'Hiragino Sans GB',Helvetica,Arial,sans-serif;
			background-color: transparent;
		}
		div.next{
			border-top: 1px solid #DCDCE4;
			background-color: #f4f7f8;
			text-align: center;
			padding-top: 1rem;
			padding-bottom: 4rem;
		}
		p.nextBtn{
			/*margin: 0 0 3rem 0;*/
			-webkit-border-radius:8px;
			-moz-border-radius:8px;
			border-radius:8px;
			background:#ff6138;
			width: 92%;
			margin: 0 auto;
			color: #fff;
			font-size: 1.1rem;
			line-height: 2.4rem;
			cursor: pointer;
		}

		div.overLay{
			position: absolute;
			top: 0;
			z-index: 100;
			width: 100%;
			background-color: #000;
			opacity: 0.6;
			filter:alpha(opacity=60);
		}

        div.carArea{
			position: absolute;
			top: 1rem;
			z-index: 200;
			width: 90%;
			/*height: 100%;*/
			padding: 0 5%;
		}
		div.carArea-close{
			text-align: right;
		}
		div.carArea-close canvas{
			cursor: pointer;
		}
		ul.carArea-detail-ul{
			overflow: hidden;
		}
		ul.carArea-detail-ul li{
			float: left;
			width: 16%;
			margin-right: 5%;
			text-align: center;
			margin-top: 0.8rem;
		}
		ul.carArea-detail-ul li:nth-of-type(5n){
			margin-right: 0!important;
		}
		ul.carArea-detail-ul li p{
			border: 1px solid #fff;
			-webkit-border-radius: 5px;
			-moz-border-radius: 5px;
			border-radius: 5px;
			font-size: 1.3rem;
			color: #fff;
			line-height: 2.8rem;
			cursor: pointer;
		}


		div.errorLog{
			position: fixed;
			top: 0;
			z-index: 500;
			height: 100%;
			width: 100%;
			background-color: rgba(0,0,0,0);
		}
		div.errorLog p{
			position: relative;
			width: 90%;
			margin: 6rem auto;
			background-color: rgba(0,0,0,0.5);
			font-size: 1rem;
			color: #fff;
			text-align: center;
			padding: 0.6rem 0;
			border-radius: 8px;
		}
		
		.searchCity{
			position: relative;
			margin-top: 2.9rem;
			padding: 0.8rem 1rem 0.8rem 0.8rem;
			background-color: #fff;
		}
		#searchCity{
			width: 70%;
			border-top-left-radius: 8px;
			border-bottom-left-radius: 8px;
			background: #f2f3f4 url(http://app.yangchebao.com.cn/group1/M00/02/72/ChoCK1Zf9AuAVjxLAAAESSohc_Q214.png) 0.6rem center no-repeat;
			background-size: 1.2rem;
			color: #a2a2a2;
			padding: 10px 0.6rem 10px 2.2rem;
			border: none;
			font-size: 1rem;
			line-height: 20px;
			-moz-box-sizing: border-box;
			-webkit-box-sizing: border-box;
			box-sizing: border-box;
			float: left;
		}
		#canvas_6{
			position: absolute;
			top: 1.51rem;
			right: 1.8rem;
		}
		span.searchBtn{
			width: 28%;
			color: #ff6138;
			font-size: 1rem;
			display: inline-block;
			text-align: center;
			padding: 5px 0;
			line-height: 28px;
			background-color: #fff;
			border: 1px solid #ff6138;
			border-top-right-radius: 8px;
			border-bottom-right-radius: 8px;
		}
	</style>
</head>
<body>
    <p><input name="eventId" type="hidden" value="QueryCarInsuranceQuotes"></p>
	<div class="container">
    	<div class="overLay" style="display:none;"></div>
		<section>
			<article class="driveCity">
				<div class="title driveCity-title"><span>行驶城市</span></div>
				<div class="detail driveCity-detail"><p><span class="spanImg"><img src="http://app.yangchebao.com.cn/group1/M00/01/B4/ChoCK1YvJ4qAcuxnAAAF63560Kk375.png"></span><span class="spanCity" name="cityName" id="110100">北京</span></p></div>
			</article>
			<article class="carNumber">
				<div class="title carNumber-title"><span class="carNumber-title-left">车牌号</span><p class="carNumber-title-right"><span>新车未上牌</span><img src="http://app.yangchebao.com.cn/group1/M00/01/BA/ChoCK1YwRIaAOY__AAALvgCaB2U259.png" class="isNewCar"></p><div style="clear:both;"></div></div>
				<div class="detail carNumber-detail">
					<p class="carNumberCity"><span class="carNumberCity-text" name="carNumberCity">京</span><span class="cd"></span></p>
					<input class="carNumber" type="text" name="plateNo" />
				</div>
			</article>
			<article class="carHolder">
				<div class="title carHolder-title"><span>手机号</span></div>
				<div class="detail carHolder-detail"><input class="carHolder-name" type="text" name="mobileNum" /></div>
				<!-- p style="color:#ff6138;font-size:0.9rem;line-height:1.6rem;">信息保密，杜绝骚扰电话</p -->
			</article>
			<div class="next">
				<p class="nextBtn">下一步</p>
			</div>
		</section>
        <div class="carArea" style="display:none;">
			<div class="carArea-close"><canvas width="22px" height="22px" id="canvas"></canvas></div>
			<script type="text/javascript">
				var canvas=document.getElementById('canvas');
				var cxt=canvas.getContext('2d');
				cxt.beginPath();
				cxt.lineWidth=2;
				cxt.strokeStyle="#ff6138";
				cxt.moveTo(0,0);
				cxt.lineTo(22,22);
				cxt.stroke();
				cxt.closePath();
				cxt.beginPath();
				cxt.lineWidth=2;
				cxt.strokeStyle="#ff6138";
				cxt.moveTo(22,0);
				cxt.lineTo(0,22);
				cxt.stroke();
				cxt.closePath();
			</script>
			<div class="carArea-detail">
				<ul class="carArea-detail-ul">
					<li class="carArea-detail-li"><p>京</p></li>
					<li class="carArea-detail-li"><p>沪</p></li>
					<li class="carArea-detail-li"><p>粤</p></li>
					<li class="carArea-detail-li"><p>苏</p></li>
					<li class="carArea-detail-li"><p>浙</p></li>
					<li class="carArea-detail-li"><p>鲁</p></li>
					<li class="carArea-detail-li"><p>晋</p></li>
					<li class="carArea-detail-li"><p>冀</p></li>
					<li class="carArea-detail-li"><p>豫</p></li>
					<li class="carArea-detail-li"><p>川</p></li>
					<li class="carArea-detail-li"><p>渝</p></li>
					<li class="carArea-detail-li"><p>辽</p></li>
					<li class="carArea-detail-li"><p>吉</p></li>
					<li class="carArea-detail-li"><p>黑</p></li>
					<li class="carArea-detail-li"><p>皖</p></li>
					<li class="carArea-detail-li"><p>鄂</p></li>
					<li class="carArea-detail-li"><p>湘</p></li>
					<li class="carArea-detail-li"><p>赣</p></li>
					<li class="carArea-detail-li"><p>闽</p></li>
					<li class="carArea-detail-li"><p>陕</p></li>
					<li class="carArea-detail-li"><p>甘</p></li>
					<li class="carArea-detail-li"><p>宁</p></li>
					<li class="carArea-detail-li"><p>蒙</p></li>
					<li class="carArea-detail-li"><p>津</p></li>
					<li class="carArea-detail-li"><p>贵</p></li>
					<li class="carArea-detail-li"><p>云</p></li>
					<li class="carArea-detail-li"><p>桂</p></li>
					<li class="carArea-detail-li"><p>琼</p></li>
					<li class="carArea-detail-li"><p>青</p></li>
					<li class="carArea-detail-li"><p>新</p></li>
					<li class="carArea-detail-li"><p>藏</p></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="errorLog" style="display:none;">
		<p></p>
	</div>
</body>
<script type="text/javascript">
	$(function(){
        // 本地存储
var store={
	set:function(key,value){
		if(window.localStorage){
			localStorage.setItem(key,JSON.stringify(value))
		}else{
			var name = key;
			document.cookie=name+'='+escape(JSON.stringify(value))
		}
	},
	get:function(key){
		if(window.localStorage){
			try{
				return JSON.parse(localStorage.getItem(key))
			}catch(e){
				return localStorage.getItem(key)
			}
		}else{
			var name = key;
			var arr =document.cookie.match(new RegExp("(^|)"+name+"=([^;]*)(;|$)"));
			if(arr != null) {
				try{
					return JSON.parse(unescape(arr[2]))
				}catch(e){
					return unescape(arr[2])
				}
			}else{
				return null
			}
		}
	},
	remove:function(key){
		if(window.localStorage){
			localStorage.removeItem(key)
		}else{
			var name = key;
			var exp = new Date();
		    exp.setTime(exp.getTime() - 1);
		    var cval=getCookie(name);
		    if(cval!=null)
	        document.cookie= name + "="+cval+";expires="+exp.toGMTString();
		}
	},
	clear:function(){
		if(window.localStorage){
			localStorage.clear()
		}else{
			var keys=document.cookie.match(/[^ =;]+(?=\=)/g); 
			if(keys){ 
				for(var i = keys.length; i--;){
					document.cookie=keys[i]+'=0;expires=' + new Date(0).toUTCString() 
				}
			} 
		}
	}
}
		// 获取参数
		var url = window.location.search; 
	    var paramJson = {};
	    if(url!=''){
	    	var paramsArr = (url.split("?")[1]).split("&");
		    $.each(paramsArr,function(i){
		        var item = paramsArr[i].split("=");
		        paramJson[item[0]] = item[1]
		    });
	    }
        store.remove('userId');
        store.remove('customerId');

        store.set('userId',paramJson.userInfoId);
        store.set('customerId',paramJson.customerId);

        if(bIsAndroid()){
        	$('article.allCitys-letters').hide()
		}
		// 错误框
		var errorLog=function(msg){
			$('div.errorLog').show();
			$('div.errorLog p').html(msg);
			var errorHeight=$('div.errorLog p').outerHeight();
			$('div.errorLog p').css({'top':'50%','margin-top':'-'+errorHeight/2+'px'});
			$('div.errorLog').unbind('click').bind('click',function(){
				$('div.errorLog').hide()
			});
			setTimeout(function(){
				$('div.errorLog').hide()
			},3000)
		};
		// 遮罩层自适应高度
		var bodyHeight=$('body').height();
		var windowHeight=window.screen.availHeight;
		if(bodyHeight>windowHeight){
			$('div.overLay').css('height',bodyHeight)
		}else{
			$('div.overLay').css('height',windowHeight)
		}
		// 初始化信息
		$.ajax({
			url:'/yangchebao-app-ws/ws/0.1/user/carinfo/maincar?userId='+paramJson.userId+'&'+new Date().getTime(),
			type:'get',
			async:false,
			dataType:'json',
			contentType:'application/json;charset=utf-8',
			success:function(data){
                paramJson.carInfoId=data.carInfoId;
				if(data.plateNumber){
					var nuLength=data.plateNumber.length;
					$('span.carNumberCity-text').html(data.plateNumber.substring(0,1));
					$('input[name="plateNo"]').val(data.plateNumber.substring(1,nuLength))
				}
				if(data.mobile){
					$('input[name="mobileNum"]').val(data.mobile)
				}
			}
		});
		// 是否新车
		$('img.isNewCar').unbind('click').bind('click',function(){
			if($(this).attr('src')=='http://app.yangchebao.com.cn/group1/M00/01/BA/ChoCK1YwRIaAOY__AAALvgCaB2U259.png'){
				$(this).attr('src','http://app.yangchebao.com.cn/group1/M00/01/BA/ChoCK1YwRNiAc52HAAAL5zr4rqQ241.png');
				$('div.carNumber-detail').hide()
			}else{
				$(this).attr('src','http://app.yangchebao.com.cn/group1/M00/01/BA/ChoCK1YwRIaAOY__AAALvgCaB2U259.png');
				$('div.carNumber-detail').show()
			}
		});
        // 车牌城市
		$('article.carNumber p.carNumberCity').unbind('click').bind('click',function(){
			$('div.carArea').show();
			$('div.overLay').show();
			window.scrollTo(0,0);
			$('canvas#canvas').unbind('click').bind('click',function(){
				$('div.carArea').hide();
				$('div.overLay').hide()
			});
			$('ul.carArea-detail-ul li p').unbind('click').bind('click',function(){
				$('p.carNumberCity span.carNumberCity-text').html($(this).html());
				$('div.carArea').hide();
				$('div.overLay').hide()
			})
		});
		//下一步
		$('p.nextBtn').unbind('click').bind('click',function(){
            var plateNo=$.trim($('input[name="plateNo"]').val());
            var mobileNum=$.trim($('input[name="mobileNum"]').val());
			if($('span.spanCity').html()==''){
				errorLog('请选择行驶城市');
				return false
			}
			if(!($('input[name="plateNo"]').is(":hidden"))){
                if(plateNo==''){
                   errorLog('请填写车牌号');
				   return false
                }
				if(/^[0-9a-zA-Z]{5,7}$/.test(plateNo)==false){
                   errorLog('请填写正确车牌号');
				   return false
                }
                if(plateNo.length<6){
            	   errorLog('很抱歉，车险查询仅支持六位字符车辆牌照。');
            	   return false
                }
			}
			if(mobileNum==''){
				errorLog('请填写手机号码');
				return false
			}
            if(/^1[0-9]{10}$/.test(mobileNum)==false){
                errorLog('请填写正确的手机号码');
				return false
            }
			var getData={};
			getData.from='m_app_yangchebao';
			getData.uid=paramJson.customerId;
			getData.cityCode=$('span[name="cityName"]').attr('id');
			if(!($('input[name="plateNo"]').is(":hidden"))){
				getData.newcarflag=0;
				getData.licenseNo=$('span[name="carNumberCity"]').html()+$('input[name="plateNo"]').val();
                var postData={};
				postData.customerId=paramJson.customerId;
				postData.carInfoId=paramJson.carInfoId;
				postData.plateNumber=getData.licenseNo;
				$.ajax({
					url:'/yangchebao-app-ws/ws/0.1/user/complete/editCarInfo',
					type:'post',
					data:$.toJSON(postData),
					dataType:'json',
					contentType:'application/json;charset=utf-8',
					async:false,
					success:function(data){
					}
                })
			}else{
				getData.newcarflag=1;
				getData.licenseNo=''
			}
			getData.ownerMobile=$('input[name="mobileNum"]').val();
            
            window.location.href='/yangchebao-app-ws/ws/0.1/insure/rscx/portal?customerId='+paramJson.customerId+'&mobile='+getData.ownerMobile+'&vehicleCity=110100&licenseNo='+getData.licenseNo+'&'+new Date().getTime();
		})
	});
	function bIsAndroid(){
			var sUserAgent = navigator.userAgent.toLowerCase(); 
			var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";
			var bIsIphone = sUserAgent.match(/iphone/i) == "iphone";
			var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";
			var bIsMidp = sUserAgent.match(/midp/i) == "midp";
			var bIsUc7 = sUserAgent.match(/rv:1.2.3.4/i) == "rv:1.2.3.4";
			var bIsUc = sUserAgent.match(/ucweb/i) == "ucweb";
			var bIsAndroid = sUserAgent.match(/android/i) == "android";
			var bIsCE = sUserAgent.match(/windows ce/i) == "windows ce";
			var bIsWM = sUserAgent.match(/windows mobile/i) == "windows mobile"; 
			if(bIsIpad || bIsIphoneOs || bIsIphone){ 
				return false;
			}else{ 
				return true;
			}
	}
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?a5a3a83a3ca372b56738113645a0e057";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</html>