<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,heihgt=device-height,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="format-detection" content="telephone=no" />
	<title>请选择电瓶</title>
	<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js "></script> 
	<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery.json-2.2.000000000000000.js"></script>
	<script src="./js/swiper.min.js"></script>
	<link rel="stylesheet" href="./css/main.css">
	<link rel="stylesheet" href="./date/mobiscroll.custom-2.13.2.min.css">
	<script src="./date/mobiscroll.custom-2.13.2.min.js"></script>
	<script src="./js/commen.js"></script>
	<script src="../js/commen.js"></script>
	<style>
		article.carInfo{
			background-color: #fff;
			padding: 0.4rem 1rem;
			border-bottom: 1px solid #D9D9E2;
		}
		p.carModel,span.styleText{
			font-size: 1rem;
		}
		span.editStyle{
			float: right;
		}
		span.editText{
			font-size: 0.9rem;
			color: #6eaade;
			margin-right: 1rem;
		}
		p.carInfoTip{
			color: #c2c2c6;
			font-size: 0.8rem;
		}
		article.batterys{
			margin-top: 0.8rem;
			background-color: #fff;
		}
		ul.ul-batterys li{
			padding: 0.6rem 1.2rem 0.6rem 1rem;
			border-bottom: 1px solid #D9D9E2;
		}
		ul.ul-batterys li p.batteryLeft{
			float: left;
			margin-right: 1rem;
		}
		p.batteryLeft img{
			width: 3.8rem;
		}
		div.batteryMiddle{
			float: left;
		}
		p.batteryRight{
			float: right;
			text-align: right;
		}
		p.batteryRight img{
			width: 1.3rem;
		}
		div.batteryMiddle p:nth-of-type(1){
			font-size: 1rem;
		}
		div.batteryMiddle p:nth-of-type(2),div.batteryMiddle p:nth-of-type(2) span{
			font-size: 0.9rem;
		}
		div.batteryMiddle p:nth-of-type(3),div.batteryMiddle p:nth-of-type(3) span{
			font-size: 1.2rem;
			color: #f55d5d;
		}
		span.batteryDetail{
			position: relative;
			display: inline-block;
			border:1px solid #6EAADE;
			border-radius:3px;
			padding: 0.1rem 0.5rem;
			font-size: 0.7rem;
			color: #6EAADE;
			margin-left: 0.4rem;
			top: -0.1rem;
		}
		article.payInfo{
			background-color: #fff;
			margin-top: 0.8rem;
		}
		div.payInfo-title{
			padding: 0.5rem 1.2rem 0.5rem 1rem;
			border-bottom: 1px solid #D9D9E2;
		}
		span.titleText{
			display: inline-block;
			font-size: 1rem;
			border-left: 3px solid #f55d5d;
			padding-left: 0.3rem;
			line-height: 1.2rem;
		}
		span.editText{
			font-size: 0.9rem;
			color: #6eaade;
			margin-right: 1rem;
		}
		div.payInfo-detail{
			padding: 0 1.2rem;
			border-bottom: 1px solid #D9D9E2;
		}
		div.row{
			position: relative;
			padding: 0.6rem 0;
			border-bottom: 1px solid #D9D9E2;
		}
		div.row span{
			display: inline-block;
			float: left;
			font-size: 0.9rem;
			color: #A2A2A2;
			line-height: 1.3rem;
			padding-right: 1rem;
		}
		div.row p{
			margin-left: 2.2rem;
			border-left: 1px solid #D9D9E2;
			padding-left: 0.6rem;
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
		}
		p.urgentTreat{
			margin-left: 5.8rem!important;
		}
		p.urgentTreat img{
			width: 2.2rem;
		}
		span.urgentTreatD{
			display: inline-block;
			position: absolute;
			top: 0.7rem;
			right: 0.2rem;
			padding: 0 6.5px!important;
			background-color: #38BCFF;
			color: #fff!important;
			-webkit-border-radius: 11px;
			-moz-border-radius: 11px;
			border-radius: 11px;
			font-size: 0.9rem;
		}
		div.row input{
			/*float: left;*/
			border: none;
			width: 100%;
			font-size: 0.9rem;
			line-height: 1.3rem;
		}
		div.row span.grayArrow{
			position: absolute;
			right: 0.5rem;
			bottom: 1.8rem;
		}
		img.promptIcon{
			position: absolute;
			top: 0.7rem;
			width: 0.9rem;
			float: left;
		}
		div.prompt{
			margin-left: 1.2rem;
			font-size: 0.8rem;
			color: #a2a2a2;
		}
		div.nextBtn{
			background-color: #f55d5d;
			text-align: center;
			font-size: 1.2rem;
			line-height: 2.6rem;
			width: 90%;
			margin: 1.2rem auto;
			border-radius: 6px;
			color: #fff;
		}
		/*修改支付信息*/
		

		/*选择车型车系*/
		
		/*选择车系*/
		
		/*选择品牌*/
		
		/*时间控件遮罩*/
		div.dwo{
			/*position: fixed!important;*/
		}
		/*选择地区*/
		article.placeWraper{
			position: fixed;
			z-index: 100;
			top: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0,0,0,0.5)!important;
		}
		div.placeSlect{
			position: absolute;
			bottom: 0;
			width: 100%;
			background-color: #fff;
		}
		div.placeCon{
			position: relative;
			padding: 1rem 0;
		}
		article.placeWraper ul li{
			line-height: 1.8rem;
			font-size: 0.95rem;
			color: #3f4968;
			text-align: center;
		}
		div.placeCon div.proCon,div.cityCon,div.areaCon{
			float: left;
			width: 33.3333%;
			height: 8rem;
			overflow: hidden;
		}
		p.surePlaceBtn{
			background-color: #f55d5d;
			color: #fff;
			font-size: 1.2rem;
			line-height: 2.625rem;
			text-align: center;
		}

		div.middleSelected{
			position: absolute;
			width: 100%;
			top: 4.1rem;
			height: 1.8rem;
			border-top: 1px solid #e4e6f1;
			border-bottom: 1px solid #e4e6f1;
		}

		div.dialog{
			position: fixed;
			top: 0;
			z-index: 500;
			height: 100%;
			width: 100%;
			background-color: rgba(0,0,0,0.5);
		}
		div.dialogWraper{
			width: 90%;
			margin: 6rem auto 0;
			background-color: #fff;
			border: 1px solid #d9d9e2;
			-webkit-border-radius: 8px;
			-moz-border-radius: 8px;
			border-radius: 8px;
		}
		p.dialogCon{
			padding: 1rem 0.6rem;
			color: #a2a2a2;
			font-size: 0.9rem;
		}
		p.dialogBtn{
			text-align: center;
			font-size: 1.2rem;
			color: #a2a2a2;
			line-height: 2.6rem;
			border-top: 1px solid #d9d9e2;
		}
	</style>
</head>
<body>
	<section id="mainPage">
		<article class="carInfo">
			<p class="carModel">loading……</p>
			<div class="carStyle">
				<span class="styleText">loading……</span>
				<span class="editStyle"><span class="editText">修改</span><span class="grayArrow"></span></span>
			</div>
			<p class="carInfoTip">精准车型电瓶匹配</p>
		</article>
		<article class="batterys">
			<ul class="ul-batterys">
				<li>loading……</li>
			</ul>
		</article>
		<article class="payInfo">
			<div class="payInfo-title">
				<span class="titleText">支付信息</span>
			</div>
			<div class="payInfo-detail">
				<div class="row clearfix">
					<span>姓名</span>
					<p class="userName"><input name="userName" type="text"></p>
				</div>
				<div class="row clearfix">
					<span>手机</span>
					<p class="userMobile"><input name="userMobile" type="text"></p>
				</div>
				<div class="row clearfix">
					<span>城市</span>
					<p style="color:#c2c2c6;" class="area"><input type="text" name="area" id="area" placeholder="请选择" readonly data-proId='' data-cityId='' data-areaId=''></p>
					<span class="grayArrow"></span>
				</div>
				<div class="row clearfix">
					<span>地址</span>
					<p style="color:#c2c2c6;" class="userAddress"><input name="userAddress" type="text"></p>
				</div>
				<div class="row clearfix">
					<span>时间</span>
					<p style="color:#c2c2c6;" class="userTime"><input name="userTime" type="text"></p>
					<span class="grayArrow"></span>
				</div>
				<div class="row clearfix">
					<span>申请加急处理</span>
					<p class="urgentTreat"><img src="./img/close_off.png" class="isRushOrder" data-id="0"></p>
					<span class="urgentTreatD">?</span>
				</div>
				<div class="row clearfix" style="border:none!important;">
					<img src="./img/promptIcon.png" class="promptIcon">
					<div class="prompt">支付成功后，客服将会在2小时内（工作时间）与您联系，确认订单信息。</p>
				</div>
			</div>
		</article>
		<article class="placeWraper" style="display:none;">
			<div class="placeSlect">
				<div class="placeCon clearfix">
					<div class="middleSelected"></div>
					<div class="proConWraper">
						<!-- <div class="proCon swiper-container">
							<ul class="proCon-ul swiper-wrapper">
							</ul>
						</div> -->
					</div>
					<div class="cityConWraper">
						<!-- <div class="cityCon swiper-container">
							<ul class="cityCon-ul swiper-wrapper">
							</ul>
						</div> -->
					</div>
					<div class="areaConWraper">
						<!-- <div class="areaCon swiper-container">
							<ul class="areaCon-ul swiper-wrapper">
							</ul>
						</div> -->
					</div>
				</div>
				<p class="surePlaceBtn">确定</p>
			</div>
		</article>
		<div class="nextBtn">下一步</div>
	</section>
	<div class="dialog" style="display:none;">
		<div class="dialogWraper">
			<p class="dialogCon">申请加急处理后，客服将在半小时内联系您，安装师傅也会尽快到达现场安装，适用于汽车无法正常启动的情况，若是上门指定时间安装，请不要选择此项。</p>
			<p class="dialogBtn">关闭</p>
		</div>
	</div>
</body>
<script type="text/javascript">
	$(function(){
		// 获取参数
		var url = window.location.search; 
	    var paramJson = {};
	    if(url!=''){
	    	var paramsArr = (url.split("?")[1]).split("&");
		    $.each(paramsArr,function(i){
		        var item = paramsArr[i].split("=");
		        paramJson[item[0]] = item[1]
		    });
	    }
		// 时间控件
		var date = new Date();
		// date.setDate(date.getDate()+1);	
		date.setHours(date.getHours()+1);
		date.setMinutes("0");
		date.setSeconds("0");
		var nowYear=date.getFullYear()+5;
		$("input[name='userTime']").mobiscroll().datetime({
	        theme: "bootstrap", 
	        mode: "clickpick",   
	        display: "modal", 
	        lang: "zh",       
	        minDate:date, 
	        dateFormat: 'yy-mm-dd', 
	        stepMinute: 60, 
	        endYear:nowYear 
	    });
	    $("input[name='userTime']").bind('click',function(){
			var dwHeight=$('div.dw').outerHeight();
			$('div.dw').css({'top':'50%','margin-top':'-'+(dwHeight/2)+'px'});
			 $(window).off("scroll")
	    });

	    $('p.userName input').val('养车宝车友');
	    // 选择地区
	    $('input#area').val('');
		$('input#area').unbind('click').bind('click',function(){
			var mySwiper2,mySwiper3;
			var preAreaId=$(this).attr('data-areaId');
			var preCityId=$(this).attr('data-cityId');
			var preProId=$(this).attr('data-proId');
			var preProIdIndex=0;
			var preCityIdIndex=0;
			var preAreaIdIndex=0;
			var isIntArea=true;
			$('article.placeWraper').show();
			$('div.proConWraper').html('<div class="proCon swiper-container"><ul class="proCon-ul swiper-wrapper"></ul></div>');
			$('div.cityConWraper').html('<div class="cityCon swiper-container"><ul class="cityCon-ul swiper-wrapper"></ul></div>');
			$('div.areaConWraper').html('<div class="areaCon swiper-container"><ul class="areaCon-ul swiper-wrapper"></ul></div>');
			$('section#mainPage').delegate('article.placeWraper','click',function(e){
				if(!(e.target.closest('div.placeSlect'))){
					$('article.placeWraper').hide()
				}
			});
			// 初始化省
			$.ajax({
				url:'/yangchebao-app-ws/ws/0.1/common/provincelist',
				type:'get',
				dataType:'json',
				contentType:'application/json;charset=utf-8',
				success:function(data){
					var proStr='';
					data.forEach(function(key,i){
						proStr+='<li class="swiper-slide" data-proId="'+key.id+'">'+key.name+'</li>'
					})
					$('ul.proCon-ul').html(proStr);
					if(preProId){
						preProIdIndex=$('li[data-proId="'+preProId+'"]').index()
					}
					// 省滚动
					var mySwiper = new Swiper('div.proConWraper .swiper-container', {
						// autoplay: 5000,
						initialSlide : preProIdIndex,
						direction : 'vertical',
						slidesPerView: 5,
						centeredSlides: true,
						mousewheelControl: true,
						onSlideChangeStart:function(swiper){
							isIntArea=true;
							nowProId=$('div.proConWraper .swiper-container li.swiper-slide-active').attr('data-proId');
							$.ajax({
								url:'/yangchebao-app-ws/ws/0.1/common/citylist?provinceId='+nowProId,
								type:'get',
								dataType:'json',
								contentType:'application/json;charset=utf-8',
								success:function(data2){
									var cityStr='';
									data2.forEach(function(key,i){
										cityStr+='<li class="swiper-slide" data-cityId="'+key.id+'">'+key.name+'</li>'
									});
									$('ul.cityCon-ul').html(cityStr);
									if(preCityId){
										preCityIdIndex=$('li[data-cityId="'+preCityId+'"]').index()
									}
									// 市滚动
									if(mySwiper2!=undefined){
										mySwiper2.destroy()
									}
									mySwiper2=new Swiper('div.cityConWraper .swiper-container', {
										initialSlide : preCityIdIndex,
										direction : 'vertical',
										slidesPerView: 5,
										centeredSlides: true,
										mousewheelControl: true,
										onSlideChangeStart:function(swiper2){
											isIntArea=false;
											nowCityId=$('div.cityConWraper .swiper-container li.swiper-slide-active').attr('data-cityId');
											$.ajax({
												url:'/yangchebao-app-ws/ws/0.1/common/arealist?cityId='+nowCityId,
												type:'get',
												dataType:'json',
												contentType:'application/json;charset=utf-8',
												success:function(data3){
													var areaStr='';
													data3.forEach(function(key,i){
														areaStr+='<li class="swiper-slide" data-areaId="'+key.id+'">'+key.name+'</li>'
													});
													$('ul.areaCon-ul').html(areaStr);
													if(preAreaId){
														preAreaIdIndex=$('li[data-areaId="'+preAreaId+'"]').index()
													}
													// 地区滚动
													if(mySwiper3!=undefined){
														mySwiper3.destroy();
													}
													mySwiper3=new Swiper('div.areaConWraper .swiper-container', {
														initialSlide : preAreaIdIndex,
														direction : 'vertical',
														slidesPerView: 5,
														centeredSlides: true,
														mousewheelControl: true,
														onSlideChangeStart:function(swiper3){}
													})
												}
											})
										}
									});
									
									if(isIntArea){
										var nowCityId=$('div.cityConWraper .swiper-container li.swiper-slide-active').attr('data-cityId');
										$.ajax({
											url:'/yangchebao-app-ws/ws/0.1/common/arealist?cityId='+nowCityId,
											type:'get',
											dataType:'json',
											contentType:'application/json;charset=utf-8',
											success:function(data3){
												var areaStr='';
												data3.forEach(function(key,i){
													areaStr+='<li class="swiper-slide" data-areaId="'+key.id+'">'+key.name+'</li>'
												});
												$('ul.areaCon-ul').html(areaStr);
												if(preAreaId){
													preAreaIdIndex=$('li[data-areaId="'+preAreaId+'"]').index()
												}
												// 地区滚动
												if(mySwiper3!=undefined){
													mySwiper3.destroy();
												}
												mySwiper3=new Swiper('div.areaConWraper .swiper-container', {
													initialSlide : preAreaIdIndex,
													direction : 'vertical',
													slidesPerView: 5,
													centeredSlides: true,
													mousewheelControl: true,
													onSlideChangeStart:function(swiper3){}
												})
											}
										})
									}
								}
							})
						}
					});
					// 初始化市
					if(preProIdIndex==0||preProIdIndex==2){
						var nowProId=$('div.proConWraper .swiper-container li.swiper-slide-active').attr('data-proId');
						$.ajax({
							url:'/yangchebao-app-ws/ws/0.1/common/citylist?provinceId='+nowProId,
							type:'get',
							dataType:'json',
							contentType:'application/json;charset=utf-8',
							success:function(data2){
								var cityStr='';
								data2.forEach(function(key,i){
									cityStr+='<li class="swiper-slide" data-cityId="'+key.id+'">'+key.name+'</li>'
								});
								$('ul.cityCon-ul').html(cityStr);
								if(preCityId){
									preCityIdIndex=$('li[data-cityId="'+preCityId+'"]').index()
								}
								// 初始化市滚动
								if(mySwiper2!=undefined){
									mySwiper2.destroy();
								}
								mySwiper2=new Swiper('div.cityConWraper .swiper-container', {
									initialSlide : preCityIdIndex,
									direction : 'vertical',
									slidesPerView: 5,
									centeredSlides: true,
									mousewheelControl: true,
									onSlideChangeStart:function(swiper2){
										nowCityId=$('div.cityConWraper .swiper-container li.swiper-slide-active').attr('data-cityId');
										$.ajax({
											url:'/yangchebao-app-ws/ws/0.1/common/arealist?cityId='+nowCityId,
											type:'get',
											dataType:'json',
											contentType:'application/json;charset=utf-8',
											success:function(data3){
												var areaStr='';
												data3.forEach(function(key,i){
													areaStr+='<li class="swiper-slide" data-areaId="'+key.id+'">'+key.name+'</li>'
												});
												$('ul.areaCon-ul').html(areaStr);
												if(preAreaId){
													preAreaIdIndex=$('li[data-areaId="'+preAreaId+'"]').index()
												}
												// 地区滚动
												if(mySwiper3!=undefined){
													mySwiper3.destroy();
												}
												mySwiper3=new Swiper('div.areaConWraper .swiper-container', {
													initialSlide : preAreaIdIndex,
													direction : 'vertical',
													slidesPerView: 5,
													centeredSlides: true,
													mousewheelControl: true,
													onSlideChangeStart:function(swiper3){}
												})
											}
										})
									}
								});
								// 初始化地区
								if(preCityIdIndex==0||preCityIdIndex==2){
									var nowCityId=$('div.cityConWraper .swiper-container li.swiper-slide-active').attr('data-cityId');
									$.ajax({
										url:'/yangchebao-app-ws/ws/0.1/common/arealist?cityId='+nowCityId,
										type:'get',
										dataType:'json',
										contentType:'application/json;charset=utf-8',
										success:function(data3){
											var areaStr='';
											data3.forEach(function(key,i){
												areaStr+='<li class="swiper-slide" data-areaId="'+key.id+'">'+key.name+'</li>'
											});
											$('ul.areaCon-ul').html(areaStr);
											if(preAreaId){
												preAreaIdIndex=$('li[data-areaId="'+preAreaId+'"]').index()
											}
											// 初始化地区滚动
											if(mySwiper3!=undefined){
												mySwiper3.destroy();
											}
											mySwiper3=new Swiper('div.areaConWraper .swiper-container', {
												initialSlide : preAreaIdIndex,
												direction : 'vertical',
												slidesPerView: 5,
												centeredSlides: true,
												mousewheelControl: true,
												onSlideChangeStart:function(swiper3){}
											})
										}
									})
								}
							}
						})
					}
				}
			});
			// 确定地区
			$('p.surePlaceBtn').unbind('click').bind('click',function(){
				var sureProId=$('ul.proCon-ul li.swiper-slide-active').attr('data-proid');
				var sureProVal=$('ul.proCon-ul li.swiper-slide-active').html();
				var sureCityId=$('ul.cityCon-ul li.swiper-slide-active').attr('data-cityid');
				var sureCityVal=$('ul.cityCon-ul li.swiper-slide-active').html();
				var sureAreaId=$('ul.areaCon-ul li.swiper-slide-active').attr('data-areaid');
				var sureAreaVal=$('ul.areaCon-ul li.swiper-slide-active').html(); 
				$('input#area').val(sureProVal+' '+sureCityVal+' '+sureAreaVal).attr({'data-proId':sureProId,'data-cityId':sureCityId,'data-areaId':sureAreaId});
				$('div.proConWraper').html('');
				$('div.cityConWraper').html('');
				$('div.areaConWraper').html('');
				$('article.placeWraper').hide()
			})
		});
		// 是否是紧急订单
		$('img.isRushOrder').unbind('click').bind('click',function(){
			var _src=$(this).attr('src');
			if(_src=="./img/close_off.png"){
				$(this).attr({'src':'./img/close_on.png','data-id':'1'})
			}else{
				$(this).attr({'src':'./img/close_off.png','data-id':'0'})
			}
		});
		$('span.urgentTreatD').unbind('click').bind('click',function(){
			$('div.dialog').show();
			$('p.dialogBtn').unbind('click').bind('click',function(){
				$('div.dialog').hide()
			})
		});
	    // 获取主车信息
		$.ajax({
			url:'/yangchebao-app-ws/ws/0.1/user/carinfo/maincar?userId='+paramJson.userId+'&'+new Date().getTime(),
			type:'get',
			async:false,
			dataType:'json',
			contentType:'application/json;charset=utf-8',
			success:function(data){
				// 获取电池
				var getBattery=function(){
					// 修改车型
					$('section#mainPage div.carStyle span.editStyle').unbind('click').bind('click',function(){
						window.location.href="selectStyle.html?userId="+paramJson.userId+'&customerId='+paramJson.customerId
					});
					// 获取电池列表
					$.ajax({
						url:'/yangchebao-app-ws/ws/0.1/battery/query?userInfoId='+paramJson.userId+'&styleId='+data.styleId,
						type:'get',
						dataType:'json',
						contentType:'application/json;charset=utf-8',
						async:false,
						success:function(dataBa){
							var batteryStr='';
							if(dataBa.batteryArray.length!=0){
								dataBa.batteryArray.forEach(function(key,i){
									batteryStr+='<li class="clearfix">'
											   +'<p class="batteryLeft"><img src="./img/batteryIcon.png"></p>'
											   +'<div class="batteryMiddle">'
											   +'<p data-name="'+key.batteryBrand+'" class="batteryName">'+key.batteryBrand+'<span class="batteryDetail">详情</span></p>'
											   +'<p>电瓶型号：<span class="batteryType">'+key.batteryModel+'</span></p>'
											   +'<p>￥<span class="batteryPrice">'+key.price+'</span></p>'
											   +'</div>'
											   +'<p class="batteryRight"><img src="./img/unselected.png"></p>'
											   +'</li>'
								});
								$('section#mainPage ul.ul-batterys').html(batteryStr);
								// battery图片垂直居中
								$('p.batteryLeft,p.batteryRight').each(function(){
									var batteryLi=$(this).closest('li').height();
									$(this).css('line-height',batteryLi+'px')
								});
								// 选择电池
								$('section#mainPage ul.ul-batterys li').unbind('click').bind('click',function(){
									var $img=$(this).find('p.batteryRight img');
									if($img.attr('src')=='./img/unselected.png'){
										$img.attr({'src':'./img/selected.png'}).closest('li').attr({'data-is':'yes'});
										$(this).siblings('li').attr({'data-is':'no'}).find('p.batteryRight img').attr({'src':'./img/unselected.png'})
									}
								});
								// 点击电池详情
								$('section#mainPage span.batteryDetail').unbind('click').bind('click',function(){
									var dataName=$(this).parent().attr('data-name');
									window.location.href="batteryDetail.html?dataName="+dataName
								})
								
							}else{
								$('section#mainPage ul.ul-batterys').html('<li style="font-size:0.9rem;text-align:center;line-height:2.2rem;">暂无匹配的电池<br/>可联系客服电话4000-77-3321线下购买</li>')
							}
						}
					})
				};
				var userMobile=data.mobile;
				// if(userMobile.length==11){
				// 	userMobile=userMobile.substring(0,3)+' '+userMobile.substring(3,7)+' '+userMobile.substring(7,11)
				// }
				// if(paramJson.contactName){
				// 	paramJson.contactName=decodeURI(decodeURI(paramJson.contactName));
				// 	paramJson.area=decodeURI(decodeURI(paramJson.area));
				// 	paramJson.detailAddress=decodeURI(decodeURI(paramJson.detailAddress));
				// 	paramJson.orderTime=decodeURI(decodeURI(paramJson.orderTime));

				// 	$('section#mainPage p.userName').html(paramJson.contactName);
				// 	$('section#mainPage p.userMobile').html(paramJson.phone);
				// 	$('section#mainPage p.userAddress').html(paramJson.area+paramJson.detailAddress).css('color','#1e1e1e').attr({'data-area':paramJson.area,'data-detail':paramJson.detailAddress,'data-proId':paramJson.userProId,'data-cityId':paramJson.userCityId,'data-areaId':paramJson.userAreaId});
				// 	$('section#mainPage p.userTime').html(paramJson.orderTime).css('color','#1e1e1e')
				// }else{
					$('section#mainPage p.userMobile input').val(userMobile);
				// }
				$('section#mainPage p.carModel').html(data.modelName);
				$('section#mainPage span.styleText').html(data.styleName).attr('data-id',data.styleId);
				getBattery()
			}
		});
		// 下单
		$('div.nextBtn').unbind('click').bind('click',function(){
			var orderdata={};
			orderdata.customerId=paramJson.customerId;
			orderdata.userInfoId=paramJson.userId;
			orderdata.styleId=$('span.styleText').attr('data-id');
			if($('li[data-is="yes"]').length!=0){
				orderdata.batteryArray=[];
				$('li[data-is="yes"]').each(function(){
					var batteryJson={};
					batteryJson.batteryBrand=$(this).find('p.batteryName').attr('data-name');
					batteryJson.batteryModel=$(this).find('span.batteryType').html();
					batteryJson.price=$(this).find('span.batteryPrice').html();
					orderdata.batteryArray.push(batteryJson)
				})
			}else{
				errorLog('请选择电池');
				return false
			};

			if($.trim($('p.userName input').val())!=''){
				orderdata.userName=$.trim($('p.userName input').val())
			}else{
				errorLog('请编辑姓名');
				return false
			}

			if($.trim($('p.userMobile input').val())!=''){
				orderdata.userMobile=$.trim($('p.userMobile input').val())
			}else{
				errorLog('请编辑手机');
				return false
			}

			if(($.trim($('input#area').val()))!=''){
				var names=$('section#mainPage p.area input').val().split(' ');
				orderdata.provinceId=$('section#mainPage p.area input').attr('data-proId');
				orderdata.provinceName=names[0];
				orderdata.cityId=$('section#mainPage p.area input').attr('data-cityId');
				orderdata.cityName=names[1];
				orderdata.areaId=$('section#mainPage p.area input').attr('data-areaId');
				orderdata.areaName=names[2];
				
			}else{
				errorLog('请编辑城市');
				return false
			}

			if(($.trim($('p.userAddress input').val()))!=''){
				orderdata.address=$.trim($('section#mainPage p.userAddress input').val())
			}else{
				errorLog('请编辑地址');
				return false
			}

			if(($.trim($('p.userTime input').val()))!=''){
				orderdata.reserveDate=$('p.userTime input').val();
			}else{
				errorLog('请编辑预定时间');
				return false
			}
			orderdata.isRushOrder=$('img.isRushOrder').attr('data-id');
			orderdata.cooperateCompanyNo=store.get('companyNo');
			$.ajax({
				url:'/yangchebao-app-ws/ws/0.1/battery/order',
				type:'post',
				data:$.toJSON(orderdata),
				async:false,
				dataType:'json',
				contentType:'application/json;charset=utf-8',
				success:function(data){
					window.location.href='pay.html?sourceId='+data.sourceId+'&orderChannel='+data.orderChannel+'&userName='+orderdata.userName+'&userMobile='+orderdata.userMobile+'&batteryBrand='+orderdata.batteryArray[0].batteryBrand+'&batteryModel='+orderdata.batteryArray[0].batteryModel+'&batteryPrice='+orderdata.batteryArray[0].price+'&address='+$('section#mainPage input#area').val()+orderdata.address+'&orderNumber='+data.orderNumber+'&customerId='+paramJson.customerId
				}
			})
		})
	});
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?659dcb1e08dcea0e0c9a219b1b4d0af7";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
</script>
</html>
