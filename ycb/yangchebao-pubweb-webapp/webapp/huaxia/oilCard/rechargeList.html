<!DOCTYPE html>
<html>
<head> 
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" name="viewport" />
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="format-detection" content="telephone=no" />
<script src="../../js/jquery-1.9.1.min.js"></script>
<script src="../../js/jquery.json-2.2.js"></script>   
<script src="js/index.js"></script>   
<link type="text/css" href="css/index.css" rel="stylesheet"/>
<title>充值记录</title>
</head>
<style type="text/css">  
  
.more {
    background-image: url("images/arrow.png");
    background-position: right center;
    background-repeat: no-repeat;
    background-size: 10px auto;
    color: #6eaade;
    float: right;
    font-size: 1.5em;
    height: 40px;
    line-height: 40px;
    padding-right: 12px;
}
.reList h1 + .more {
    margin: -2.8em 0.8em 0 0;
} 
/**查看更多**/
.tip {
    color: #a0a097;
    font-size: 1.5em;
    padding: 10px;
    text-align: center;
    display: none;
    cursor:pointer;
}
/**查询结果空**/
.null-tip::before {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-right: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip::after {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-left: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip {
    color: #cfd1db;
    font-size: 1.8em;
    margin-top: 2.78em;
    text-align: center;
    display: none;
}
 
header{ 
  height: auto;
  overflow: auto;
  background-color: #fff;
  margin-bottom: 1rem;
}
header span{
  display: inline-block;
  float: left;
  width: 24%;
  text-align: center;
  height: 4rem;
  line-height: 4rem;
  margin-left:7%;
  box-sizing:border-box;
  font-size: 1.4rem;
} 
header .current{
  border-bottom: 2px solid #f55d5d;
}
.reList{
  padding: 0 1rem;
}
.reList li{
  border: 1px solid #D9D9E2; 
  background-color: #fff; 
  margin-bottom: 1rem;
}
.reList h1{
  font-weight: normal;
  font-size: 1.5rem;
  height: 3rem;
  line-height: 3rem;
  border-bottom: 1px solid #d9d9e2;
  padding: 0 1rem;
} 
.reList .content{
  font-size: 1.3rem;
  line-height: 150%;
  padding: 1.5rem 1rem;
}
.reList .info{
  font-size: 1.5rem;
  height: 4.4rem;
  line-height: 4.4rem;
  padding: 0 1rem; 
  border-top: 1px solid #D9D9E2;
}
.reList .info span{
  display: inline-block;
  float: right;
}
.reList .info .btn{
  color: #fff;
  width: 8.8rem;
  text-align: center;
  background-color: #f55d5d;
  margin-left: 2rem;
}
.org{
  color: #f55d5d;
} 
</style>
<body>
  <header>
    <span class="current" type="-1">全部</span>
    <span type="0">待支付</span>
    <span type="2">交易成功</span>
  </header> 
  <ul class="reList">
  <!--   <li>
        <h1>订单号：454859883028039583</h1> 
        <span class="more"></span>
        <div class="content"> 
            <p>中国石化加油卡充值1000元</p>
            <p>油卡类型：中国石化</p>
            <p>加油卡号：8349667349867349764369</p>
            <p>充值日期：2014-09-14  10:31:48 </p> 
        </div>
        <p class="info">金额：990.0元<span class="org">充值失败</span></p>
    </li> -->  
   <!--  <li>
        <h1>订单号：454859883028039583</h1> 
        <span class="more"></span>
        <div class="content"> 
            <p>中国石化加油卡充值1000元</p>
            <p>油卡类型：中国石化</p>
            <p>加油卡号：8349667349867349764369</p>
            <p>充值日期：2014-09-14  10:31:48 </p> 
        </div>
        <p class="info">金额：990.0元
        <span class="btn">付款</span><span class="org">取消</span>
        </p>
    </li> -->  
  </ul>
<div class="null-wrap">
  <img src="css/images/null.png"/>
  <p>您还没有充值记录哦～</p>
</div>   
<p class="tip">点击查看更多</p>  
<script type="text/javascript">
var paramJson = {};
var pageindex = 0;
var status = -1;
$(document).ready(function(){   
    var url =window.location.search;   
    if(url!=undefined&&url!=""){
    var paramsArr = (url.split("?")[1]).split("&"); 
    $.each(paramsArr,function(i){
     var item = paramsArr[i].split("=");
     paramJson[item[0]] = item[1];
    });    
    } 
    $("header span").click(function(){
       $("header span").removeClass("current");
       $(this).addClass("current");
       $(".reList").html("");
       pageindex=0;
       status = $(this).attr("type");
       getList(); 
    });
    $(".tip").click(function(){
       getList();
    }); 
    $(".reList").on("click","li",function(){
      var orderId = $(this).attr("oid");
      window.location.href = "rechargeDetail.html"+window.location.search+"&orderId="+orderId;
    }); 
    getList();  
});
 function getList(){   
    $.ajax({
        url: '/yangchebao-app-ws/ws/0.1/oilcard/order/page?customerId='+paramJson.customerId+'&orderStatus='+status+'&pagesize=10&pageindex='+pageindex+'&'+(new Date()).getTime(),
        contentType: "application/json;charset=utf-8",
        dataType: "json",
        type: "get",
        success: function(data) {
          if(data.totalCount>0){ 
		     $(".null-wrap").hide();
             if((data.page+1)<data.totalPages){
                $(".tip").show();
              } else{
                $(".tip").hide();
              } 
              pageindex++;    
              var items = data.items; 
              $.each(items,function(i){
                var item  = items[i]; 
                var span = "";
                if(item.orderStatus==3||item.orderStatus==1){
                  span = '<span class="org">'+item.orderStatusName+'</span>';
                // }else if(item.orderStatus==0){
                //   span = '<span class="btn">付款</span><span class="org">取消</span>';
                }else{
                  span = '<span>'+item.orderStatusName+'</span>';
                }
                var _li = '<li oid="'+item.orderId+'">'
                    +'<h1>订单号：'+item.orderNumber+'</h1> ' 
                    +'<div class="content"> '
                    +'<p>'+item.goodsDesc+'</p>'
                    +'<p>油卡类型：'+item.oilCardInfo.cardTypeDesc+'</p>'
                    +'<p>加油卡号：'+item.oilCardInfo.cardNo+'</p>'
                    +'<p>充值日期：'+(item.rechargeDate||"")+'</p> '
                    +'</div>'
                    +'<p class="info">金额：'+item.orderAmount+'元'+span+'</p>'
                    +'</li>';  
                    $(".reList").append(_li);
                  });
                }else{
                    $(".null-wrap").show();
                }
        },error: function(xhr) {
         var mes = eval('('+xhr.responseText+')'); 
         alertTasat(mes[0].message);
    }
    });
  }
</script>
</body>
</html>