<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes" />
	<meta content="yes" name="apple-mobile-web-app-capable"/>
	<meta content="black" name="apple-mobile-web-app-status-bar-style"/> 
	<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js "></script> 
    <script src="http://app.yangchebao.com.cn/group1/M00/00/9F/md50000000000000000000000000000.js"></script>
    <link rel="stylesheet" href="css/commen.css">
    <script src="js/commen.js"></script>
	<title>支付结果</title>
	<style>
		*{
			margin: 0;
			padding: 0;
			list-style: none;
		}
		body{
			background-color: #f4f7f8;
			font-size: 62.5%;
			font-family: 'Hiragino Sans GB',Helvetica,Arial,sans-serif;
			color: #1e1e1e;
		}
		img{
			border: none;
			vertical-align: middle;
		}
		a{
			text-decoration: none;
			outline:none;
			blr:expression(this.onFocus=this.blur());
		}

		div.container{
			position: relative;
			min-width: 320px;
			max-width: 640px;
			margin: 0 auto;
			background-color: #F4F7F8;
		}
		div.goIndexWraper{
			background-color: #F4F7F8;
			padding: 0.6rem 1.2rem;
			border-bottom: 1px solid #DCDCE4;
			text-align: right;
		}
		div.goIndexWraper a{
			color: #6eaade;
			font-size: 1rem;
		}
		article.paySuc{
			background-color: #fff;
			padding: 1.6rem 1.2rem;
		}
		h2.paySucText{
			color: #6eaade;
			font-size: 1.3rem;
			padding-bottom: 1rem;
		}
		article.paySuc p.tip{
			color: #1e1e1e;
			font-size: 1rem;
			line-height: 1.2rem;
			padding: 0.6rem 0;
		}
		div.personInfo{
			padding: 1rem 0;
		}
		div.personInfo p{
			color: #a2a2a2;
			font-size: 1rem;
			line-height: 1.2rem;
		}
		div.personInfo p span{
			color: #a2a2a2;
			font-size: 1rem;
		}
		div.realPriceWraper{
			background-color: #F4F7F8;
			padding-bottom: 8rem;
		}
		div.realPriceWraper p{
			padding: 0 1.2rem;
			line-height: 3rem;
			color: #fff;
			background-color: #6EAADE;
			text-align: right;
			font-size: 1.2rem;
		}
		div.realPriceWraper p span{
			color: #fff;
			font-size: 1.2rem;
		}


		/*fail*/
		section.failSection{
			background-color: #F2F3F4;
		}
		section.failSection article{
			background-color: #fff;
		}
		div.buyNum{
			background-color: #F2F3F4;
			line-height: 2.6rem;
			border-bottom: 1px solid #DCDCE4;
			padding: 0 1rem;
			text-align: right;
		}
		div.buyNum a{
			color: #6eaade;
			font-size: 0.9rem;
		}
		div.article-top-safe{
			padding: 1.2rem;
		}
		div.article-top-safe h2{
			color: #6eaade;
			font-size: 1.3rem;
			padding: 1rem 0;
		}
		div.article-top-safe p{
			color: #1e1e1e;
			font-size: 1rem;
		}
		article.article-middle{
			padding: 0 1.2rem;
			border-bottom: 1px solid #DCDCE4;
		}
		ul.article-middle-ul li{
			overflow: hidden;
			padding: 1rem 0;
			border-top: 1px solid #DCDCE4;
		}
		ul.article-middle-ul li p.li-pLeft{
			float: left;
		}
		ul.article-middle-ul li p.li-pRight{
			float: right;
			text-align: right;
		}
		span.safe{
			color: #1e1e1e;
			font-size: 1rem;
			padding-bottom: 0.2rem;
		}
		span.safeNumber{
			color: #999;
			font-size: 0.9rem;
		}
		a.toCheckOrder{
			color: #6eaade;
			font-size: 0.9rem;
		}
		article.article-charge{
			overflow: hidden;
			padding-left: 1rem;
			margin-top: 1rem;
			border-top: 1px solid #DCDCE4;
		}
		article.article-charge p.priceAll{
			float: left;
			line-height: 3.2rem;
		}
		article.article-charge p.priceAll span.priceAll-text{
			font-size: 1rem;
			color: #666;
		}
		article.article-charge p.priceAll span.priceAll-detail{
			font-size: 1rem;
			color: #fb4f2c;
		}
		article.article-charge p.chargeBtn{
			float: right;
			line-height: 3.2rem;
			color: #fff;
			font-size: 1.2rem;
			text-align: center;
			background-color: #fb4f2c;
			padding: 0 1.8rem;
			cursor: pointer;
		}
		/*倒计时*/
		section.timeSection p,section.waitSection p{
			margin-top: 100px;
			text-align: center;
			color: #a2a2a2;
			font-size: 1rem;
			line-height: 1.5rem;
		}
		section.timeSection p span,section.waitSection p a{
			margin-top: 100px;
			text-align: center;
			color: #fb4f2c;
			font-size: 1rem;
			line-height: 1.5rem;
		}
		div.checkOrderInfo{
			padding: 0 1rem 1rem;
			border-bottom: 1px solid #DCDCE4;
		}
		div.checkOrderInfo p{
			background-color: #6eaade;
			color: #fff;
			font-size: 1rem;
			width: 40%;
			line-height: 2rem;
			-webkit-border-radius: 4px;
			-moz-border-radius: 4px;
			border-radius: 4px;
			text-align: center;
			cursor:pointer;
		}
	</style>
</head>
<body>
	<div class="container">
		<section class="successSection" style="display:none;">
			<div class="goIndexWraper">
				<a href="http://w2l?closeActivity" class="goIndex">返回首页</a>
			</div>
			<article class="paySuc">
				<h2 class="paySucText">支付成功！</h2>
				<p class="tip">请等待保险公司承保，保险公司将会在10分钟内将承保结果通过短信通知您！请耐心等待！可在个人中心-我的保单中查看保单状态，承保成功保单会以快递的方式邮寄给您。</p>
				<div class="personInfo">
					<p>收货人：<span class="name">王小华</span> <span class="phone">13800138000</span></p>
					<p>配送地址：<span class="address">广东省广州市越秀区水印路52号大院</span></p>
				</div>
			</article>
			<div class="realPriceWraper">
				<p class="realPriceP">实付款：<span class="realPrice">￥4686.79</span></p>
			</div>
		</section>
		<section class="failSection" style="display:none;">
			<article class="article-top">
				<div class="buyNum">
					<a href="http://w2l?closeActivity">返回首页</a>
				</div>
				<div class="article-top-safe">
					<h2>支付未完成！保单无法生效</h2>
					<p>请重新提交支付，请在订单有效期内完成支付。</p>
				</div>
				<div class="checkOrderInfo"><p class="checkOrderInfo-btn">查看保单信息</p></div>
			</article>
			<article class="article-middle">
				<ul class="article-middle-ul">
					<li class="article-middle-li">
						<p class="li-pLeft"><span class="safe safeText">商业险</span><br /><span class="safeNumber">投保单号：<span name="busiInsureNum">2344567789995</span></span></p>
						<p class="li-pRight"><span class="safe safePrice">¥ <span name="busiInsureCharge">3500.00</span></span></p>
					</li>
					<li class="article-middle-li">
						<p class="li-pLeft"><span class="safe safeText">加强险</span><br /><span class="safeNumber">投保单号：<span name="vehicleInsureNum">2344567789995</span></span></p>
						<p class="li-pRight"><span class="safe safePrice">¥ <span name="vehicleInsureCharge">3500.00</span></span></p>
					</li>
					<li class="article-middle-li">
						<p class="li-pLeft"><span class="safe safeText">车船税</span></p>
						<p class="li-pRight"><span class="safe safePrice">¥ <span name="taxInsureCharge">3500.00</span></span></p>
					</li>
				</ul>
			</article>
			<article class="article-charge">
				<p class="priceAll"><span class="priceAll-text">合计费用：</span><span class="priceAll-detail">￥<span name="totalCharge">4810.00</span></span></p>
				<p class="chargeBtn">立即支付</p>
			</article>
		</section>
		<section class="timeSection">
			<p>正在跳转回养车宝，请耐心等待，<br /> <span class="waitTime">10</span> 秒······</p>
		</section>
		<section class="waitSection" style="display:none;">
			<p>承保正在处理中，稍后请到<br /> <a class="toMySafeOrder" href="javascript:">我的保险订单</a> 中查看！</p>
		</section>
	</div>
</body>
<script type="text/javascript">
	$(function(){
		// 获取参数
		var url = window.location.search; 
	    var paramJson = {};
	    if(url!=''){
	    	var paramsArr = (url.split("?")[1]).split("&");
		    $.each(paramsArr,function(i){
		        var item = paramsArr[i].split("=");
		        paramJson[item[0]] = item[1]
		    });
	    }
	    var waiter=10;
	    var checkTime=function (){
	    	if(waiter==0){
	    		clearInterval(autoTimer);
	    		$.ajax({
			    	url:'/yangchebao-app-ws/ws/0.1/insure/pay/result?customerId='+paramJson.customerId+'&sqid='+paramJson.sqid+'&'+new Date().getTime(),
			    	type:'get',
			    	dataType:'json',
			    	contentType:'application/json;charset=utf-8',
			    	success:function(data){
			    		if(data.status=='1'){
			    			$('title').html('支付成功');
			    			$('section').hide();
			    			$('section.successSection').show();
			    			$('span.name').html(data.deliveryName);
			    			$('span.phone').html(data.deliveryMobile);
			    			$('span.address').html(data.deliveryAddress);
			    			$('span.realPrice').html('￥'+data.charge)
			    		}else if(data.status=='2'){
			    			$('section').hide();
			    			$('title').html('支付失败');
			    			$('section.failSection').show();
			    			$.each(data,function(key,val){
			    				if($('section.successSection span[name="'+key+'"]')){
			    					$('section.successSection span[name="'+key+'"]').html(val)
			    				}
			    			});
			    			$('p.chargeBtn').unbind('click').bind('click',function(){
			    				window.location.href=data.payUrl
			    			});
			    			// 查看保单信息
						    $('p.checkOrderInfo-btn').unbind('click').bind('click',function(){
						    	window.location.href="/yangchebao-pubweb/baoxian/orderDetail.html?sqid="+paramJson.sqid+"&customerId="+paramJson.customerId+'&orderStatus=0&payUrl='+data.payUrl
						    })
			    		}else if(data.status=='0'){
			    			$('title').html('承保处理中');
			    			$('section').hide();
			    			$('section.waitSection').show();
			    			$('a.toMySafeOrder').attr('href','/yangchebao-pubweb/baoxian/mySafeOrder.html?customerId='+paramJson.customerId)
			    		}
			    	},
			    	error:function(xhr){
			    		var error=eval('('+xhr.responseText+')');
			    		alert(error[0].message)
			    	}
			    });
				return false
			}else{
	    		waiter--;
				$('span.waitTime').html(waiter)
			}
	    };
	    var autoTimer=setInterval(checkTime,1000);
	    
	})
</script>
</html>