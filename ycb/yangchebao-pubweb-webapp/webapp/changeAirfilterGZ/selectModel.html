<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,heihgt=device-height,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="format-detection" content="telephone=no" />
	<title>选择品牌</title>
	<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js "></script> 
	<link rel="stylesheet" href="./css/main.css">
	<script src="./js/commen.js"></script>
	<style>
		section#selectStyle article{
			background-color: #fff;
			margin-top: 1.3rem;
		}
		
		section#selectStyle article.two{
			border-top: 1px solid #D9D9E2;
		}
		div.theStyleRow,div.theModelRow{
			position: relative;
			border-bottom: 1px solid #D9D9E2;
			line-height: 4.5rem;
			padding: 0rem 1.6rem;
		}
		div.theStyleRow p,div.theModelRow p{
			color: #595c5c;
			font-size: 1.6rem;
		}
		div.theStyleRow img,div.theModelRow img{
			position: absolute;
			top: 1.3rem;
			right: 2rem;
			width: 2rem;
		}
		.loadMore{
			background-color: #f4f7f8;
			text-align: center;
			line-height: 4rem;
			border-top: 1px solid #D9D9E2;
			color: #a2a2a2;
			font-size: 1.6rem;
		}
	</style>
</head>
<body>
	<section id="selectStyle">
		<article class="two">
		</article>
	</section>
</body>
<script type="text/javascript">
	$(function(){
		// 获取参数
		var url = window.location.search; 
	    var paramJson = {};
	    if(url!=''){
	    	var paramsArr = (url.split("?")[1]).split("&");
		    $.each(paramsArr,function(i){
		        var item = paramsArr[i].split("=");
		        paramJson[item[0]] = item[1]
		    });
	    }
	     // 选择品牌
	    var getModel=function(modelRowId){
			$.ajax({
				url:'/yangchebao-app-ws/ws/0.1/marketactive/pageExternalModel?areaType=2',
				type:'get',
				dataType:'json',
				contentType:'application/json;charset=utf-8',
				async:false,
				success:function(data){
					// 获取列表
					var modelStr='';
					data.forEach(function(key,i){
						modelStr+='<div id="'+key.externalModelId+'" class="theModelRow">'
								 +'<p>'+key.externalModelName+'</p>'
								 +'</div>'
					});
					// 初始化列表
					$('section#selectStyle article.two').append(modelStr);
					// if($('section#selectStyle div.loadMore')){
					// 	$('section#selectStyle div.loadMore').remove()
					// }
					// // 加载更多
					// var modelLen=$('section#selectStyle div.theModelRow').length;
					// if(modelLen<data.totalCount){
					// 	$('section#selectStyle article.two').append('<div class="loadMore">加载更多</div>');
					// 	$('div.loadMore').unbind('click').bind('click',function(){
					// 		getModel(page+1)
					// 	})
					// }
					// 原始信息
					if(modelRowId){
						$('section#selectStyle article.two div.theModelRow[id="'+modelRowId+'"]').append('<img src="./img/check_icon.png">')
					}
					// 更新信息
					$('div.theModelRow').unbind('click').bind('click',function(){
						var theModelRowId=$(this).attr('id');
						var theModelRowName=$(this).find('p').html();
						window.location.href='model.html?theModelRowId='+theModelRowId+'&theModelRowName='+theModelRowName
					})
				}
			})
		};
		getModel(paramJson.modelRowId)
	})
</script>
</html>