<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
<meta name="format-detection" content="telephone=no" />
<script src="../js/jquery-1.9.1.min.js"></script> 
<script src="http://app.yangchebao.com.cn/group1/M00/00/9F/swiper.3.1.2.jquery.min.0000000.js"></script> 
<script src="js/index.js"></script> 
<script src="js/commen.js"></script> 
<link rel="stylesheet" href="./css/calender.css">
<link rel="stylesheet" href="http://app.yangchebao.com.cn/group1/M00/00/9F/swiper.min.0000000000000000000.css"> 
<title>排行榜和奖品</title>
<style type="text/css">
*{
	margin: 0;
	padding: 0;
	-webkit-tap-highlight-color:rgba(0,0,0,0);
}
html{
	font-size:62.5%;
}
body{
	background-color: #F4F7F8;
	font-family:'华文细黑','HelveticaNeue-Light'; 
	color:#1e1e1e;
	-webkit-box-sizing:border-box;
	box-sizing:border-box;
}
body,html{
	min-height:100%;
}
ol{
	list-style: none;
}
img{
	border:none;
}
.clearfix {
   *zoom: 1;
}
.clearfix:before,
.clearfix:after {
   display: table;
   line-height: 0;
   content: "";
}
.clearfix:after {
  clear: both;
} 
a{
	text-decoration: none;
} 
ul,ol{
	list-style: none;
}
.tabs{
	padding: 1.5rem 2rem;
	height: 3.4rem;
	line-height: 3.4rem;
	text-align: center;
	font-size: 1.4rem;
}
.tabs span{
	display: block;
	width: 50%;
	float: left;
	box-sizing:border-box;
}

.tabs span{ 
	color:#FB451F;
	background-color: #fff;
	border:1px solid #FB451F; 
}
.tabs span.current{ 
	color:#FFFFFF;
	background-color: #FB451F; 
}
.tabs .ltab{  
	border-radius: 18px 0 0 18px;
}
.tabs .ftab{  
	border-radius: 0 18px 18px 0;
} 
.title{
	font-size:1.2rem;
	color:#A2A2A2; 
	text-align:center;
	padding: 0.5rem 0;
} 
.glist{
	display: table;
	width: 100%;
	background-color: #fff;
}
.glist li{
	display: table-row;  
}
.glist li>div{
	display: table-cell;
	vertical-align: middle; 
	text-align: center;
	border-bottom:1px solid #C2C2C6; 
	padding:2rem 0; 
}
.glist li>div:first-child{ 
	text-align: left;
	padding-left: 1.5rem;
	position: relative;
} 
.glist li>div:last-child{ 
	padding-right: 1.5rem; 
} 
.glist .info{
	font-size: 1.5rem;
}
.glist label{
	font-size: 1.2rem; 
    color:#C2C2C6; 
    display: block;
} 
.glist li>div:first-child label{
	padding-left: 30px; 
} 
.glist img{
	left: 135px;
    position: absolute;
    top: 1.8rem;
    width: 1.7rem;
} 
.idx {
    display: inline-block;
    width: 30px;
}
.date-wrap{
	background-color: #fff;
	text-align: center; 
	padding: 1.8rem 0 0; 
	margin-bottom: 1rem;
}
.date-wrap h1{ 
	color:#6EAADE; 
	font-weight: normal;
	font-size:1.4rem;
	border-bottom: 1px solid #6EAADE; 
	padding-bottom: 1.1rem; 
	position: relative;  
}
.date-wrap h2{
	font-size:10vw;   
	font-weight: normal;
	color: #FF6138;
	margin-top: 1.1rem;
} 
.date-wrap h3{
	font-size:1.4rem;   
	font-weight: normal;
	padding-bottom:1.8rem;
	border-bottom: 1px solid #c2c2c6;
} 
.arrow
{  
  display:block;  
  height:0px;  
  width:0px;  
  position:absolute;  
  font-size:0;   
  top:6px;    /* 它的绝对值加上span的边框宽度等于div边框宽度的5倍 */  
  left:50%;   /* 它来确定尖角的位置 */  
  margin-left: 90px;
  border-top:0px;  
  border-top:6px solid #6EAADE;  /* 注意颜色的变化 */  
  border-right:6px solid white;  
  border-left:6px solid white;  
} 
.hlist{
	 border-bottom: 1px solid #c2c2c6;
	 background-color: #fff;
	 margin-bottom: 1rem;
	 font-size:1.2rem;  
	 padding: 2rem 1.5rem 1.5rem;
	 margin-bottom:5.4rem;
}
.hlist h1{ 
	font-weight: normal;
	font-size: 1.2rem;
	border-bottom: 1px solid #c2c2c6;
	padding: 0.7rem 0 0.7rem 2rem;
	margin-bottom: 2rem;
	background-image: url(images/dicon.png);
	background-size: 1.5rem auto;
	background-repeat: no-repeat;
	background-position: left 0.7rem;  
}
.hlist p{  
	line-height: 150%;
}
.hlist p span{  
	color:#FF6138;  
}
.hlist p strong{  
	font-weight: normal;
	font-size: 1.4rem;
}
.dateHtml{
    position:absolute;
	width:100%;
	left:0;
	display:none;
	z-index:200;
	background-color:#fff;
}
.bottom-btn{
    height:4.4rem;
	text-align:center;
	color:#fff;
	width:100%;
	display:block;
	position:fixed;
	bottom:0;
	background-color:#FF6138;
	line-height:4.4rem;
	font-size:1.6rem;
}
header{
	font-size: 1.2rem; 
	padding: 0 3rem; 
	border-bottom:1px solid #d9d9e2;
	margin-bottom: 1rem;
	background-color: #fff;
}
header .box-wrap{ 
	border-bottom:1px solid #C2C2C6; 
	height: auto;
	overflow: auto; 
	padding: 3rem 0 2rem; 
}
header .left{
	float: left;
	width: 13rem; 
}
header .left img{
	display: block;
	width: 10.5rem;
	margin-left: 0.5rem;
}
header .right{
	margin-left: 7.6rem;
	padding-top: 0.9rem;
} 
header .right h1{ 
	font-size:1.8rem;
	color:#FF6138; 
	font-weight: normal;
} 
header h2{  
	font-size:1.5rem; 
	text-align:center;
	font-weight: normal;
	padding: 1.4rem 0;
} 
header .btn-wrap{  
	font-size:1.5rem; 
	text-align:center;
	font-weight: normal;
	padding: 0 1.1rem 2rem;
	height: auto;
	overflow: auto; 
} 
header .two-btn>div{  
	 width: 50%;
	 float: left;
}
header .btn-wrap a{  
	font-size:1.4rem;
	color:#FF6138;
	line-height:3rem;
	text-align:center;
	display: block;
	height: 3rem;
	border: 1px solid #FF6138;
	border-radius: 3px;
} 
header .two-btn .lbtn{  
	margin-right: 1rem;
} 
header .two-btn .rbtn{  
	margin-left: 1rem;
}
.date-wrap .secondDate{
	padding-top:1.1rem;
	margin:0;
}
.date-wrap2 .arrow{
	margin-left:90px;
	top:1.6rem;
}
.date-wrap2{
	/**background-color:#F4F7F8; **/
	border:none;
	padding:0;
}

.null-tip::before {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-right: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip::after {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-left: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip {
    color: #cfd1db;
    display: none;
    font-size: 1.5rem;
    margin-top: 4rem;
    text-align: center;
} 
.tip {
    color: #a0a097;
    cursor: pointer;
    display: none;
    font-size: 1.5em;
    padding: 10px;
    text-align: center;
}
/**错误提示**/
.tasat-wrap{
   position: fixed;
   text-align: center;
   bottom: 50%;
   width: 100%; 
}
.tasat {
	background-color: #000;
	border-radius: 8px;
	color: #fff;
	display: inline-block;
	font-size: 14px;
	margin: 0 20px;
	opacity: 0.8;
	padding: 10px;
}   
.hasData {
    background-color: #fff;
    border-radius: 100%;
    color: #a2a2a2 !important;
    padding: 0 8.5px;
} 
.gradWrap{
	background-color: #fff;
	border-bottom: 1px solid #d9d9e2;
	margin-bottom:1rem;
	display:none;
} 
.orgLabel {
    padding: 2.5rem 0 0.8rem;
    text-align: center; 
    font-size:1.5rem; 
    border-bottom: 1px solid #ffb19c;
    color: #ff6138;
    font-size: 1.5rem;
    padding-bottom: 0.5rem; 
	margin:0 1.5rem 1rem;
} 
.gradWrap .txt{
	font-size: 1.2rem;
    text-align: center; 
}
.button-wrap{
    width:69%;
	margin:auto;
	padding:2rem 0;
}
.button {
    border: 2px solid #ff6138;
    border-radius: 3px;
    color: #ff6138;
    display:block;
    font-size: 1.5rem;
    padding: 1rem 1.3rem;
    text-align: center;
    text-decoration: none;
}
.swiper-container {
    width: 100%;
    height: auto;
    margin: 1.5rem 0 0;  
}
.swiper-slide{
	height: auto;
	width: 62.5%; 
	margin:0 auto;
}
.swiper-slide img{
	width: 100%;
	display: block;
	border-right:2px solid #fff;
	border-left:2px solid #fff;
	position: relative;
}
.swiper-slide>div{
	 position: absolute;
	 width: 100%;
	 text-align: center;
	 top: 20%;
	 left: 0; 
}
.swiper-slide .name{
	 font-size: 5vw;
	 color: #fff;
}
.swiper-slide .price{
	font-size: 7vw; 
	color:#F8E71C; 
	font-weight:700;
} 
.swiper-slide .useDate{
	font-size: 3vw;  
	color: #fff;
} 
</style>
<body> 
	<p><input name="eventId" type="hidden" value="FileDrivingRewardPage"></p>
	<p><input name="rightNavBtnInfo" type="hidden" value="奖励说明" /> 
	<input name="rightNavBtnInfo" type="hidden" value="http://app.yangchebao.com.cn/yangchebao-pubweb/archives/comment.html" /> 
	<input name="rightNavBtnInfo" type="hidden" value="0" /></p>
	<article class="gradWrap boxEntrance">
    	<p class="orgLabel">安装乐乘盒子，根据驾驶积分得奖励</p>
    	<p class="txt">昨日有<span class="drivingCnt">-</span>名车主获得驾驶奖励</p> 
    	<div id="lechengLink" class="button-wrap"><a href="javascript:void(0);" class="button">获得安防神器</a></div>
    </article>
	<article class="gradWrap noGift">
    	<p class="orgLabel">昨日排名  <span class="sequence">500+</span></p>
    	<p class="txt">击败<span id="beatUserPer">91</span>%得用户</p> 
    	<div class="button-wrap"><a href="javascript:void(0);" class="button toHistory">查看历史奖励</a></div>
    </article>
	<article class="gradWrap noDrive">
    	<p class="orgLabel">昨日停驶</p>
    	<p class="txt">昨日有<span class="drivingCnt">-</span>名车主获得驾驶奖励</p> 
    	<div class="button-wrap"><a href="javascript:void(0);" class="button toHistory">查看历史奖励</a></div>
    </article>
	<article class="gradWrap driveGift">
    	<p class="orgLabel">昨日排名  <span class="sequence">500+</span></p>
    	<div class="swiper-container">
	      	<div class="swiper-wrapper"> 
	            <!--div class="swiper-slide">
	            	<img src="images/bg.png">
	            	<div>
	            		<p class="name">免费洗车一次</p>
	            		<p class="price">¥ 35.00</p>
	            		<p class="useDate">使用期限：2015.11.06 - 2015.11.21</p>
	            	</div>
	            </div-->
	        </div> 
	    </div>
    	<div class="button-wrap"><a href="javascript:void(0);" class="button toHistory">查看历史奖励</a></div>
    </article>
	<section class="glist-wrap">
		<article class="date-wrap">
			<h1 class="date">车主排名&nbsp;&nbsp;<label>2014年10月27日</label><span class="arrow"></span></h1> 
			<div class="dateHtml">
				<article class="calender-top">
					<div class="dateWraper">
						<span class="arrowL Arrow" style="color: #fff;">1</span>
						<span class="theDate"><span class="year"></span>年<span class="month"></span>月</span>
						<span class="arrowR Arrow" style="color: #fff;">1</span>
					</div>
				</article>
				<article class="calender-bottom">
					<table class="Table-date" border="0" cellpadding="0" cellspacing="0">
						<thead>
							<tr>
								<th>日</th>
								<th>一</th>
								<th>二</th>
								<th>三</th>
								<th>四</th>
								<th>五</th>
								<th>六</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</article>
			</div>
			<h2 class="gradeNum myGrade" style="display:none;">--</h2>
			<h3 class="gradeLabel myGrade" style="display:none;">我的排名</h3>
		</article>  
		<ul class="glist">
		<!-- 	<li>
				<div>
					<p class="info"><span class="idx">1.</span><span class="phone">130****5083</span></p>
					<label>奥迪A3</label>
					<img src="images/flower.png"/>
				</div> 
				<div>
					<p class="info">89</p>
					<label>驾驶平均分</label>
				</div>
				<div>
					<p class="info">672</p>
					<label>行驶里程</label>
				</div> 
			</li>  -->
		</ul>
		<p class="glist-null null-tip">排行榜暂时无数据</p>
		<p class="tip gtip">点击查看更多</p>  
	</section> 
	<p style="height: 10px;margin: 20px 0px;font-size: 13px;text-align:center;color:#666;display:none;" id="iosInfo">本次活动与Apple Inc.无关</p>
<script type="text/javascript"> 
var paramJson = {}; 
var pageindex = 0; 
var gNum = 0;
$(document).ready(function(){   
	var url = window.location.search; 
	var paramsArr = (url.split("?")[1]).split("&"); 
	$.each(paramsArr,function(i){
	var item = paramsArr[i].split("=");
	paramJson[item[0]] = item[1];
	}); 
	var sUserAgent = navigator.userAgent.toLowerCase(); 
    var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";
    var bIsIphone = sUserAgent.match(/iphone/i) == "iphone";
    var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";
    var bIsAndroid = sUserAgent.match(/android/i) == "android"; 
    if(bIsIpad || bIsIphone || bIsIphoneOs){
	$("#iosInfo").show();
    }  
	$(".date-wrap .date").click(function(){
		if($(".dateHtml").css("display")=="none"){
			$(".dateHtml").show(); 
			$(".glist").hide();
		}else{
			$(".dateHtml").hide(); 
			$(".glist").show();
		}
	});
	var dd = new Date(); 
	dd.setDate(dd.getDate()-1);//获取AddDayCount天后的日期
	var y = dd.getFullYear();
	var m = dd.getMonth()+1;//获取当前月份的日期
	var d = dd.getDate(); 
	if(m<10){
	   m = "0"+m;
	}
	if(d<10){
	   d = "0"+d;
	}
	var dateNum = y+"-"+m+"-"+d;   
	$(".date label").html(y+"年"+m+"月"+d+"日");
	calender(paramJson.userId,y,m);
	paramJson.dateNum = dateNum;
	getSequence();
	getGradeList(); 
	$(".dateHtml tbody").on('click',"span",function(event){  
	    var day = $(event.target).html();
		if(day<10){
			day = "0"+day;
		}
		dateNum = $(".dateHtml .year").html()+"-"+$(".dateHtml .month").html()+"-"+day;
		var dateStr = $(".dateHtml .year").html()+"年"+$(".dateHtml .month").html()+"月"+day+"日";
		var old = $(".date label").html();
		if(dateStr!=old){
		   $(".date label").html(dateStr);
			pageindex = 0; 
			paramJson.dateNum = dateNum;
			gNum = 0;
			$(".glist-null").hide(); 
			getSequence();
			getGradeList();  
			
		}
		$(".dateHtml").hide(); 
		$(".glist").show();
	}); 
	$(".gtip").click(function(){
		getGradeList();
	}); 
	$("#commentLink").click(function(){ 
		window.location.href = "comment.html"; 
	});
	$(".toHistory").click(function(){
		window.location.href = "http://w2nw?http://"+urlIp()+"/yangchebao-pubweb/archives/carDriveHistory.html"; 
	});
	$("#lechengLink").click(function(){ 
		window.location.href = $(this).attr("url"); 
	}); 
	getInfo(dateNum); 
});
function getSequence(dateNum){   
	$.ajax({
	      url: '/yangchebao-app-ws/ws/0.1/driving/getSequence?userInfoId='+paramJson.userId+'&dateNum='+paramJson.dateNum,
	      type: 'get',  
	      async:false,
	      dataType: 'json',
	      success: function(data) { 
	      	$(".gradeNum").html(data.sequence);
	      }
	 });
}
function getGradeList(){  
	$.ajax({
	      url: '/yangchebao-app-ws/ws/0.1/driving/getFirst100UserRankList?userInfoId='+paramJson.userId+'&dateNum='+paramJson.dateNum+'&pageindex='+pageindex+'&pagesize=10',
	      type: 'get',  
	      async:false,
	      dataType: 'json',
	      success: function(data) {  
		      if(pageindex==0){
				$(".glist").html("");
			  }
              if((data.page+1)<data.totalPages){
                $(".gtip").show();
              } else{
                $(".gtip").hide();
              }  
              pageindex++;  
              var items = data.items;
              if(items.length>0){ 
              $.each(items,function(i){
                var item = items[i];  
                var flower = "";
				gNum++;
                var mobile = item.mobile.substring(0,3)+"****"+item.mobile.substring(7,11);
                if(item.awardStatus=="Y"){
                	flower = '<img src="images/flower.png"/>';
                }
                var _li = '<li>'
			    	+'	<div>'
			    	+'		<p class="info"><span class="idx">'+gNum+'.</span><span class="phone">'+mobile+'</span></p>'
			    	+'		<label>'+item.modelName+'</label>'
			    	+ flower
			    	+'	</div>'
			    	+'	<div>'
			    	+'		<p class="info">'+item.avgScore+'</p>'
			    	+'		<label>驾驶平均分</label>'
			    	+'	</div>'
			    	+'	<div>'
			    	+'		<p class="info">'+item.dateMileage+'</p>'
			    	+'		<label>行驶里程</label>'
			    	+'	</div> '
			    	+'</li>';
                $(".glist").append(_li);
              });
            }else{ 
               $(".glist-null").show();
            }
	      }
	 });
}
 
function getInfo(dateNum){  
		$.ajax({
          url: '/yangchebao-app-ws/ws/0.1/driving/getDrivingData?dateNum='+dateNum+'&userInfoId='+paramJson.userId,
          type: 'get',  
          async:false,
          dataType: 'json',
          success: function(data) {  
             if(data.boxStatus=="N"){//没盒子
             	$(".boxEntrance").show();
				$(".drivingCnt").html(data.drivingCnt);
				$("#lechengLink").attr("url","http://w2nw?http://"+urlIp()+"/yangchebao-pubweb/carEarn/boxIntro.html");
             }else{//有盒子 
			    $(".myGrade").show();
             	if(data.dataStatus=="Y"){//有数据
				     $(".sequence").html(data.drivingMsg.sequence);
             		 if(data.awardList!=undefined&&data.awardList.length>0){//有奖励
						$(".driveGift").show(); 
						$.each(data.awardList,function(){
							var award = this;
							var _award = '<div class="swiper-slide">'
								+'<img src="images/bg.png">'
								+'<div>'
								+'<p class="name">'+award.awardName+'</p>'
								+'<p class="price">¥ '+award.comValue+'</p>'
								+'<p class="useDate">使用期限：'+award.timeInterval+'</p>'
								+'</div>'
								+'</div> ';
							$(".swiper-wrapper").append(_award);
						});	
						if(data.awardList.length>1){
							 var swiper = new Swiper('.swiper-container', { 
								            loop: true,
											//autoplay: 2000,
											slidesPerView:1.5,
											mousewheelControl : true,
											mousewheelSensitivity : 1
							 });
						 }
					}else{//无奖励
						$(".noGift").show();
						$("#beatUserPer").html(data.beatUserPer); 
					}  
             	}else{//无数据 
             		$(".noDrive").show();
					$(".drivingCnt").html(data.drivingCnt);
             	} 
             }
              
          },error:function(xhr){   
            var mes = eval('('+xhr.responseText+')');  
			alertTasat(mes[0].message); 
          } 
      }); 
}  	 
try{
window.shareInfos.showtitleRightTV("奖励说明",$("input[name='rightNavBtnInfo']:eq(1)").val());
}catch(e){}
</script> 
</body> 
</html>

