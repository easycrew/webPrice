<!DOCTYPE html>
<html>
<head> 
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" name="viewport" />
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="format-detection" content="telephone=no" />
<script src="../../js/jquery-1.9.1.min.js"></script>
<script src="../../js/jquery.json-2.2.js"></script>  
<script src="../js/index.js"></script>  
<title>理赔单</title>
</head>
<style type="text/css">
*{
padding: 0;
margin: 0;
}
html{
  font-size:62.5%;
}
body{
    color: #1e1e1e;
    font-family: "冬青黑体","黑体","HelveticaNeue-Light"; 
    background-color: #f4f7f8;
} 
a,a:hover{
    text-decoration: none;
    outline: none;
}
img,button {
    border:none;
}
ul,ol{
    list-style: none;
}
.header {
    position: relative;
}
.header img {
  display: block;
  width: 100%;
} 
.text-align-middle section {
    background-color: #fff;
    margin-bottom: 1em;
}
.service-wrap, .carwash-wrap, .want-wrap, .news-wrap, .group-buying-wrap {
    background-color: #fff;
}
.service-wrap {
    height: auto;
    overflow: auto;
    padding: 9px 0 7px;
}
.clearfix::before, .clearfix::after {
    content: "";
    display: table;
    line-height: 0;
}
.clearfix::after {
    clear: both;
}
.clearfix::before, .clearfix::after {
    content: "";
    display: table;
    line-height: 0;
}  
.orderList li{
  background-color: #fff; 
  margin-bottom: 1rem;
}
.orderList h1{
  font-weight: normal;
  font-size: 1.5em;
  height: 4rem;
  line-height: 4rem;
  border-bottom: 1px solid #d9d9e2;
  padding: 0 1.5rem;
} 
.orderList .info{
  font-size: 1.2rem;
  height: 4rem;
  line-height: 4rem;
  padding: 0 0 0 1.5rem;
  border-bottom: 1px solid #d9d9e2;
  border-top: 1px solid #D9D9E2;
}  
.more {
    background-image: url("../images/arrow.png");
    background-position: right center;
    background-repeat: no-repeat;
    background-size: 10px auto;
    color: #6eaade;
    float: right;
    font-size: 1.5em;
    height: 40px;
    line-height: 40px;
    padding-right: 12px;
}
.orderList h1 + .more {
    margin: -2.8em 0.8em 0 0;
}
/**错误提示**/
.tasat-wrap{
   position: fixed;
   text-align: center;
   bottom: 50%;
   width: 100%; 
}
.tasat {
    background-color: #000;
    border-radius: 8px;
    color: #fff;
    display: inline-block;
    font-size: 14px;
    margin: 0 20px;
    opacity: 0.8;
    padding: 10px;
}
/**查看更多**/
.tip {
    color: #a0a097;
    font-size: 1.5em;
    padding: 10px;
    text-align: center;
    display: none;
    cursor:pointer;
}
/**查询结果空**/
.null-tip::before {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-right: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip::after {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-left: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip {
    color: #cfd1db;
    font-size: 1.8em;
    margin-top: 2.78em;
    text-align: center;
    display: none;
}
.content{
  display: table;
  width: 100%; 
  padding: 1.5rem 0; 
}
.content .left{
    font-size: 1.8rem; 
    text-align: center; 
    display: table-cell;
    text-align: left; 
    padding-left: 1.5rem;
}
.content p{
  font-size: 1.2rem;
  line-height: 150%;
}
.content .tit{
  font-size: 1.5rem;
}
.content .right{
    font-size: 1.8rem;
    color: #FB451F;
    text-align: right;
    margin: 3rem 0;
    display: table-cell;
    vertical-align: middle; 
    padding-right: 1.5rem;
}
.pay-btn{
  background-color: #FF6138;
  color: #fff;
  text-align: center;
  display: inline-block;
  float: right;
  width:105px;
  font-size: 1.8rem;
}
div.dialog {
    background-color: rgba(0, 0, 0, 0.5);
    height: 100%;
    position: absolute;
    top: 0;
    width: 100%;
    z-index: 300;
}
div.dialogWraper {
    background-color: #fff;
    border-radius: 8px;
    margin: 8rem 5%;
    position: fixed;
    width: 90%;
    z-index: 500;
}
div.dialogWraper div.payItem {
    border-bottom: 1px solid #d9d9e2;
    overflow: hidden;
    padding: 1.6rem 1.6rem 1.6rem 0.6rem;
}
div.dialogWraper div.payItem p {
    float: left;
    margin-right: 2%;
    text-align: right;
    width: 32%;
}
div.dialogWraper div.payItem p img.zfbIcon {
    width: 80% !important;
}
div.dialogWraper div.payItem p img.wxIcon {
    width: 88% !important;
}
div.dialogWraper div.payItem .txt {
    color: #c2c2c6;
    display: inline-block;
    float: left;
    font-size: 1.3rem;
    width: 58%;
}
 
div.dialogWraper div.payBtn {
    font-size: 1.6rem;
    padding: 1.6rem;
    text-align: center;
}
.dialog .payCheck{
    float: right; 
    background-image: url("../images/payCheck.png");
    background-position: right center;
    background-repeat: no-repeat;
    background-size: auto 1.8rem;  
    width:1.8rem;
    height:1.8rem; 
}
.dialog .payCheck.checked{ 
    background-position: left center; 
}
</style>
<body> 
   <section>
      <ul class="orderList">
<!--         <li>
            <h1>理赔单号：3535646466464</h1> 
            <span class="more"></span>
            <div class="content">
              <div class="left">
                <p class="tit">靓车会维修厂</p>
                <p>维修零件费 ¥809.00</p><p>维修工时费 ¥600.00</p><p>创建时间：2015-09-22 </p>
              </div>
              <div class="right">¥1409.00</div> 
            </div>
            <p class="info">返利金额￥<span class="userRebate">12</span>
              <span class="pay-btn">付款</span>
            </p>
        </li>  --> 
      </ul>
  </section>
  <div style="display:none;" class="dialog">
    <div id="dialogWraper" class="dialogWraper">
      <div class="zfb payItem checkPayItem">
        <p><img class="zfbIcon" alt="支付宝" src="../images/zfb_icon.png"></p>
        <span class="txt">需要拥有支付宝账号</span>
        <span class="payCheck checked" pid="3"></span>
      </div>
      <div class="wx payItem">
        <p><img class="wxIcon" alt="微信支付" src="../images/wx_icon.png"></p>
        <span class="txt">推荐安装微信5.0版本以上</span>
        <span class="payCheck" pid="1"></span>
      </div>
      <div class="payBtn">确定</div>
    </div>
  </div>
<p class="null-tip">暂无订单</p>
<p class="tip">点击查看更多</p>  
<script type="text/javascript">
var paramJson = {};
var pageindex = 0;
$(document).ready(function(){  
    var url =window.location.search;   
    if(url!=undefined&&url!=""){
    var paramsArr = (url.split("?")[1]).split("&"); 
    $.each(paramsArr,function(i){
     var item = paramsArr[i].split("=");
     paramJson[item[0]] = item[1];
    });    
    }  
  $(".tip").click(function(){
    getOrderList();
  }); 
  $(".orderList").on("click","h1",function(){
    var num = $(this).parent("li").attr("orderNumber");
    window.location.href = "orderDetail.html"+window.location.search+"&orderNumber="+num; 
  }); 
  $(".orderList").on("click",".pay-btn",function(){
    paramJson.sourceId = $(this).parents("li").attr("sourceid");
    $(".dialog").show();
  }); 
  getOrderList(); 
  function getOrderList(){  
    $.ajax({
        url: "/yangchebao-app-ws/ws/0.1/claims/order/page?operatorType=2&customerId="+paramJson.customerId+'&pagesize=10&pageindex='+pageindex+"&"+(new Date()).getTime(),
        contentType: "application/json;charset=utf-8",
        dataType: "json",
        type: "get",
        success: function(data) {
          if(data.totalCount>0){ 
        		    if((data.page+1)<data.totalPages){
        				$(".tip").show();
        			} else{
        				$(".tip").hide();
        			} 
        			pageindex++;  	
              var items = data.items; 
              $.each(items,function(i){
                    var item  = items[i]; 
                    var pay = "";
                    if(item.status=="2"){
                      pay = '<span class="pay-btn">付款</span>';
                    } 
                    var _li = '  <li orderNumber="'+item.orderNumber+'" sourceid="'+item.sourceId+'">'
                            +'<h1>理赔单号：'+item.orderNumber+'</h1> '
                            +'<span class="more"></span>'
                            +'<div class="content">'
                            +'<div class="left">'
                            +'<p class="tit">'+item.businessRegName+'</p>'
                            +'<p>维修零件费 ¥'+item.partsPrice+'</p><p>维修工时费 ¥'+item.workPrice+'</p><p>创建时间：'+item.orderDate+' </p>'
                            +'</div>'
                            +'<div class="right">¥'+item.sumPrice+'</div> '
                            +'</div>'
                            +' <p class="info">返利金额￥'+item.userRebate
                            +pay+'</p>'
                            +'</li> '; 
                    $(".orderList").append(_li);
                  });
                }else{
          		    	$(".null-tip").show();
          		  }
        },error: function(xhr) {
			   var mes = eval('('+xhr.responseText+')'); 
			   alertTasat(mes[0].message);
		}
    });
  }
  $(".dialog .payItem").click(function(){
      $(".dialog .checked").removeClass("checked");
      $(this).children(".payCheck").addClass("checked");
  });
  
  $('.dialog .payBtn').click(function(){
    var payChannel =  $(".dialog .checked").attr("pid");  
    isLogin('http://w2l/?presentType=1&needLogin=1&androidName=29&iosName=MyWebViewController&sourceId='+paramJson.sourceId+'&itemType=1&fromChannel=claims&payChannel='+payChannel);
	setTimeout(link, 100); 
   }); 
	var link = function(){ 
	   window.location.href = "pay_result.html";
	  //点支付跳转页面 
	}		
    $('div.dialog').click(function(e){
      if($(e.target).closest('#dialogWraper').length==0){
        $('div.dialog').hide(); 
      }
    });
});
</script>
</body>
</html>