<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />  
    <title>附近修理厂</title>
</head>
<style type="text/css">
html{
   font-size:62.5%;
}
body{
    background-color:#F4F7F8;  
    color:#1e1e1e;
    font-family:'冬青黑体','黑体','HelveticaNeue-Light'; 
} 
a{
    color:#00a0e9;
    text-decoration: none;
}
a:focus{
    outline:none;
}
ul{
    list-style:none;
}
img{
    border:none;
}
*{
    margin:0;
    padding:0;
    text-shadow:none;
}
.clearfix {
  *zoom: 1;
}
.clearfix:before,
.clearfix:after {
  display: table;
  line-height: 0;
  content: "";
}
.clearfix:after {
  clear: both;
} 
.shopList li {
    border-bottom: 1px solid #D9D9E2;
    background-color: #fff;
    margin-bottom: 1rem; 
}
.shopList .content-wrap {
    padding: 1.5rem;
    border-bottom: 1px solid #D9D9E2;
    height: auto;
    overflow: auto;
}
.shopList h3 {
    font-size: 1.6rem; 
    font-weight: normal;
    margin-bottom: 0.8rem; 
} 
.shopList .info {
    color: #323232;
    font-size: 1.2rem;
    line-height: 150%;
    margin: 0;
} 
.shopList .pic {
    float: left;
    height: auto; 
    width: 8em;
}
.shopList .pic img {
    display: block; 
    width: 100%;
} 
.shopList .pic + div {
    margin-left: 9.2em;
}
.distance{
    background-color: #fb451f;
    color: #fff;
    display: inline-block;
    float: right;
    font-size: 1.2rem;
    height: 1.1em;
    line-height: 1.1em;
    margin-right: -1.3em;
    padding: 0 0.5em 0 0.3em;
} 
.btn-wrap a{
    font-size: 1.6rem;
    height: 3.8rem;
    line-height: 3.8rem;
    display: block;
    width: 50%;
    float: left;
    text-align: center;
}
.btn-wrap .left{
    color: #FB451F;
}
.btn-wrap .right{
    color: #fff;
    background-color: #FB451F;
}
header{
    height: 3.8rem;
    line-height: 3.8rem;
    background-color: #fff;
    font-size: 1.5rem;
    margin-bottom: 1rem;
    border-bottom: 1px solid #D9D9E2;
    padding: 0 6.3rem 0 3rem;
    position: relative;
    background-image:url("images/search.png");
    background-repeat: no-repeat;
    background-size:1.5rem auto;
    background-position: 10px center;
}
header span{
    color:  #6EAADE;
    display: inline-block;
    width: 6.2rem;
    text-align: center;
    height: 3.8rem;
    position: absolute;
    right: 0;
    top: 0;
    border-left: 1px solid #D9D9E2;
}
header input{ 
    display:block; 
    width: 100%;
    border: none;
    height: 3.8rem;
    background-color: #fff; 
    font-size: 1.5rem;
}
.null-wrap img{
    display: block;
    width: 8.5rem;
    margin: 1.8rem auto;
}
.null-wrap p{
    font-size: 1.5rem;
    color: #A2A2A2;
    text-align: center; 
}
.loadingBar{
    margin-top: 2.78em; 
    width: 100%;
    text-align: center;
} 
.loadingBar img{
    margin: 0 auto;
}
.call-wrap {
    background: rgba(0, 0, 0, 0) none repeat scroll 0 0;
    z-index: 110;  
    bottom: 0;
    box-sizing: border-box;
    padding: 1em;
    position: fixed;
    width: 100%;
}
.btn-pink {
    background-color: #f1606d;
    margin-top: 0.625em; 
    color: #ffffff;
    display: block;
    font-size: 1.6em;
    height: 2.125em;
    line-height: 2.125em;
    padding: 0 0.625em;
    text-align: center;
}
.call-wrap p {
    background-color: #fff;
    color: #1e1e1e;
    display: block;
    font-size: 1.8em;
    height: 2.33em;
    line-height: 2.33em;
    margin-bottom: 1px;
    text-align: center;
}
.overlay-wrap-phone {
    background-color: rgba(0, 0, 0, 0.8);
    bottom: 0;
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 100;
}
/**错误提示**/
.tasat-wrap{
   position: fixed;
   text-align: center;
   bottom: 50%;
   width: 100%; 
}
.tasat {
    background-color: #000;
    border-radius: 8px;
    color: #fff;
    display: inline-block;
    font-size: 14px;
    margin: 0 20px;
    opacity: 0.8;
    padding: 10px;
} 
.tip {
    color: #a0a097;
    cursor: pointer;
    display: none;
    font-size: 1.5em;
    padding: 10px;
    text-align: center;
}
</style>
<body> 
<header>
    <input type="text" placeholder="输入修理厂名称、地址" class="keywords"><span class="search">搜索</span>
</header>
<ul class="shopList"> 
    <!-- <li class="clearfix" relid="2087">
        <div class="content-wrap">
            <div class="pic">
                <img src="http://app.yangchebao.com.cn/group1/M00/00/00/ChUBl1KhPxiAeMgPAAAYn6StDkg043.jpg"/>
            </div>
            <div>
            <h3><span class="tit">车龙汽车装饰望京总店</span><span class="distance">>100km</span></h3>
                <p class="info">地址：朝阳区望京西路中广宜景湾北门502号楼底商102--103</p>
            </div>
        </div>
        <div class="btn-wrap">
            <a class="left">拨打电话</a>
            <a class="right">生成理赔单</a>
        </div>
    </li>  -->  
</ul>
<p class="tip">点击查看更多</p>
<p class="loadingBar" style="display:none;"><img src="http://app.yangchebao.com.cn/group1/M00/0B/15/ChUBl1V76SGALWzmAAAC2aQ2QYI317.gif"></p>
<div  class="null-wrap" style="display:none">
    <img src="images/null.png">
    <p>&nbsp;没有您想要的结果！</p>
</div>
<footer style="display: none;" class="call-wrap"> 
    <a href="javascript:void(0);" class="tel"><p></p></a>
    <a href="javascript:void(0);" class="btn btn-pink">取消</a> 
</footer>
<div style="display: none;" class="overlay-wrap-phone"></div>
<script type="text/javascript">
var paramJson = {};
var pageindex = 0;
$(document).ready(function(){  
    var url =window.location.search;   
    if(url!=undefined&&url!=""){
    var paramsArr = (url.split("?")[1]).split("&"); 
    $.each(paramsArr,function(i){
     var item = paramsArr[i].split("=");
     paramJson[item[0]] = item[1];
    });    
    } 
	$(".shopList").on('click','.mobile',function(){
        var phone = $(this).attr("phone");
        $(".call-wrap .tel p").html(phone);
        $(".call-wrap .tel").attr("href","tel:"+phone);
        $(".call-wrap").show();
		$(".overlay-wrap-phone").show();
	});
    $(".btn-pink").on('click',function(){ 
        $(".overlay-wrap-phone").hide();
        $(".call-wrap").hide();
    }); 
	$(".search").on('click',function(){  
		var keywords = $.trim($(".keywords").val()); 
		pageindex = 0;
		$(".null-wrap").hide();
		paramJson.keywords = keywords;
		getShopList();  
    });  
	$(".tip").click(function(){
		getShopList();
	}); 
    getShopList();
});  
  function getShopList(){  
      if(pageindex==0){
		$(".shopList").html("");
	  }
      $(".loadingBar").show();
      var url = '/yangchebao-app-ws/ws/0.1/shop/business/page/v2?areaName='+paramJson.cityName+'&modelId='+paramJson.modelId+'&service=4&lon='+paramJson.lon+'&lat='+paramJson.lat+'&pagesize=10&pageindex='+pageindex+'&specialServiceId=13279'; 
	  if(paramJson.keywords!=undefined){
		url+="&keywords="+paramJson.keywords;
	  }
      $.ajax({
          url: url,
          type: 'get', 
          dataType: 'json',
          success: function(data) {   
              $(".loadingBar").hide();
              if((data.page+1)<data.totalPages){
                $(".tip").show();
              } else{
                $(".tip").hide();
              } 
              pageindex++; 
              var items = data.items;
              if(items.length=="0"){
                $(".null-wrap").show();
              } 
              $.each(items,function(i){
                var item = items[i];
                var _li = '  <li class="clearfix" shopid="'+item.id+'" relid="'+item.busiServiceRelId+'">'
                       +' <div class="content-wrap">'
                       +'     <div class="pic">'
                       +'         <img src="'+item.logo+'"/>'
                       +'     </div>'
                       +'     <div>'
                       +'     <h3><span class="tit">'+item.name+'</span><span class="distance">'+item.distance+'</span></h3>'
                       +'         <p class="info">'+item.address+'</p>'
                       +'     </div>'
                       +' </div>'
                       +' <div class="btn-wrap">'
                       +'     <a class="left mobile" href="javascript:void(0);" phone="'+item.mobile+'">拨打电话</a>'
                       +'     <a class="right creatBtn">生成理赔单</a>'
                       +' </div>'
                     +'</li>';
                     $(".shopList").append(_li);
              });
          },error:function(xhr){  
            $(".loadingBar").hide();
          }
      });  
  } 
</script>
</body>
</html>