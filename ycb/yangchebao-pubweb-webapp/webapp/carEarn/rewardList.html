<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes" />
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
    <meta name="format-detection" content="telephone=no" />
    <title>奖励历史</title>
    <script src="http://app.yangchebao.com.cn/group1/M00/00/9F/jquery-1.9.1.min.00000000000000.js "></script>
    <style type="text/css">
        html {
            font-size: 62.5%;
        }
        body {
            font-family:"MicrosoftYaHei","HelveticaNeue-Light";
            font-weight: normal;
            font-style: normal;
            line-height: normal;
            width: 100%;
            margin: 0 auto;
            background:#f4f7f8;
        }
        i, em {
            font-style: normal;
        }
        a {
            text-decoration: none;
        }
        ul {
            list-style: none;
        }
        li{ list-style-type:none;}
        img {
            border: none;
        }
        * {
            margin: 0;
            padding: 0;
        }
        .clearfix {
            *zoom: 1;
        }
        .clearfix:before, .clearfix:after {
            display: table;
            line-height: 0;
            content: "";
        }
        .clearfix:after {
            clear: both;
        }
        section,article{ width:100%; display:block;}
        .box1{ width:100%; padding:1rem 1.5rem; box-sizing:border-box; border-bottom:1px solid #c2c2c6; background-color:#fff;}
        .box1 p{ font-size:1.5rem;}
        .box1 p a{ color:#a2a2a2;}
        .box1 p:nth-of-type(2){margin-top:1rem;}
        .box1 p span,.box1 p i,{ display:block; float:left;}
        .box1 p em,.box1 p a{ display:block; float:right;}
        .box3{ display:none; width:100%; border-bottom:1px solid #c2c2c6; background-color:#fff;}
        .box3 p{ margin-top:2.9rem; font-size:1.5rem; text-align: center;}
        .box3 img{ display:block; width:9.85rem; margin: 0 auto;}
        .Clickmore{ width:100%; line-height:35px; text-align:center; display:block; color:#a2a2a2; background-color:#fff; border-bottom:1px solid #c2c2c6;}

        .tasat-wrap{
            position: fixed;
            text-align: center;
            bottom: 50%;
            width: 100%;
        }
        .G{
            z-index: 1001;
        }
        .tasat{
            background-color: #000;
            border-radius: 8px;
            color: #fff;
            font-size: 1.6rem;
            opacity: 0.8;
            padding: 0.5em;
            display: inline-block;
            margin: 0 20px;
        }
    </style>
</head>

<body>
<section>
    <article class="arc">
        <!-- <div class="box1">
             <p><span>疯狂的爪子</span><i>（186xxxx8996）</i><em>+3元</em></p>
             <p><span>一线成员</span><a>2016.02.26</a></p>
          </div>
         <div class="box1">
           <p><span>疯狂的爪子疯狂…</span><i>（186xxxx8996）</i><em>+3元</em></p>
           <p><span>一线成员</span><a>2016.02.26</a></p>
         </div>
         <div class="box1">
           <p><span>疯狂的爪子</span><i>（186xxxx8996）</i><em>+3元</em></p>
           <p><span>一线成员</span><a>2016.02.26</a></p>
         </div>
         <div class="box1">
             <p><span>疯狂的爪子</span><i>（186xxxx8996）</i><em>+3元</em></p>
             <p><span>一线成员</span><a>2016.02.26</a></p>
          </div>
         <div class="box1">
           <p><span>疯狂的爪子疯狂…</span><i>（186xxxx8996）</i><em>+3元</em></p>
           <p><span>一线成员</span><a>2016.02.26</a></p>
         </div>
         <div class="box1">
           <p><span>疯狂的爪子</span><i>（186xxxx8996）</i><em>+3元</em></p>
           <p><span>一线成员</span><a>2016.02.26</a></p>
         </div>-->

        <div class="box3">
            <img src="img/hezi.png" />
            <p>您还没有获得奖励哦～</p>
        </div>
    </article>

</section>
<p class="Clickmore">点击加载更多</p>

<script type="text/javascript">

    var paramJson = {};
    var pageindex = 0;
    var pagesize = 20;
    $(function(){
        var url = window.location.search;
        var paramsArr = (url.split("?")[1]).split("&");
        $.each(paramsArr,function(i){
            var item = paramsArr[i].split("=");
            paramJson[item[0]] = item[1];
        });

        $.ajax({
            url:'/yangchebao-app-ws/ws/0.1/autogain/member/award/list/biz?userInfoId='+paramJson.userId+'&bizType='+paramJson.bizType+'&pageindex='+pageindex+'&pagesize='+pagesize+'&'+(new Date()).getTime(),
            type:'get',
            async:false,
            dataType:'json',
            success:function(data){
                var items = data.items;
                //alert(items.length);
                var box = '';
                $.each(items,function(){
                    var mobile = this.mobile.substring(0,3)+"****"+this.mobile.substring(7,11);
                    box += '<div class="box1">'
                    +'<p><span>'+this.nickName+'</span><i>（'+this.mobile+'）</i><em>+'+this.changeIncome+'元</em></p>'
                    +'<p><span>'+this.remark+'</span><a>'+this.createDate+'</a></p>'
                    +'</div>'
                })

                if(items.length==0){
                    $('.box3').show();
                    $('.Clickmore').hide();
                }else if(items.length<20){
                    $('.Clickmore').hide();
                    $('.arc').append(box);
                }else{
                    $('.Clickmore').show();
                    $('.arc').append(box);
                }

            },error: function(xhr){
                alertTasat(xhr)
            }

        })
        $('.Clickmore').on("click",function(){
            $.ajax({
                url:'/yangchebao-app-ws/ws/0.1/autogain/member/award/list/biz?userInfoId='+paramJson.userId+'&bizType='+paramJson.bizType+'&pageindex='+(pageindex+1)+'&pagesize='+pagesize+'&'+(new Date()).getTime(),
                type:'get',
                async:false,
                dataType:'json',
                success:function(data){
                    pageindex++
                    console.log(data);
                    var items = data.items;
                    var box = '';
                    $.each(items,function(){
                        var mobile = this.mobile.substring(0,3)+"****"+this.mobile.substring(7,11);
                        box += '<div class="box1">'
                        +'<p><span>'+this.nickName+'</span><i>（'+this.mobile+'）</i><em>+'+this.changeIncome+'元</em></p>'
                        +'<p><span>'+this.remark+'</span><a>'+this.createDate+'</a></p>'
                        +'</div>'
                    })
                    $('.arc').append(box);

                },error: function(xhr){
                    alertTasat(xhr)
                }

            });
        });
        function alertTasat(msg){
            var _html = $("<div>").addClass("tasat-wrap").addClass("G")
            var _span = $("<span>").addClass("tasat").html(msg);
            $("body").append(_html.append(_span));
            _html.fadeIn();
            window.setTimeout(function(){
                _html.fadeOut(function(){
                    _html.remove();
                });
            }, 1500);
        }
    });

</script>
</body>
</html>
