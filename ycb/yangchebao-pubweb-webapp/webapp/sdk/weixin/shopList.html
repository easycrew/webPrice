<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="black" name="apple-mobile-web-app-status-bar-style" /> 
    <script src="../js/jquery-1.9.1.min.js"></script>
	<script src="../js/index.js"></script>
	<title>商家列表</title>
</head>
<style type="text/css">
body{
	background-color:#f4f7f8;  
	color:#1e1e1e;
	font-family:'冬青黑体','黑体','HelveticaNeue-Light';
	font-size:62.5%;
} 
a{
	color:#00a0e9;
	text-decoration: none;
}
a:focus{
	outline:none;
}
ul{
	list-style:none;
}
img{
	border:none;
}
*{
	margin:0;
	padding:0;
	text-shadow:none;
}
.clearfix {
  *zoom: 1;
}
.clearfix:before,
.clearfix:after {
  display: table;
  line-height: 0;
  content: "";
}
.clearfix:after {
  clear: both;
}
.shopList .list-module-pic h3 {
    font-size: 1.4em; 
    font-weight: normal;
    margin-bottom: 0.323em;
    min-height: 1.67em;
} 
.shopList .info {
    color: #323232;
    font-size: 1.2em;
    line-height: 150%;
    margin: 0;
}
.list-module-pic{
	background-color:#f4f7f8;
}
.list-module-pic li {
    border-bottom: 1px solid #c2c2c6;
    padding: 0.625em 0.93em 0.93em;
}
.list-module-pic .pic {
    float: left;
    height: 6em;
    margin-top: 0.5em;
    width: 8.2em;
}
.shopList .list-module-pic .pic img {
    display: block;
    height: 6em;
    width: 8.2em;
}
.shopList li {
    background-color: #fff;
    margin-top: 1em;
}
.list-module-pic .pic + div {
    margin-left: 9.5em;
}
.distanceLabel {
    background-color: #fb451f;
    color: #fff;
    display: inline-block;
    float: right;
    font-size: 1em;
    height: 1.1em;
    line-height: 1.1em;
    margin-right: -0.7em;
    padding: 0 1em 0 0.6em;
}
/**错误提示**/
.tasat-wrap{
   position: fixed;
   text-align: center;
   bottom: 50%;
   width: 100%; 
}
.tasat {
    background-color: #000;
    border-radius: 8px;
    color: #fff;
    display: inline-block;
    font-size: 14px;
    margin: 0 20px;
    opacity: 0.8;
    padding: 10px;
}/**查看更多**/
.tip {
    color: #a0a097;
    font-size: 1.5em;
    padding: 10px;
    text-align: center;
    display: none;
    cursor:pointer;
}
/**查询结果空**/
.null-tip::before {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-right: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip::after {
    border-bottom: 1px solid #cfd1db;
    content: "";
    display: inline-block;
    margin-left: 0.5em;
    vertical-align: middle;
    width: 2.4em;
}
.null-tip {
    color: #cfd1db;
    font-size: 1.8em;
    margin-top: 2.78em;
    text-align: center;
    display: none;
}
</style>
<body style="width:100%;background-color:#f4f7f8;">
<article class="shopList"> 
	<ul class="list-module-pic">
<!-- 		<li class="clearfix" shopId="10024">
			<div class="pic">
				<img src="http://app.yangchebao.com.cn/group1/M00/06/2F/ChUBl1SukU2ACeQiAAAC_qiv-oE371.jpg"/>
			</div>
			<div>
				<h3><span class="tit">养车宝测试商家</span><span class="distanceLabel">>10km</span></h3>
				<p class="info">地址：北京市许愿南路</p>
			</div>
		</li>  -->
	</ul>
</article> 
<p class="null-tip">暂无支持商家</p>
<p class="tip">点击查看更多</p>  
<script type="text/javascript">
  $(document).ready(function(){
     var paramJson = {};
     var url =window.location.search;  
     if(url!=undefined&&url!=""){
      var paramsArr = (url.split("?")[1]).split("&"); 
      $.each(paramsArr,function(i){
       var item = paramsArr[i].split("=");
       paramJson[item[0]] = item[1];
      });    
    }
  var pageindex = 0;
  getShopList(); 
  $(".tip").click(function(){
        getShopList();
    });  
  $(".list-module-pic").on('click',"li",function(){
      window.location.href= getPath()+"weixin/order2.html?cardId="+paramJson.cardId+"&busiServiceRelId="+$(this).attr("busiServiceRelId");
  }); 
  function getShopList(){ 
    $.ajax({  
        url: "/yangchebao-app-ws/ws/0.1/card/businessList?cardId="+paramJson.cardId+"&serviceId="+paramJson.serviceId+'&pagesize=10&pageindex='+pageindex,
        contentType: "application/json;charset=utf-8",
        dataType: "json",
        type: "get",
        success: function(data) {
          if(data.totalCount>0){
             if((data.page+1)<data.totalPages){
				$(".tip").show();
			  } else{
				$(".tip").hide();
			  } 
			pageindex++;  		  
            var items = data.items; 
            $.each(items,function(i){
              var item  = items[i];   
              var _li = '<li class="clearfix" busiServiceRelId="'+item.busiServiceRelId+'">'
                +'<div class="pic">'
                +'<img src="'+item.logo+'"/>'
                +'</div>'
                +'<div>'
                +'    <h3><span class="tit">'+item.name+'</span><span class="distanceLabel">'+item.distance+'</span></h3>'
                +'    <p class="info">地址：'+item.address+'</p>'
                +'</div>'
                +'</li> ';
              $(".list-module-pic").append(_li);
            });
          }else{
			$(".null-tip").show();
		  }
        },error: function(xhr) {
			   var mes = eval('('+xhr.responseText+')'); 
			   alertTasat(mes[0].message);
		}
    });
  }
   });
</script>
</body>
</html>