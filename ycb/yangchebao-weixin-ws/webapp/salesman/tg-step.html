<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/>  
<title>推广步骤</title>
<link rel="stylesheet" href="./css/index.css"> 
<script language="javascript" src="./js/jquery-1.10.1.min.js"></script> 
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script language="javascript" src="./js/jquery.json-2.2.js"></script>
<script language="javascript" src="./js/index.js"></script>
<script language="javascript" src="./js/share.js"></script> 
</head>  
<body> 
	<section  class="step-wrap">
        <p class="step">第一步：推荐用户扫描“推广二维码”下载养车宝，并注册养车宝账号；</p>
        <div class="pic-code"><img src="css/images/tgewm.png"></div>
        <p class="step">第二步：请在您推荐的用户注册后3天之内输入用户手机号，点击确定；订单预订价须大于等于80元才能获取首单工资；</p>
        <input type="text" id="mobile" class="inp" placeholder="请输入用户注册手机号码！"/>
        <div class="step" style="color:red;display:none;margin-top:-0.6em;margin-bottom:0.6em;"></div>
        <a id="apply" class="btn" href="javascript:void(0)">确定</a>
        <p class="step step3">第三步：查看详情。</p>
        <a id="toCash" class="btn" href="javascript:void(0)">详情</a>
    </section>
   <!--  <section  class="result-wrap" style="display:none;"> 
        <div class="pic-code"><img src="css/images/tgewm.png"></div>
        <p class="step" id="msg">恭喜你获得3元推荐工资，以及用户完成首单8元工资，可在工资详情查看详细！</p> 
    </section> --> 
    <script type="text/javascript">
    var browser={
                versions:function(){
                            var u = navigator.userAgent, app = navigator.appVersion;
                            return {         //移动终端浏览器版本信息
                                trident: u.indexOf('Trident') > -1, //IE内核
                                presto: u.indexOf('Presto') > -1, //opera内核
                                webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
                                gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
                                mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
                                ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
                                android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
                                iPhone: u.indexOf('iPhone') > -1 , //是否为iPhone或者QQHD浏览器
                                iPad: u.indexOf('iPad') > -1, //是否iPad
                                webApp: u.indexOf('Safari') == -1 //是否web应该程序，没有头部与底部
                            };
                     }()
            };
    $(document).ready(function(){ 
        var postData = {}; 
        var url = window.location.search; 
        var paramsArr = (url.split("?")[1]).split("&");
        var paramJson = {};
        $.each(paramsArr,function(i){
            var item = paramsArr[i].split("=");
            paramJson[item[0]] = item[1];
        }); 
        $("#apply").click(function(){
            var mobile = $.trim($("#mobile").val());
            if(mobile==""){
                $("div.step").html("请输入手机号码").show();
                return;
            }
            var phoneReg = /^((\+86)|(86)){0,}1\d{10}$/; 
            if(!phoneReg.test(mobile)){
              $("div.step").html("请输入正确的手机号码").show(); 
              return;
            }
            $("div.step").hide();
            getSalary(mobile);
        });
        $("#toCash").click(function(){
            window.location.href = "cash.html?openid="+paramJson.openid;
        });
        function getSalary(mobile){ 
            var postData = {};
            var mobileType='';
            if(browser.versions.ios||browser.versions.iPhone||browser.versions.iPad){
                mobileType=2
            }else{
                mobileType=1
            }
            postData.openid = paramJson.openid;
            postData.mobile = mobile; 
            postData.mobileType=mobileType;
            $.ajax({
                url: '/yangchebao-weixin-ws/ws/0.1/salesman/getSalary',
                type: 'post',
                async: false,
                data:$.toJSON(postData),
                dataType: 'text',
                contentType:'application/json;charset=utf-8',
                success:function(data){
                      // $(document).attr("title","验证结果");
                      // $("#msg").html(data);
                      // $(".step-wrap").hide();
                      // $(".result-wrap").show(); 
                      alertRe(data);
                      window.scrollTo(0,0)
                },error:function(xhr){ 
                     var mes = eval('('+xhr.responseText+')'); 
                     alertRe(mes[0].message); 
                     window.scrollTo(0,0)
                     
                }
            }); 
        };
    })
    </script>
</body>
</html>

