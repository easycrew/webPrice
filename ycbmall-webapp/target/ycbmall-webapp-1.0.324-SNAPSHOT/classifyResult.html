<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta name="keywords" content="养车宝，配件商城">
	<meta name="description" content="养车宝配件商城，100%原厂品质，3M、威固、美孚、壳牌Ahell、普利司通、米其林等汽车配件，厂价直销！">
	<title>全网正品汽车配件_养车宝配件商城！</title>
	<link rel="icon" href="favicon.ico">
	<script src="js/jquery-1.10.1.min.js"></script>
	<script src="js/jquery.urlParam.js"></script>
	<script src="js/jquery.pagination.js"></script>
	<script src="js/common.js"></script>
	<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script><!--根据IP地址获取当前所在地城市-->
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/login.css">
	<link rel="stylesheet" href="css/classifyResult.css">
	<style type="text/css">
		.classiify_goodsPrice_change{
			cursor: pointer;
			font-size: 16px!important;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="top"></div>
		<div class="main">
			<div class="mainCommen"></div>
			<div class="smallNav">您当前的位置：<span class="smallNav_first smallNavMenu"><a href="javascript:">所有结果</a> ></span><span class="smallNav_second smallNavMenu"> <a href="javascript:">黄壳</a></span></div>
			<div class="classiify_con">
				<div class="classify_downMenu">
					<ul class="ul_first">
						<li class="li_first li_classify"><p class="p_first"><span class="menuText">配件分类</span><span class="menuIcon"><img src="img/classifyDown_icon.png"></span></p>
							<ul class="ul_second">
								<li class="li_second"><p class="p_second parentClassify" id=''>车轮</p>
									<ul class="ul_third">
										<li class="li_third"><p class="p_third childClassify" id=''>轮胎</p></li>
									</ul>
								</li>
							</ul>
						</li>
						<li class="li_first li_brand"><p class="p_first"><span class="menuText">配件品牌</span><span class="menuIcon"><img src="img/classifyDown_icon.png"></span></p>
							<ul class="ul_second">
								<li class="li_second"><p class="p_second">玛吉斯</p></li>
								<li class="li_second"><p class="p_second">普利司通</p></li>
								<li class="li_second"><p class="p_second">米其林</p></li>
								<li class="li_second"><p class="p_second">鹰速</p></li>
							</ul>
						</li>
						<li class="li_first li_carType"><p class="p_first"><span class="menuText">适配车型</span><span class="menuIcon"><img src="img/classifyDown_icon.png"></span></p>
							<ul class="ul_second">
								<form>
									<li class="li_second">
										<p class="p_secondForm">
											<select name="carBrand" id="carBrand">
												<option value="">请选择品牌</option>
											</select>
										</p>
									</li>
									<li class="li_second">
										<p class="p_secondForm">
											<select name="carFactory" id="carFactory">
												<option value="">请选择车厂</option>
											</select>
										</p>
									</li>
									<li class="li_second">
										<p class="p_secondForm">
											<select name="carMethod" id="carMethod">
												<option value="">请选择车系</option>
											</select>
										</p>
									</li>
									<li class="li_second">
										<p class="p_secondForm">
											<select name="carStyle" id="carStyle">
												<option value="">请选择车型</option>
											</select>
										</p>
									</li>
									<li class="li_second">
										<p class="p_secondForm carButton"><span class="carButton">确定</span></p></li>
								</form>
							</ul>
						</li>
					</ul>
				</div>
				<div class="classiify_goods">
					<div class="classiify_searchItems">
						<ul>
							<li class="saleDecrease"><p>销量从高到低</p></li>
							<li class="priceUpOrDown"><span class="priceText">价格</span><span class="priceImg"></span></li>
							<li class="hasSearchs">已选条件：</li>
							<!--勾选只显示有货展示
							<li class="selectType">
								<input type="checkbox" name="existProduction" id="existProduction" value="" />
								<span class="existText">仅显示有货</span>
							</li>-->
						</ul>
					</div>
					<div class="classiify_goodsDetail">
						<ul>
							
						</ul>
					</div>
					<div class="pagination"></div>
				</div>
			</div>
		</div>
		<div class="footer"></div>
	</div>
</body>
<script type="text/javascript">
	var pageParams={},commodityType;
	function Login(){
		$('div.Form-login').show();
		$('div.login-dialog-overlay').show();
		$('li.login a').html('请登录');
		$('li.username p').html('');
	}
	$(function(){
		$('div.top').load('top.html');
		$('div.mainCommen').load('searchAndNav.html');
		$('div.footer').load('footer.html');
		var columnId=$.getQuery('columnId');//专供栏目ID
		var url = window.location.search;
	    var paramJson = {};
	    if(url!=''){
	    	var paramsArr = (url.split("?")[1]).split("&");
		    $.each(paramsArr,function(i){
		        var item = paramsArr[i].split("=");
		        paramJson[item[0]] = item[1]
		    });
	    }
		var username=mall.getCookie('username');
		var customerId=mall.getCookie('customerId');
		var areaCodeId=mall.getCookie('areaCodeId');
	    if(paramJson.classificationId){
	    	var classificationId=paramJson.classificationId;
	    }else if(paramJson.firstClassificationId){
	    	var classificationId=paramJson.firstClassificationId
	    }
		if(columnId){
				commodityType=3;
		}
		pageParams=paramJson;
		pageParams.sortname='salesNum';
		pageParams.sortorder='desc';
	    if(paramJson.keyword || url==''){
	    	if(paramJson.keyword){
	    		paramJson.keyword=decodeURI(paramJson.keyword);
//	    		//需要优化
//	    		setTimeout(function(){
//	    			$('div.mainCommen form input[name="keyword"]').val(paramJson.keyword);
//	    		},300)
	    	var _pageParams={};
			_pageParams=paramJson;
			_pageParams.sortname='salesNum';
			_pageParams.sortorder='desc';
			_loadGoodsList(0);
	    	}else{
	    		loadGoodsList(0)
	    	}
	    }
		
		if(columnId){
			loadGoodsList(0);
			$.ajax({
				type:"get",
				url:mall.url('/exclusiveColumn/getSecondClassesByColumnId'),
				async:true,
				data:{columnId:columnId},
				dataType:'json',
				contentType:'application/json;charset="utf-8"',
				success:function(data){
					$('div.smallNav').show().find('span.smallNav_second a').html(data.columnName);
					var childClassifyStr='';
					var classes=data.classes;
					$.each(classes,function(){
						childClassifyStr+='<li class="li_second">'
									   +'<p class="p_second parentClassify" id="'+this.id+'">'+this.name+'</p>'
									   +'<ul class="ul_third">';
					    $.each(this.childArray,function(){
					    	childClassifyStr+='<li class="li_third">'
					    					+'<p class="p_third childClassify" id="'+this.id+'">'+this.name+'</p>'
					    					+'</li>'
					    });
					    childClassifyStr+='</ul></li>'
					});
					$('div.classify_downMenu ul.ul_first li.li_classify ul.ul_second').html(childClassifyStr);
					$('li.li_classify li p').hover(function(){
						$(this).css('background-color','#FFEFEC')
					},function(){
						$('li.li_first li p').css('background-color','#fff');
						$('li.li_classify li p.p_third').css('background-color','#fff');
						$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
					})
				}
			});
		}
		
		//配件分类查询
		if(classificationId){
			loadGoodsList(0);
			//根据分类ID获得上一级分类列表
			$.get(mall.url('/classification/getParentClass'),{classificationId:classificationId},function(data){
				if(data.parentId != -1){
					var parentId=data.parentId;
					var childId=data.classificationId;
					$('li.li_classify p.parentClassify').html(data.parentName).attr('id',data.parentId).addClass('pClick');
					$('span.smallNav_second a').html(data.parentName);
					var hasSearchsStr='';
			    	hasSearchsStr+='<span id="firstClassificationId">一级分类：'+data.parentName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>'
							      +'<span id="classificationId">二级分类：'+data.classificationName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
				    $('li.hasSearchs').append(hasSearchsStr)
				}else{
					var parentId=data.classificationId
					$('li.li_classify p.parentClassify').html(data.classificationName).attr('id',data.classificationId).addClass('pClick');
					// $('li.li_classify p.childClassify').hide();
					$('span.smallNav_second a').html(data.classificationName);
					var hasSearchsStr='';
			    	hasSearchsStr+='<span id="firstClassificationId">一级分类：'+data.classificationName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
				    $('li.hasSearchs').append(hasSearchsStr)
				}
//				if(data.parentId!=-1){
//					
//				}else{
//					
//				}
				$.get(mall.url('/classification/getClassesByParentId'),{parentId:parentId,level:'2'},function(jsonArray){
					var childClassifyStr='';
					$.each(jsonArray,function(){
						childClassifyStr+='<li class="li_third">'
										 +'<p class="p_third childClassify" id="'+this.classificationId+'">'+this.name+'</p>'
										 +'</li>'
					});
					$('li.li_classify ul.ul_third').html(childClassifyStr);
					if(childId){
						$('li.li_classify p#'+childId).addClass('pClick')
					}
					
					$('li.li_classify li p').hover(function(){
						$(this).css('background-color','#FFEFEC')
					},function(){
						$('li.li_first li p').css('background-color','#fff');
						$('li.li_classify li p.p_third').css('background-color','#fff');
						$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
					});

				});

				
			});
			$('li.hasSearchs').on('click','span a',function(){
	 			var theSearchId=$(this).parent().attr('id');
	 			var theValue=pageParams[theSearchId];
	 			$('div.classify_downMenu').find('p#'+theValue).removeClass('pClick');
	 			if($('li.hasSearchs span').length>1){
	 				$(this).parent().remove();
		 			delete pageParams[theSearchId];
		 			if(theSearchId=='extAttributeOptionId'){
		 				delete pageParams['extendedAttributeId']
		 			}
					initPagination = false;
		 			loadGoodsList(0);
	 			}else{ 
	 				window.location.href='classify.html'
	 			}
	 		})
		}else if(!columnId){
			$('div.smallNav').hide();
			if(!(paramJson.styleId)){
				$('li.li_first ul.ul_second').hide();
				$('li.li_first p.p_first img').attr('src','img/classifyUp_icon.png');
				$('li.hasSearchs').on('click','span a',function(){
		 			var theSearchId=$(this).parent().attr('id');
		 			var theValue=pageParams[theSearchId];
		 			$('div.classify_downMenu').find('p#'+theValue).removeClass('pClick');
		 			if($('li.hasSearchs span').length>1){
		 				$(this).parent().remove();
			 			delete pageParams[theSearchId];
			 			if(theSearchId=='extAttributeOptionId'){
			 				delete pageParams['extendedAttributeId']
			 			}
						initPagination = false;
			 			loadGoodsList(0) 
		 			}else{
		 				window.location.href='classifyResult.html'
		 			}
		 		})
			}else if(paramJson.styleId){
				loadGoodsList(0);
				$('li.li_classify ul.ul_second,li.li_brand ul.ul_second').hide();
				$('li.li_classify p.p_first img,li.li_brand p.p_first img').attr('src','img/classifyUp_icon.png');
				$('li.hasSearchs').on('click','span a',function(){
		 			var theSearchId=$(this).parent().attr('id');
		 			var theValue=pageParams[theSearchId];
		 			$('div.classify_downMenu').find('p#'+theValue).removeClass('pClick');
		 			if($('li.hasSearchs span').length>1){
		 				$(this).parent().remove();
			 			delete pageParams[theSearchId];
			 			if(theSearchId=='extAttributeOptionId'){
			 				delete pageParams['extendedAttributeId']
			 			}
						initPagination = false;
			 			loadGoodsList(0) 
		 			}else{
		 				window.location.href='carType.html'
		 			}
		 		})
			}
			$.get(mall.url('/classification/getAllClassifications'),function(data){
				var allClassifyStr='';
				$.each(data,function(){
					allClassifyStr+='<li class="li_second">'
								   +'<p class="p_second parentClassify" id="'+this.id+'">'+this.name+'</p>'
								   +'<ul class="ul_third">';
				    $.each(this.childArray,function(){
				    	allClassifyStr+='<li class="li_third"><p class="p_third childClassify" id="'+this.id+'">'+this.name+'</p></li>'
				    });
				    allClassifyStr+='</ul></li>'
				});
				$('div.classify_downMenu ul.ul_first li.li_classify ul.ul_second').html(allClassifyStr);
				$('li.li_classify li p').hover(function(){
					$(this).css('background-color','#FFEFEC')
				},function(){
					$('li.li_first li p').css('background-color','#fff');
					$('li.li_classify li p.p_third').css('background-color','#fff');
					$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
				})
			});
		}

		//配件分类母分类点击-油品-不可用
		$('li.li_classify ').on('click','p.parentClassify',function(){
			$(this).parents('li.li_classify').find('p.parentClassify').removeClass('pClick');
			$(this).parents('li.li_classify').find('p.childClassify').removeClass('pClick');
			$(this).addClass('pClick');
			if($('li.hasSearchs span#firstClassificationId').length>0){
				$('li.hasSearchs span#firstClassificationId').html('一级分类：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a>');
				$('li.hasSearchs span#classificationId').remove();
				$('li.hasSearchs span#accessoryBrandId').remove();
			}else{
				var hasSearchsStr='';
		    	hasSearchsStr+='<span id="firstClassificationId">一级分类：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
		    	$('li.hasSearchs span#classificationId').remove();
			    $('li.hasSearchs').append(hasSearchsStr)
			}
			classificationId=$(this).attr('id');
			goodsBrand(classificationId);
			goodsExtendAttr(classificationId);
			pageParams.firstClassificationId=$(this).attr('id');
			if(pageParams.classificationId){
				delete pageParams.classificationId
			}
			delete pageParams.accessoryBrandId;
			initPagination = false;
 			loadGoodsList(0)
		});

		//点击配件分类子分类二级分类-柴机油
		$('li.li_classify').on('click','p.childClassify',function(){
			$(this).parents('li.li_classify').find('p.childClassify').removeClass('pClick');
			$(this).parents('li.li_classify').find('p.parentClassify').removeClass('pClick');
			$(this).addClass('pClick');
			$(this).parents('li.li_second').find('p.parentClassify').addClass('pClick');
			$('.searchGoods form input[name="keyword"]').val('');//删除关键字的字段
			_pageParams=undefined;//注销掉关键字json
			if($('li.hasSearchs span#classificationId').length>0){
				$('li.hasSearchs span#classificationId').html('二级分类：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
			}else{
				var hasSearchsStr='';
		    	hasSearchsStr+='<span id="classificationId">二级分类：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
			    $('li.hasSearchs').append(hasSearchsStr)
			}
			if($('li.hasSearchs span#firstClassificationId').length>0){
				$('li.hasSearchs span#firstClassificationId').html('一级分类：'+$(this).parents('li.li_second').find('p.parentClassify').text()+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
			}else{
				var _hasSearchsStr='';
		    	_hasSearchsStr+='<span id="firstClassificationId">一级分类：'+$(this).parents('li.li_second').find('p.parentClassify').text()+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
			    $('li.hasSearchs').append(_hasSearchsStr)
			}
			if($("li.hasSearchs span#accessoryBrandId").length>0){
				$("li.hasSearchs span#accessoryBrandId").remove();
			}
			classificationId=$(this).attr('id');

			goodsBrand(classificationId);

			goodsExtendAttr(classificationId);

			pageParams.classificationId=$(this).attr('id');
			pageParams.firstClassificationId=$(this).parents('li.li_second').find('p.parentClassify').attr('id');
			delete pageParams.accessoryBrandId;
			initPagination = false;
 			loadGoodsList(0)
		});
//			$.get(mall.url('/accessoryBrand/list'),function(data){
//				var allBrandStr='';
//				$.each(data,function(){
//					allBrandStr+='<li class="li_second"><p class="p_second" id="'+this.id+'">'+this.name+'</p></li>'
//				});
//				$('div.classify_downMenu ul.ul_first li.li_brand ul.ul_second').html(allBrandStr);
//				$('li.li_brand li p').hover(function(){
//					$(this).css('background-color','#FFEFEC')
//				},function(){
//					$('li.li_first li p').css('background-color','#fff');
//					$('li.li_classify li p.p_third').css('background-color','#fff');
//					$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
//				})
//				$('li.li_brand ul.ul_second p.p_second').unbind('click').bind('click',function(){//配件品牌点击
//					$(this).parents('li.li_brand').find('p.p_second').removeClass('pClick');
//					$(this).addClass('pClick');
//					if($('li.hasSearchs span#accessoryBrandId').length>0){
//						$('li.hasSearchs span#accessoryBrandId').html('品牌：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
//					}else{
//						var hasSearchsStr='';
//				    	hasSearchsStr+='<span id="accessoryBrandId">品牌：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
//					    $('li.hasSearchs').append(hasSearchsStr)
//					}
//					pageParams.accessoryBrandId=$(this).attr('id');
//					initPagination = false;
//		 			loadGoodsList(0);
//				});
//				
//			})
		// 配件品牌查询
		function goodsBrand(classificationId){
			$.get(mall.url('/classification/getClassificationBrandRels'),{classificationId:classificationId},function(data){
				var brandStr='';
				$.each(data,function(i){
					brandStr+='<li class="li_second">'
							 +'<p class="p_second" id="'+this.accessoryBrandId+'">'+this.name+'</p>'
							 +'</li>'
				});
				$('li.li_brand ul.ul_second').html(brandStr);
				$('li.li_brand li p').hover(function(){
					$(this).css('background-color','#FFEFEC')
				},function(){
					$('li.li_first li p').css('background-color','#fff');
					$('li.li_classify li p.p_third').css('background-color','#fff');
					$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
				});
				//配件品牌点击-壳牌
				$('li.li_brand ul.ul_second p.p_second').unbind('click').bind('click',function(){
					$(this).parents('li.li_brand').find('p.p_second').removeClass('pClick');
					$(this).addClass('pClick');
					if($('li.hasSearchs span#accessoryBrandId').length>0){
						$('li.hasSearchs span#accessoryBrandId').html('品牌：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
					}else{
						var hasSearchsStr='';
				    	hasSearchsStr+='<span id="accessoryBrandId">品牌：'+$(this).text()+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
					    $('li.hasSearchs').append(hasSearchsStr)
					}
					pageParams.accessoryBrandId=$(this).attr('id');
					initPagination = false;
		 			loadGoodsList(0);
				})
			})
		};
		goodsBrand(classificationId);
		
		// 配件车型查询
		var brandName='';
		var factoryName='';
		var modelName='';
		var styleName='';
		var hasSearchsStr='';
		$.get(mall.url('/support/brand/list'),function(data){
			var brandStr='';
			brandStr+='<option value="">请选择品牌</option>';
			$.each(data,function(){
				brandStr+='<option value="'+this.id+'">'+this.name+'</option>'
			});
			$('li.li_carType select#carBrand').html(brandStr);
			if(paramJson.brandId){
				$('li.li_carType select#carBrand').val(paramJson.brandId);
				brandName=$('li.li_carType select#carBrand option[value="'+paramJson.brandId+'"]').text();
				hasSearchsStr+='<span id="brandId">车牌：'+brandName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>'
			}
			
			$('li.li_carType select#carBrand').change(function(){
				var brandId=$(this).val();
				$.get(mall.url('/support/factory/list'),{brandId:brandId},function(data2){
					var factoryStr='';
					factoryStr+='<option value="">请选择车厂</option>';
					$.each(data2,function(i){
						factoryStr+='<option value="'+this.id+'">'+this.name+'</option>'
					});
					$('li.li_carType select#carFactory').html(factoryStr);
					$('li.li_carType select#carMethod').html('<option value="">请选择车系</option>');
					$('li.li_carType select#carStyle').html('<option value="">请选择车型</option>');
					$('li.li_carType select#carFactory').change(function(){
						var factoryId=$(this).val();
						$.get(mall.url('/support/model/list'),{factoryId:factoryId},function(data3){
							var modelStr='';
							modelStr+='<option value="">请选择车系</option>';
							$.each(data3,function(i){
								modelStr+='<option value="'+this.id+'">'+this.name+'</option>'
							});
							$('li.li_carType select#carMethod').html(modelStr);
							$('li.li_carType select#carStyle').html('<option value="">请选择车型</option>');
							$('li.li_carType select#carMethod').change(function(){
								var modelId=$(this).val();
								$.get(mall.url('/support/style/list'),{modelId:modelId},function(data4){
									var styleStr='';
									styleStr+='<option value="">请选择车型</option>';
									$.each(data4,function(i){
										styleStr+='<option value="'+this.styleId+'">'+this.styleName+'</option>'
									});
									$('li.li_carType select#carStyle').html(styleStr)
								})
							})
						})
					})
				})
			})
		});
		if(paramJson.styleId){

			$.get(mall.url('/support/factory/list'),{brandId:paramJson.brandId},function(data2){
				var factoryStr='';
				factoryStr+='<option value="">请选择车厂</option>';
				$.each(data2,function(i){
					factoryStr+='<option value="'+this.id+'">'+this.name+'</option>'
				});
				$('li.li_carType select#carFactory').html(factoryStr);
				$('li.li_carType select#carFactory').val(paramJson.factoryId);
				factoryName=$('li.li_carType select#carFactory option[value="'+paramJson.factoryId+'"]').text();
				hasSearchsStr+='<span id="factoryId">车厂：'+factoryName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
				$('li.li_carType select#carMethod').html('<option value="">请选择车系</option>');
				$('li.li_carType select#carStyle').html('<option value="">请选择车型</option>');
					$.get(mall.url('/support/model/list'),{factoryId:paramJson.factoryId},function(data3){
						var modelStr='';
						modelStr+='<option value="">请选择车系</option>';
						$.each(data3,function(i){
							modelStr+='<option value="'+this.id+'">'+this.name+'</option>'
						});
						$('li.li_carType select#carMethod').html(modelStr);
						$('li.li_carType select#carMethod').val(paramJson.modelId);
						modelName=$('li.li_carType select#carMethod option[value="'+paramJson.modelId+'"]').text();
						hasSearchsStr+='<span id="modelId">车系：'+modelName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
						$('li.li_carType select#carStyle').html('<option value="">请选择车型</option>');
							$.get(mall.url('/support/style/list'),{modelId:paramJson.modelId},function(data4){
								var styleStr='';
								styleStr+='<option value="">请选择车型</option>';
								$.each(data4,function(i){
									styleStr+='<option value="'+this.styleId+'">'+this.styleName+'</option>'
								});
								$('li.li_carType select#carStyle').html(styleStr);
								$('li.li_carType select#carStyle').val(paramJson.styleId);
								styleName=$('li.li_carType select#carStyle option[value="'+paramJson.styleId+'"]').text();
								hasSearchsStr+='<span id="styleId">车型：'+styleName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
								$('li.hasSearchs').append(hasSearchsStr)
							})
					})
			})
		}
 		$('span.carButton').click(function(){
 			var brandId=$('li.li_carType select#carBrand').val();
 			var factoryId=$('li.li_carType select#carFactory').val();
 			var modelId=$('li.li_carType select#carMethod').val();
 			var styleId=$('li.li_carType select#carStyle').val();
 			if(brandId!=''){
 				pageParams.brandId=brandId;
 				delete pageParams.factoryId;
 				delete pageParams.modelId;
 				delete pageParams.styleId;
 				var brandName=$('li.li_carType select#carBrand option[value="'+brandId+'"]').text();
 				if($('li.hasSearchs span#brandId').length>0){
					$('li.hasSearchs span#brandId').html('车牌：'+brandName+'<a href="javascript:"><img src="img/closeSearch.png"></a>');
					$('li.hasSearchs span#factoryId').remove();
					$('li.hasSearchs span#modelId').remove();
					$('li.hasSearchs span#styleId').remove();
				}else{
					var hasSearchsStr='';
			    	hasSearchsStr+='<span id="brandId">车牌：'+brandName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
			    	$('li.hasSearchs span#factoryId').remove();
					$('li.hasSearchs span#modelId').remove();
					$('li.hasSearchs span#styleId').remove();
				    $('li.hasSearchs').append(hasSearchsStr)
				}
 				if(factoryId!=''){
	 				pageParams.factoryId=factoryId;
	 				delete pageParams.modelId;
	 				delete pageParams.styleId;
	 				var factoryName=$('li.li_carType select#carFactory option[value="'+factoryId+'"]').text();
	 				if($('li.hasSearchs span#factoryId').length>0){
						$('li.hasSearchs span#factoryId').html('车厂：'+factoryName+'<a href="javascript:"><img src="img/closeSearch.png"></a>');
						$('li.hasSearchs span#modelId').remove();
						$('li.hasSearchs span#styleId').remove()
					}else{
						var hasSearchsStr='';
				    	hasSearchsStr+='<span id="factoryId">车厂：'+factoryName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
				    	$('li.hasSearchs span#modelId').remove();
						$('li.hasSearchs span#styleId').remove();
					    $('li.hasSearchs').append(hasSearchsStr)
					}
	 				if(modelId!=''){
		 				pageParams.modelId=modelId;
		 				delete pageParams.styleId;
		 				var modelName=$('li.li_carType select#carMethod option[value="'+modelId+'"]').text();
		 				if($('li.hasSearchs span#modelId').length>0){
							$('li.hasSearchs span#modelId').html('车系：'+modelName+'<a href="javascript:"><img src="img/closeSearch.png"></a>');
							$('li.hasSearchs span#styleId').remove()
						}else{
							var hasSearchsStr='';
					    	hasSearchsStr+='<span id="modelId">车系：'+modelName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
					    	$('li.hasSearchs span#styleId').remove();
						    $('li.hasSearchs').append(hasSearchsStr)
						}
			 			if(styleId!=''){
			 				pageParams.styleId=styleId;
			 				var styleName=$('li.li_carType select#carStyle option[value="'+styleId+'"]').text();
			 				if($('li.hasSearchs span#styleId').length>0){
								$('li.hasSearchs span#styleId').html('车型：'+styleName+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
							}else{
								var hasSearchsStr='';
						    	hasSearchsStr+='<span id="styleId">车型：'+styleName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
							    $('li.hasSearchs').append(hasSearchsStr)
							}
			 			}
		 			}
	 			}
	 			initPagination = false;
	 			loadGoodsList(0) 
 			}
 		});

		$('li.saleDecrease p,li.priceUpOrDown span').hover(function(){
			$(this).addClass('saleDecrease_hover')
		},function(){
			$(this).removeClass('saleDecrease_hover')
		});
		$('li.saleDecrease p').addClass('saleDecrease_click');
		
		/*销量点击
		$('li.saleDecrease p').unbind('click').bind('click',function(){
			if($(this).text()=='销量从高到低'){
				if(_pageParams==undefined){
					pageParams.sortname='salesNum';
					pageParams.sortorder='desc';
					initPagination = false;
		 			loadGoodsList(0)
				}else{
					_pageParams.sortname='salesNum';
					_pageParams.sortorder='desc';
					_initPagination = false;
		 			_loadGoodsList(0)
				}
				 
			}else if($(this).text()=='销量'){
				$(this).html('销量从高到低').addClass('saleDecrease_click');
				$('li.priceUpOrDown span.priceImg').removeClass('priceDownImg').removeClass('priceUpImg');
				$('li.priceUpOrDown span.priceText').removeClass('saleDecrease_click');
				if(_pageParams==undefined){
					pageParams.sortname='salesNum';
					pageParams.sortorder='desc';
					initPagination = false;
		 			loadGoodsList(0) 
				}else{
					_pageParams.sortname='salesNum';
					_pageParams.sortorder='desc';
					_initPagination = false;
		 			_loadGoodsList(0) 
				}
			}
		});
		
		*/
		$('li.priceUpOrDown span').unbind('click').bind('click',function(){
			if($('li.saleDecrease p').text()!='销量'){
				$('li.priceUpOrDown span.priceImg').addClass('priceDownImg');
				$('li.priceUpOrDown span.priceText').addClass('saleDecrease_click');
				$('li.saleDecrease p').html('销量').removeClass('saleDecrease_click');
				if(_pageParams==undefined){
					pageParams.sortname='sellingPrice';
					pageParams.sortorder='desc';
					initPagination = false;
		 			loadGoodsList(0)
				}else{
					_pageParams.sortname='sellingPrice';
					_pageParams.sortorder='desc';
					_initPagination = false;
		 			_loadGoodsList(0)
				}
				 
			}else if($('li.priceUpOrDown span.priceImg').hasClass('priceDownImg')){
				$('li.priceUpOrDown span.priceImg').removeClass('priceDownImg').addClass('priceUpImg');
				if(_pageParams==undefined){
					pageParams.sortname='sellingPrice';
					pageParams.sortorder='asc';
					initPagination = false;
		 			loadGoodsList(0) 
				}else{
					_pageParams.sortname='sellingPrice';
					_pageParams.sortorder='asc';
					_initPagination = false;
		 			_loadGoodsList(0) 
				}
			}else if($('li.priceUpOrDown span.priceImg').hasClass('priceUpImg')){
				$('li.priceUpOrDown span.priceImg').removeClass('priceUpImg').addClass('priceDownImg');
				if(_pageParams==undefined){
					pageParams.sortname='sellingPrice';
					pageParams.sortorder='desc';
					initPagination = false;
		 			loadGoodsList(0) 
				}else{
					_pageParams.sortname='sellingPrice';
					_pageParams.sortorder='desc';
					_initPagination = false;
		 			_loadGoodsList(0) 
				}
				
			}
		})
		//勾选只显示有货
//		$("#existProduction").click(function(){
//			if($(this).attr("checked")=="true"){
//				$(this).addClass('checked');
//			}else{
//				$(this).removeClass('checked');
//			}
//			_initPagination = false;
//			loadGoodsList(0);
//		})
 		
		// 配件扩展属性查询
		function goodsExtendAttr(classificationId){
			$.get(mall.url('/classification/extendedAttribute/list'),{classificationId:classificationId},function(data){
				var extAttrStr='';
				$('div.classify_downMenu ul.ul_first li.li_extAttr').remove();
				if(data!=''){
					$.each(data,function(i){
						extAttrStr+='<li class="li_first li_extAttr"><p class="p_first" id="'+this.id+'">'
								   +'<span class="menuText">'+this.name+'</span>'
								   +'<span class="menuIcon"><img src="img/classifyUp_icon.png"></span>'
								   +'</p></li>'
					});
					$('div.classify_downMenu ul.ul_first').append(extAttrStr);
					$('li.li_extAttr p.p_first').unbind('click').bind('click',function(){
						var extendedAttributeId=$(this).attr('id');
						var li_extAttr=$(this).parent();
						$(this).find('img').attr('src','img/classifyDown_icon.png');
						$.get(mall.url('/classification/extAttributeOption/list'),{extendedAttributeId:extendedAttributeId},function(data2){
							var extAttOptionStr='';
							extAttOptionStr+='<ul class="ul_second" style="display:none;">';
							$.each(data2,function(i){
								extAttOptionStr+='<li class="li_second"><p class="p_second" id="'+this.id+'">'+this.name+'</p></li>'
							});
							extAttOptionStr+='</ul>';
							li_extAttr.append(extAttOptionStr);
							$('li.li_extAttr li p').hover(function(){
								$(this).css('background-color','#FFEFEC')
							},function(){
								$('li.li_first li p').css('background-color','#fff');
								$('li.li_classify li p.p_third').css('background-color','#fff');
								$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
							});
							li_extAttr.find('ul.ul_second').stop(false,true).slideDown()
						});
						$(this).unbind('click');
						li_extAttr.delegate('p.p_first','click',function(){
							li_extAttr.find('ul.ul_second').slideToggle()
						});
						$(this).bind('click',function(){
							if(li_extAttr.find('ul.ul_second').is(':hidden')){
								li_extAttr.find('p.p_first img').attr('src','img/classifyDown_icon.png')
							}else{
								li_extAttr.find('p.p_first img').attr('src','img/classifyUp_icon.png')
							}
						})
					})
					$('li.li_extAttr').on('click','li p',function(){
						$('li.li_extAttr').find('p.p_second').removeClass('pClick');
						$(this).addClass('pClick');
						var extendedAttributeId=$(this).parents('li.li_extAttr').find('p.p_first').attr('id');
						var extendedAttributeName=$(this).parents('li.li_extAttr').find('p.p_first').text();
						var extAttributeOptionId=$(this).attr('id');
						var extAttributeOptionName=$(this).text();
						delete pageParams.extendedAttributeId;
						delete pageParams.extAttributeOptionId;
						pageParams.extendedAttributeId=extendedAttributeId;
						pageParams.extAttributeOptionId=extAttributeOptionId;
						var hasSearchsStr='';
				    	hasSearchsStr+='<span id="extAttributeOptionId">'+extendedAttributeName+'：'+extAttributeOptionName+'<a href="javascript:"><img src="img/closeSearch.png"></a></span>';
				    	if($('li.hasSearchs span#extAttributeOptionId').length>0){
							$('li.hasSearchs span#extAttributeOptionId').html(extendedAttributeName+'：'+extAttributeOptionName+'<a href="javascript:"><img src="img/closeSearch.png"></a>')
						}else{
							$('li.hasSearchs').append(hasSearchsStr)
						}
					    initPagination = false;
			 			loadGoodsList(0) 
					})
				}
			})
		};
		goodsExtendAttr(classificationId);
		$('li.li_first').delegate('p.p_first','click',function(){
			$(this).parent().find('ul.ul_second').slideToggle()
		});
		$('li.li_first p.p_first').bind('click',function(){
			if($(this).parent().find('ul.ul_second').is(':hidden')){
				$(this).find('img').attr('src','img/classifyDown_icon.png')
			}else{
				$(this).find('img').attr('src','img/classifyUp_icon.png')
			}
		});
		// 查询商品分页列表
		var initPagination = false;
		function loadGoodsList(page){
			$("div.pagination").hide();
			pageParams.pageindex=page;
			pageParams.pagesize=40;
			pageParams.areaCodeId=areaCodeId;
			delete pageParams.columnId;
			if(columnId){
				pageParams.commodityType=3;
				//if(commodityType==3){//3:专供商品
				pageParams.columnId=columnId;
				//}
			}
			
			if(customerId==null){
				pageParams.isShowUnavailable=1;//显示所有商品（有货+无货）
			}else{
				pageParams.userInfoId=customerId;
				pageParams.isShowUnavailable=0;//显示有货商品
			}
			//勾选只显示有货
//			if($("#existProduction").prop("checked")==true){
//				pageParams.isShowUnavailable=0;
//			}else{
//				pageParams.isShowUnavailable=1;
//			}
			$.get(mall.url('/commodity/queryCommodities'),pageParams,function(data){
				if(data){
					var items=data.items;
					var goodsStr='';
					if(data.totalCount!=0){
						$.each(items,function(){
							var item_commodityType=this.commodityType;
							var item_name=this.name;
							if(item_name.length>13){
								item_name=item_name.substring(0,12)+'…'
							}
							goodsStr+='<li>'
						 			 +'<p class="classiify_goodsImg"><a href="goodsDetail.html?commodityId='+this.commodityId+'&skuId='+this.skuId+'" target="_blank">'
									 +'<img src="'+this.picUrl+'" width="228" height="228" title="'+this.name+'">'
									 +'</a></p>'
									 +'<p class="classiify_goodsName"><a href="goodsDetail.html?commodityId='+this.commodityId+'&skuId='+this.skuId+'" target="_blank" title="'+this.name+'">'+item_name+'</a></p>'
									 // +'<p class="classiify_goodsSku">175/70R14 84H B250 84H B25</p>'
									 if(document.cookie.indexOf('customerId=')!=-1){
									 	goodsStr+='<p class="classiify_goodsPrice">￥'+this.sellingPrice+'</p>'
									 }else{
									 	goodsStr+='<p class="classiify_goodsPrice classiify_goodsPrice_change" onclick="Login()">登录后查看优惠</p>'
									 }
							goodsStr+='<p class="classiify_goodsMall">市场价：<span class="classiify_goodsMall_detail">￥'+this.marketPrice+'</span><span class="hasSaledNum">已销 '+this.salesNum+'件</span></p>'
							if(item_commodityType==3 && (!columnId)){
								goodsStr+='<i><span>专供商品</span></i>'
							}
							    goodsStr+='</li>'
						});
						$("div.pagination").show();
						$('div.classiify_goodsDetail ul').html(goodsStr);
						if(!initPagination){
							$("div.pagination").pagination(data.totalCount, {
								items_per_page: 40,
								num_display_entries: 6,
								num_edge_entries: 1,
								link_to: "javascript:void(0);",
								prev_text: "< 上一页",
								next_text: "下一页 >",
								callback: function(page_index){
									loadGoodsList(page_index);
								}
							});
							initPagination = true
						}
					}else{
						goodsStr+='暂无符合条件的商品';
						$('div.classiify_goodsDetail ul').html(goodsStr).css('text-align','center');
					}
				}
			})
		};
		//关键字查询商品
		var _initPagination =  false;
		function _loadGoodsList(page){
			_pageParams.pageindex=page;
			_pageParams.pagesize=40;
			_pageParams.areaCodeId=areaCodeId;
			delete _pageParams.columnId;
			if(columnId){
				_pageParams.commodityType=3;
				//if(commodityType==3){//3:专供商品
					_pageParams.columnId=columnId;
				//}
			}
			
			if(document.cookie.indexOf('customerId=')!=-1){
				_pageParams.userInfoId=customerId;
				_pageParams.isShowUnavailable=0;
			}else{
				_pageParams.isShowUnavailable=1;
			}
			$.get(mall.url('/commodity/search'),_pageParams,function(data){
				if(data){
					var items=data.items;
					var goodsStr='';
					if(data.totalCount!=0){
						$.each(items,function(i){
							var item_commodityType=this.commodityType;
							var item_name=this.name;
							if(item_name.length>13){
								item_name=item_name.substring(0,12)+'…'
							}
							goodsStr+='<li>'
					 				 +'<p class="classiify_goodsImg"><a href="goodsDetail.html?commodityId='+this.commodityId+'&skuId='+this.skuId+'" target="_blank">'
									 +'<img src="'+this.picUrl+'" width="228" height="228" title="'+this.name+'">'
									 +'</a></p>'
									 +'<p class="classiify_goodsName"><a href="goodsDetail.html?commodityId='+this.commodityId+'&skuId='+this.skuId+'" target="_blank" title="'+this.name+'">'+item_name+'</a></p>'
									 if(document.cookie.indexOf('customerId=')!=-1){
									 	goodsStr+='<p class="classiify_goodsPrice">￥'+this.sellingPrice+'</p>'
									 }else{
									 	goodsStr+='<p class="classiify_goodsPrice classiify_goodsPrice_change" onclick="Login()">登录后查看优惠</p>'
									 }
							goodsStr+='<p class="classiify_goodsMall">市场价：<span class="classiify_goodsMall_detail">￥'+this.marketPrice+'</span><span class="hasSaledNum">已销 '+this.salesNum+'件</span></p>'
							if(item_commodityType==3&&(!columnId)){//3:专供商品
								goodsStr+='<i><span>专供商品</span></i>'
							}
							    goodsStr+'</li>'
						});
						$('div.classiify_goodsDetail ul').html(goodsStr);
						if(!_initPagination){
							$("div.pagination").pagination(data.totalCount, {
								items_per_page: 40,
								num_display_entries: 6,
								num_edge_entries: 1,
								link_to: "javascript:void(0);",
								prev_text: "< 上一页",
								next_text: "下一页 >",
								callback: function(page_index){
									_loadGoodsList(page_index);
								}
							});
							_initPagination = true
						}
					}else{
						goodsStr+='暂无符合条件的商品';
						$('div.classiify_goodsDetail ul').html(goodsStr).css('text-align','center');
					}
					
				}
			})
		};
		$('li.li_classify li p').hover(function(){
			$(this).css('background-color','#FFEFEC')
		},function(){
			$('li.li_first li p').css('background-color','#fff');
			$('li.li_classify li p.p_third').css('background-color','#fff');
			$('li.li_classify li p.p_second').css('background-color','#f7f7f7')
		});

	});
</script>
</html>